[TOC]

***ç”±äºé‡‡ç”¨ Typora ä¹¦å†™ï¼Œgithub ä¸æ”¯æŒéƒ¨åˆ†æ ¼å¼ï¼Œå»ºè®® clone åç”¨ Typora è§‚çœ‹***

# è‡ªå®šä¹‰Viewä¸åŠ¨ç”»

## ä¸€ã€è‡ªå®šä¹‰View

### 1ã€ä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰ï¼Ÿ

> ä¸€å¥è¯ï¼šå®˜æ–¹çš„æ§ä»¶æ»¡è¶³ä¸äº†äº§å“æƒ³è¦çš„æ•ˆæœ (
>
> ä½†å…¶å®ï¼Œå®˜æ–¹æ§ä»¶å·²ç»èƒ½æ»¡è¶³ç»å¤§å¤šæ•°éœ€æ±‚äº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹è‡ªå®šä¹‰ View æ˜¯ä¸‹ä¸‹ç­–ï¼Œå› ä¸ºé€ è‡ªå®šä¹‰ View çš„è½®å­æ˜¯ä¸€ä»¶å¾ˆè€—æ—¶ä¹Ÿå¾ˆè€—ç²¾åŠ›çš„äº‹ã€‚
>
> è¿™é‡Œåˆ†äº«ä¸€ä¸‹æˆ‘å¤§ä¸€æš‘å‡æ—¶é‡åˆ°çš„äº‹æƒ…ï¼Œå½“æ—¶å…± 5 ä¸ªç»„åˆ†å¼€åšç§¯åˆ†å•†åŸï¼Œäº§å“ç»™äº†ä¸€ä¸ªç§¯åˆ†å•†åŸçš„è®¾è®¡å›¾ï¼Œå…¶ä¸­ä¸»é¡µæœ‰ä¸€ä¸ªä¸Šæ»‘å±•å¼€çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ç»„ï¼ˆæˆ‘å’Œé’Ÿæ™ºï¼‰ï¼Œæˆ‘å°±è´Ÿè´£åšè¿™ä¸ªä¸Šæ»‘çš„ç•Œé¢ã€‚å½“æ—¶æˆ‘èŠ±äº†å¥½åƒ 3ã€4 å¤©çš„æ—¶é—´å»è®¾è®¡ä¸€ä¸ªè‡ªå®šä¹‰ Viewï¼ˆåŸè°…æˆ‘å½“æ—¶è¿˜ä¸çŸ¥é“åè°ƒè€…å¸ƒå±€è¿™ä¸ªä¸œè¥¿ï¼‰ï¼Œç»“æœå•Šï¼Œäº§å“æ”¹éœ€æ±‚äº†ï¼Œé 
>
> ç»è¿‡ä¸Šé¢çš„è¿™ä¸ªæ•…äº‹åï¼Œç›¸ä¿¡å¤§å®¶åº”è¯¥ç†è§£åˆ°äº†é€‰æ‹©è‡ªå®šä¹‰ View ä¼šé¢ä¸´çš„é£é™©
>
> åæ¥æˆ‘åˆèŠ±äº†æ¥è¿‘ä¸€å‘¨çš„æ—¶é—´è¿˜æ˜¯ç”¨è‡ªå®šä¹‰ View å†™å‡ºäº†äº§å“çš„æ–°éœ€æ±‚ï¼Œé™äºå½“æ—¶æˆ‘çš„èƒ½åŠ›ï¼Œç°åœ¨å»çœ‹å½“æ—¶å†™çš„ä»£ç ï¼Œå­˜åœ¨ä¸€äº›è€¦åˆçš„åœ°æ–¹ï¼Œç®—æ˜¯ç»™ä»¥åå­¦å¼Ÿç•™å‘äº†ğŸ˜
>
> OKï¼Œå›åˆ°è¿™é‡Œï¼Œè‡ªå®šä¹‰ View ç¡®å®æ˜¯ä¸‹ä¸‹ç­–ï¼Œä¸æ­¢ä¼šå½±å“ä½ çš„å¿ƒæƒ…ï¼Œå¦‚æœä½ çš„ä»£ç è®¾è®¡å¾—ä¸å¥½çš„è¯ï¼ˆæ¯”å¦‚è€¦åˆåº¦å¾ˆé«˜ï¼Œä»£ç é€»è¾‘æ··ä¹±ï¼‰ï¼Œè¿˜ä¼šå½±å“ä»¥åç»´æŠ¤ä»£ç äººçš„å¿ƒæƒ…ã€‚ï¼ˆè¯´ä¸ªç¬‘è¯ï¼šå¬è¯´ä»£ç å†™å¾—è¶Šçƒ‚ï¼Œè¶Šä¸å®¹æ˜“è¢«è¾é€€ :ï¼‰

### 2ã€åˆ†ç±»

> è¿™é‡Œè‡ªå®šä¹‰ View æ˜¯ä¸€ä¸ªä¹ æƒ¯æ€§çš„ç»Ÿç§°
>
> å¦‚æœæŒ‰ç…§ç±»å‹æ¥åˆ†ï¼š
>
> - è‡ªå®šä¹‰ View
>
>   > æŒ‡ç›´æ¥æˆ–é—´æ¥ç»§æ‰¿äº View çš„æ§ä»¶ï¼Œå¦‚ï¼šTextViewã€Button
>   >
>   > ```java
>   > public class TextView extends View {}
>   > ```
>   >
>   > ```java
>   > public class Button extends TextView {}
>   > ```
>   >
>   > 
>
> - è‡ªå®šä¹‰ ViewGroup
>
>   > ```java
>   > public class LinearLayout extends ViewGroup {}
>   > ```
>   >
>   > ```java
>   > public class FrameLayout extends ViewGroup {}
>   > ```
>
> 
>
> å¦‚æœæŒ‰ç…§å­¦ä¹ çš„å†…å®¹æ¥åˆ†ï¼Œå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å†…å®¹
>
> - View çš„æµ‹é‡ä¸å¸ƒå±€
>
>   > æµ‹é‡å°±æ˜¯ä¸ Measure ç›¸å…³çš„æ–¹æ³•ï¼Œå¦‚ï¼š`onMeasure()`
>   >
>   > å¸ƒå±€å°±æ˜¯ä¸ Layout ç›¸å…³çš„æ–¹æ³•ï¼Œå¦‚ï¼š`onLayout()`
>   >
>   > è¿™ä¸¤ä¸ªä¸€èˆ¬æ˜¯åœ¨ä¸€èµ·è°ƒç”¨çš„ï¼Œå¹¶ä¸”é€šå¸¸æ˜¯åœ¨ è‡ªå®šä¹‰ ViewGroup ä¸­æ‰ä¼šæ¶‰åŠåˆ°ï¼ˆView ä¸­ä¹Ÿå¯ä»¥å®ç°ï¼Œæ¯”å¦‚ TextView å°±é‡å†™äº† `onLayout()` æ–¹æ³•ï¼‰
>
> - View çš„ç»˜åˆ¶
>
>   > ç»˜åˆ¶å°±æ˜¯ä¸ Draw ç›¸å…³çš„æ–¹æ³•ï¼Œå¦‚ï¼š`onDraw()`
>   >
>   > ä¸ºä»€ä¹ˆè¦åˆ—å‡ºç»˜åˆ¶ï¼Ÿ
>   >
>   > å› ä¸ºå¾ˆå¤šåŠ¨ç”»éƒ½æ˜¯ä¾é é‡å†™ç»˜åˆ¶æ¥å®ç°çš„ï¼Œæ‰€ä»¥ç»˜åˆ¶ä¹Ÿæ¯”è¾ƒé‡è¦
>
> - äº‹ä»¶åˆ†å‘
>
>   >ä¸€èˆ¬æŒ‡è§¦æ‘¸äº‹ä»¶çš„åˆ†å‘
>   >
>   >è¿™ä¸ªåº”è¯¥æ˜¯è‡ªå®šä¹‰ View ä¸­æœ€éš¾ä¹Ÿæœ€é‡è¦çš„å†…å®¹äº†ï¼Œå¦‚æœä½ æƒ³è®¾è®¡å‡ºä¸€äº›å¾ˆç‚«é…·çš„ç•Œé¢ï¼Œå°±å¾—ç²¾é€šäº‹ä»¶åˆ†å‘
>   >
>   >äº‹ä»¶åˆ†å‘ä¼šåœ¨ä¸‹ä¸‹èŠ‚è¯¾è®²è§£
>
> æ¥ä¸‹æ¥å°±æ˜¯æ­£å¼å¼€å§‹è®²è§£è‡ªå®šä¹‰ View çš„æ—¶é—´ï¼Œç”±äºæ—¶é—´åŸå› ï¼Œåœ¨åŠ ä¸Šä½ ä»¬çš„ç°é˜¶æ®µèƒ½åŠ›çš„åŸå› ï¼Œæœ¬èŠ‚è¯¾æ›´åå‘äºè®²è§£å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰ Viewï¼Œè€Œä¸æ˜¯è®²è§£åº•å±‚å†…å®¹ï¼Œåº•å±‚å†…å®¹ä»¥åšå®¢çš„å½¢å¼åˆ†äº«

### 3ã€æ„é€ å‡½æ•°

> è¯¥éƒ¨åˆ†å†…å®¹å‚è€ƒï¼šhttps://www.cnblogs.com/angeldevil/p/3479431.html#three
>
> View ä¸€å…±æœ‰å››ä¸ªæ„é€ å‡½æ•°
>
> ```java
> // è¿™ä¸ªç”¨äºåœ¨ä»£ç ä¸­ç›´æ¥ new ä¸€ä¸ª View
> public View(Context context)
>     
> // è¿™ä¸ªç”¨äºåœ¨ xml ä¸­ä¹¦å†™ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†ä½ å†™åœ¨ xml ä¸­çš„å±æ€§è£…æ¢ä¸º AttributeSet ç±»ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªå‡½æ•°
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs
> )
> 
> // è¿™ä¸ªä¸€èˆ¬ç”¨äºè®¾ç½®é»˜è®¤å±æ€§ï¼Œä½¿ç”¨çš„æƒ…å†µè¾ƒå°‘
> // ç³»ç»Ÿä¸ä¼šä¸»åŠ¨è°ƒç”¨ï¼Œä¸€èˆ¬æ˜¯å¼€å‘è€…è‡ªå·±è®¾ç½®
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs, 
>     int defStyleAttr
> )
> 
> // è¿™ä¸ªä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œä¹Ÿæ˜¯è®¾ç½®é»˜è®¤å±æ€§ï¼Œä½¿ç”¨çš„æƒ…å†µå¾ˆå°‘ï¼Œä¸”åªæ”¯æŒ Android 5.0 ä»¥ä¸Š
> // ç³»ç»Ÿä¸ä¼šä¸»åŠ¨è°ƒç”¨
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs, 
>     int defStyleAttr, 
>     int defStyleRes
> )
> ```
>
> å‰é¢ä¸¤ä¸ªæ„é€ å‡½æ•°å„ä½åº”è¯¥éƒ½èƒ½çœ‹æ‡‚ï¼Œå…³é”®åœ¨äºåé¢ä¸¤ä¸ªï¼Œä»–ä»¬ä¸è®¾ç½®é»˜è®¤å±æ€§ç›¸å…³ï¼Œåœ¨è®²è§£å‰æˆ‘ä»¬å…ˆå¾—çŸ¥é“ä¸€ä¸ª View å¯ä»¥é€šè¿‡å“ªäº›æ–¹å¼è®¾ç½®å±æ€§
>
> ### 1ã€ç›´æ¥å†™åœ¨ XML ä¸­
>
> > ```xml
> > <androidx.cardview.widget.CardView
> >     android:layout_width="200dp"
> >     android:layout_height="200dp"
> >     app:cardBackgroundColor="@android:color/darker_gray"
> >     app:cardCornerRadius="8dp"/>
> > ```
> >
> > è¿™æ ·å°±ä¼šç»™å½“å‰ View è®¾ç½®å±æ€§
> >
> > åŸç†æ˜¯ç³»ç»Ÿè‡ªåŠ¨æŠŠè¿™äº›å±æ€§å†™å…¥åˆ° AttributeSet ç±»é‡Œé¢ï¼Œç„¶åè°ƒç”¨
> >
> > ```java
> > public View(Context context, @Nullable AttributeSet attrs)
> > ```
> >
> > æ¥ç”Ÿæˆ View å¯¹è±¡
>
> ### 2ã€ä½¿ç”¨ @style è®¾ç½®å±æ€§
>
> > åœ¨ `style.xml` ä¸­ï¼š
> >
> > ```xml
> > <style name="myCardView_style">
> >     <item name="cardBackgroundColor">@android:color/darker_gray</item>
> >     <item name="cardCornerRadius">8dp</item>
> > </style>
> > ```
> >
> > åœ¨ `layout.xml` ä¸­ï¼š
> >
> > ```xml
> > <androidx.cardview.widget.CardView
> >     android:layout_width="200dp"
> >     android:layout_height="200dp"
> >     style="@style/myCardView_style"/>
> > ```
> >
> > è¿™ä¸ªä¸€èˆ¬ç”¨äºå¤šä¸ªç›¸åŒæ§ä»¶å¤ç”¨å±æ€§çš„æ—¶å€™
> >
> > åŸç†ä¸ä¸Šä¸€ä¸ªæ˜¯ä¸€æ ·çš„ï¼Œå®ƒä¼šæŠŠ `style="@style/MyCardView"` é‡Œå†™çš„å±æ€§ä¸€èµ·å†™å…¥ AttributeSet ç±»é‡Œé¢
> >
> > > é—®é¢˜ï¼šå¦‚æœ `style="@style/MyCardView"` ä¸ xml ä¸­æœ‰ç›¸åŒå±æ€§å®ƒä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ
> > >
> > > ç»è¿‡æµ‹è¯•åï¼Œxml ä¸­å®šä¹‰çš„å±æ€§ä¼šè¦†ç›– `style="@style/MyCardView"` ä¸­å®šä¹‰çš„å±æ€§
> >
> > 
>
> ### 3ã€åœ¨ theme ä¸­è®¾ç½®æŸç§æ§ä»¶çš„é»˜è®¤å±æ€§
>
> > åœ¨ `theme.xml` ä¸­ï¼š
> >
> > ```xml
> > <style name="MyAppTheme" parent="Theme.MaterialComponents">
> >     <!--ä¸‹é¢è¿™ä¸ª @style/MyCardView å°±æ˜¯å‰é¢å†™çš„ <style name="MyCardView">-->
> >     <item name="cardViewStyle">@style/myCardView_style</item>
> > </style>
> > ```
> >
> > > è¿™é‡Œ `name="cardViewStyle"` æ„æ€æ˜¯å®šä¹‰ CardView çš„é»˜è®¤å±æ€§
> > > è¿™ä¸ªé»˜è®¤å±æ€§æ˜¯å¦‚ä½•ç”Ÿæ•ˆçš„å‘¢ï¼Ÿ
> > >
> > > ```java
> > > // åŸå› åœ¨äº CardView çš„æ„é€ å‡½æ•°
> > > public CardView(
> > >     @NonNull Context context, 
> > >     @Nullable AttributeSet attrs
> > > ) {
> > >     this(context, attrs, R.attr.cardViewStyle);
> > > }
> > > 
> > > public CardView(
> > >     @NonNull Context context, 
> > >     @Nullable AttributeSet attrs, 
> > >     int defStyleAttr
> > > ) {
> > >     super(context, attrs, defStyleAttr);
> > > }
> > > ```
> > >
> > > è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ä½¿ç”¨äº† `this(context, attrs, R.attr.cardViewStyle)` è°ƒç”¨äº†ä¸‰ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œå…¶ä¸­ä»–ç»™ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥äº†ä¸€ä¸ªå€¼ `R.attr.cardViewStyle`ï¼Œæˆ‘ä»¬å»æ‰’å®ƒæºç ï¼Œçœ‹ä¸‹è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼ˆç›´æ¥ç‚¹å‡»å¯¼åŒ…ä¸­çš„ `import androidx.cardview.R` å°±å¯ä»¥è·³åˆ°æºç ä¸­ï¼‰
> > >
> > > ```xml
> > > <resources>
> > >     <attr format="reference" name="cardViewStyle"/>
> > > </resources>
> > > ```
> > >
> > > è¿™é‡Œå¯èƒ½ä½ ä»¬ä¼šçœ‹ä¸æ‡‚ï¼Œæˆ‘ç®€å•è®²ä¸€ä¸‹ï¼šè¿™ä¸ª `format="reference"` ä»£è¡¨è¿™ä¸ªå±æ€§æ¥å—çš„ç±»å‹ï¼Œè€Œ `reference` è¡¨ç¤ºæ¥å—çš„ç±»å‹ä¸ºä¸€ä¸ªå¼•ç”¨å€¼ï¼Œæ¯”å¦‚ï¼š`@style/xxx`ã€`@color/xxx`ã€`@drawable/xxx` å°±æ˜¯å¼•ç”¨å€¼
> > >
> > > ç„¶å `name="cardViewStyle"` ä»£è¡¨è¿™ä¸ªå±æ€§çš„å”¯ä¸€åå­—
> > >
> > > è¿™ä¸ª attr çš„å¼•ç”¨å°±æ˜¯ CardView å¯ä»¥åœ¨ theme ä¸­è®¾ç½®é»˜è®¤å±æ€§çš„åŸå› ï¼Œå› ä¸ºç³»ç»Ÿè°ƒç”¨ CardView ä¸¤ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œç„¶åå®ƒè¿™ä¸ªæ„é€ å‡½æ•°ä¸»åŠ¨è°ƒç”¨äº†ä¸‰ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”ä¼ å…¥äº† `R.attr.cardViewStyle`ï¼Œæ‰€ä»¥æ„é€ å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°å¯¹åº”çš„æ˜¯ä¸€ä¸ª`style` æ ¼å¼çš„å¼•ç”¨ï¼Œä½†éœ€è¦ä½ è‡ªå·±åœ¨ View ä¸­æŒ‡å®šåå­—
> >
> > å¼•ç”¨ `theme.xml` æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š
> >
> > > - å…¨å±€å¼•ç”¨ï¼Œæ‰€æœ‰ View éƒ½ä¼šä½¿ç”¨è¯¥é…ç½®
> > >
> > >   ```xml
> > >   <application
> > >       android:theme="@style/MyAppTheme">
> > >   </application>
> > >   ```
> > >
> > > - æŸä¸ª Activity å¼•ç”¨ï¼Œå½“å‰ ACtivity å†…ä½¿ç”¨è¯¥é…ç½®
> > >
> > >   ```xml
> > >   <activity
> > >       android:name=".section3.test.TestActivity"
> > >       android:theme="@style/MyAppTheme"
> > >       android:exported="false" />
> > >   ```
> > >
> > > - æŸä¸ª Activity ä½¿ç”¨ä»£ç å¼•ç”¨
> > >
> > >    ```kotlin
> > >    override fun onCreate(savedInstanceState: Bundle?) {
> > >        super.onCreate(savedInstanceState)
> > >        setTheme(R.style.MyAppTheme)
> > >        setContentView(R.layout.layout_card0)
> > >    }
> > >    // æ³¨æ„åœ¨ Activity ä¸­ä½¿ç”¨å¿…é¡»åœ¨ setContentView ä¹‹å‰
> > >    ```
> > >
> > > - å•ä¸ª View ä½¿ç”¨
> > >
> > >   ```xml
> > >   <androidx.cardview.widget.CardView
> > >       android:layout_width="200dp"
> > >       android:layout_height="200dp"
> > >       android:theme="@style/MyAppTheme" />
> > >   ```
> >
> > çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½æœ‰ç‚¹æ™•ï¼Œæˆ‘ä»¬ç®€å•æ¢³ç†ä¸€ä¸‹æµç¨‹ï¼š
> >
> > ```flow
> > read=>operation: ç³»ç»Ÿè¯»å–ä½ å†™çš„ xml
> > new=>operation: ç”Ÿæˆ AttributeSetï¼Œç„¶åè°ƒç”¨ä¸¤ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°
> > first=>operation: ä¸¤ä¸ªå‚æ•°çš„è°ƒç”¨ä¸‰ä¸ªå‚æ•°çš„ï¼Œå¹¶ä¼ å…¥ R.attr.cardViewStyle
> > second=>operation: View å¼€å§‹ä» theme ä¸­è¯»å–å±æ€§
> > third=>operation: View åœ¨ theme ä¸­å‘ç° <item name="cardViewStyle">@style/myCardView_style</item> çš„å®šä¹‰
> > fourth=>operation: è¯»å– @style/MyCardView é‡Œé¢çš„å±æ€§
> > read->new->first->second->third->fourth
> > ```
> >
> > 
>
> ### 4ã€è°ƒç”¨æ„é€ å‡½æ•°çš„ defStyleRes
>
> > ç”±äº CardView æ²¡æœ‰é‡å†™ç¬¬å››ä¸ªæ„é€ å‡½æ•°ï¼ˆå¯èƒ½æ˜¯ä¸ºäº†å…¼å®¹ Android 5.0 ä»¥ä¸‹ï¼Ÿï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ç”¨ FrameLayout æ¥æ¼”ç¤º
> >
> > å…ˆåœ¨ `style.xml` ä¸­å®šä¹‰å±æ€§ï¼š
> >
> > ```xml
> > <style name="myFrameLayout">
> >     <item name="android:layout_width">match_parent</item>
> >     <item name="android:layout_height">match_parent</item>
> >     <item name="android:background">@android:color/black</item>
> > </style>
> > ```
> >
> > ç„¶ååœ¨ä»£ç ä¸­è¿™æ ·ä½¿ç”¨ï¼š
> >
> > ```kotlin
> > val frameLayout = FrameLayout(this, null, 0, R.style.myFrameLayout_style)
> > ```
> >
> > å½“ä½ ä¸èƒ½åœ¨ xml ä¸­ç”³æ˜ï¼Œåªèƒ½åœ¨ä»£ç ä¸­åŠ¨æ€ç”Ÿæˆæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§å†™æ³•ï¼Œæœ‰ä¸ªä¼˜ç‚¹å°±æ˜¯ä½¿ç”¨ `style.xml` å¯ä»¥è¿›è¡Œå±æ€§çš„å¤ç”¨ï¼Œä½†ä¸€èˆ¬éƒ½ç”¨ä¸åˆ°å¤ç”¨ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ LayoutParams å’Œè°ƒç”¨å¯¹åº”æ–¹æ³•æ¥ä»£æ›¿ï¼š
> >
> > ```kotlin
> > val frameLayout = FrameLayout(this)
> > // Android ç¬¬ä¸€èŠ‚è¯¾æˆ‘ä»¬è®²è¿‡ï¼Œçˆ¶å¸ƒå±€å¯ä»¥ç»™å­å¸ƒå±€è®¾ç½®å±æ€§
> > // ä¸”å±æ€§éƒ½ä»¥ layout_ å¼€å¤´ï¼Œæ‰€ä»¥ layout_width å’Œ layout_height 
> > // å¯¹åº”ç”± LayoutParams æ¥è®¾ç½®
> > frameLayout.layoutParams = ViewGroup.LayoutParams(
> >     ViewGroup.LayoutParams.MATCH_PARENT,
> >     ViewGroup.LayoutParams.MATCH_PARENT
> > )
> > // background å±äº View è‡ªèº«å±æ€§ï¼Œæ‰€ä»¥å¯¹åº” View è‡ªèº«æ–¹æ³•
> > frameLayout.setBackgroundColor(Color.BLACK)
> > 
> > // ä½†è¿™æ ·å†™æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼šLayoutParams è¿™ä¸œè¥¿åªèƒ½è®¾ç½®å°‘é‡çš„å±æ€§ï¼Œ
> > // è€Œä¸” LayoutParams æœ‰å¾ˆå¤šä¸ªï¼Œå…·ä½“é€‰æ‹©é‚£ä¸ªéœ€è¦çœ‹ä½ çš„ View è¢«æ·»åŠ åˆ°
> > // å“ªç§çˆ¶å¸ƒå±€é‡Œï¼Œå¦‚æœæ˜¯ LinearLayoutï¼Œå°±æ˜¯ LinearLayout.LayoutParams(...)
> > ```
> >
> > å¯èƒ½æœ‰äººä¸çŸ¥é“ LayoutParams æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œä½ æš‚æ—¶å¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯ç”¨æ¥ä¿å­˜ View ä¸­æœ‰å…³**çˆ¶å¸ƒå±€å±æ€§**çš„ä¸€ä¸ªæ•°æ®ç±»ï¼Œä¾›çˆ¶å¸ƒå±€ä½¿ç”¨ï¼Œåé¢ä¼šå†æ¬¡è®²è§£
> >
> > é™¤äº†ä¸Šé¢è¿™ç§åŠ¨æ€ç”Ÿæˆæ—¶ä¼ å…¥é»˜è®¤å±æ€§ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æ„é€ å™¨ä¸­è®¾ç½®ä½ çš„è‡ªå®šä¹‰ View çš„é»˜è®¤å±æ€§ï¼š
> >
> > ä¸€èˆ¬æ˜¯è¿™æ ·å®šä¹‰æ„é€ å™¨çš„ï¼š
> >
> > ```java
> > // ç”±äº java æ˜¯åŸºç¡€ï¼Œæˆ‘å…ˆç”¨ java æ¥å®šä¹‰æ„é€ å™¨ï¼Œåé¢å†ä½¿ç”¨ kt æ¥ä¼˜åŒ–å†™æ³•
> > public class Section3View extends View {
> >     public Section3View(Context context) {
> >         // æ³¨æ„è¿™é‡Œè°ƒç”¨çš„æ˜¯ thisï¼Œè€Œä¸æ˜¯ super
> >         this(context, null);
> >     }
> > 
> >     public Section3View(
> >         Context context, 
> >         @Nullable AttributeSet attrs
> >     ) {
> >         // æ³¨æ„è¿™é‡Œè°ƒç”¨çš„æ˜¯ thisï¼Œè€Œä¸æ˜¯ super
> >         this(context, attrs, R.attr.mySection3View_attrs);
> >     }
> > 
> >     public Section3View(
> >         Context context, 
> >         @Nullable AttributeSet attrs, 
> >         int defStyleAttr
> >     ) {
> >         // æ³¨æ„è¿™é‡Œè°ƒç”¨çš„æ˜¯ thisï¼Œè€Œä¸æ˜¯ super
> >         // è¿™é‡Œå°±æ˜¯è®¾ç½®é»˜è®¤å±æ€§
> >         this(
> >             context, 
> >             attrs, 
> >             defStyleAttr, 
> >             R.style.mySection3View_defaultAttrs
> >         );
> >     }
> > 
> >     public Section3View(
> >         Context context, 
> >         @Nullable AttributeSet attrs, 
> >         int defStyleAttr, 
> >         int defStyleRes
> >     ) {
> >         // ç›´åˆ°è¿™é‡Œæ‰è°ƒç”¨ super
> >         super(context, attrs, defStyleAttr, defStyleRes);
> >     }
> > }
> > ```
> >
> > å…¶ä¸­ `R.attr.mySection3View_attrs`ï¼š
> >
> > ```xml
> > <!--value/attrs.xml-->
> > <resources>
> >     <attr name="mySection3View_attrs" format="reference"/>
> > </resources>
> > ```
> >
> > å…¶ä¸­ `R.style.mySection3View_defaultAttrs`ï¼š
> >
> > ```xml
> > <!--value/style.xml-->
> > <style name="mySection3View_defaultAttrs">
> >     <item name="android:background">@android:color/black</item>
> > </style>
> > ```
> >
> > å¦‚æœä½ å»å¯¹ç…§å®˜æ–¹æ§ä»¶çš„å†™æ³•ï¼Œä½ ä¼šå‘ç°ä»–ä»¬çš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯è¿™æ ·å†™çš„ï¼Œå‰ä¸‰ä¸ªéƒ½æ˜¯è°ƒç”¨ `this()`ï¼Œåªæœ‰æœ€åä¸€ä¸ªè°ƒç”¨   `super()`ï¼Œä½†ä»–ä»¬ä¸€èˆ¬åªè®¾ç½®äº† `R.attr.mySection3View_attrs`ï¼Œç”¨äºå¼€å‘è€…åœ¨ theme ä¸­å®šä¹‰å…¨å±€å±æ€§ï¼ˆ[ç¬¬ä¸‰ç‚¹](#3ã€åœ¨ theme ä¸­è®¾ç½®æŸç§æ§ä»¶çš„é»˜è®¤å±æ€§)ï¼‰ï¼Œè€Œ `R.style.mySection3View_defaultAttrs` åœ¨å®˜ç½‘æ§ä»¶ä¸­ä¸€èˆ¬æ²¡è®¾ç½®ï¼Œéƒ½æ˜¯å†™ä¸ª 0ï¼Œä»£è¡¨æ²¡å¾—é»˜è®¤å±æ€§
> >
> > >ä¸ºä»€ä¹ˆæœ‰ä¸¤ä¸ªé»˜è®¤å±æ€§ï¼Ÿ
> > >
> > >```java
> > >public View(
> > >    Context context, 
> > >    @Nullable AttributeSet attrs, 
> > >    int defStyleAttr, 
> > >    int defStyleRes
> > >)
> > >```
> > >
> > >ä½ ä¼šå‘ç°ç¬¬ä¸‰ä¸ªå‚æ•° `defStyleAttr` å’Œç¬¬å››ä¸ª `defStyleRes` éƒ½æ˜¯è®¾ç½®é»˜è®¤å‚æ•°ï¼Œä½†ä¸ºä»€ä¹ˆè¦åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå‘¢ï¼Ÿ
> > >
> > >åŸå› ï¼š`defStyleAttr` æ˜¯ä» theme ä¸­è¯»å–é»˜è®¤å€¼ï¼Œä½†å¦‚æœæˆ‘ä»¬åªèƒ½åŠ¨æ€ç”Ÿæˆ Viewï¼Œåˆéœ€è¦å¤šæ¬¡ç”¨åˆ°ä¸€äº›å±æ€§ï¼Œåœ¨ Android 5.0 ä¹‹å‰è¦ä¹ˆæ¯æ¬¡éƒ½æ‰‹åŠ¨è°ƒç”¨æ–¹æ³•æ¥è®¾ç½®ï¼Œè¦ä¹ˆå†™åœ¨ theme ä¸­ï¼Œä½†è¿™æ ·æœªå…éº»çƒ¦äº†äº›ï¼Œåœ¨ Android 5.0 åå¢åŠ äº†è¿™ä¸ª `defStyleRes` å‚æ•°ï¼Œå°±å¯ä»¥ç›´æ¥æŠŠå±æ€§å†™åœ¨ `style.xml` ä¸­ï¼Œæ–¹ä¾¿å¤ç”¨
> > >
> > >**ä½†è¿™é‡Œæœ‰å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼š**ä½¿ç”¨ `defStyleRes` æ—¶ä¸èƒ½è®¾ç½® `defStyleAttr`ï¼Œç»™ `defStyleAttr` å¡«å…¥ 0 æˆ–è€… theme ä¸­ä¸è®¾ç½®å¯¹åº”çš„å±æ€§å³å¯
> >
> > å›åˆ°è¿™é‡Œï¼Œå‰é¢ java çš„å†™æ³•ç¡®å®æ„Ÿè§‰æœ‰äº›è‡ƒè‚¿äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ kt çš„å†™æ³•ï¼š
> >
> > ```kotlin
> > // å¿…é¡»æ·»åŠ  @JvmOverloadsï¼Œä¸ç„¶ java å±‚æ— æ³•ä½¿ç”¨è¯¥æ„é€ å™¨
> > // ä¼šå¯¼è‡´ xml ä¸­çš„ View æ— æ³•ç”Ÿæˆ
> > class Section3ViewKt @JvmOverloads constructor(
> >     context: Context,
> >     attrs: AttributeSet? = null,
> >     defStyleAttr: Int = R.attr.mySection3View_attrs,
> >     defStyleRes: Int = R.style.mySection3View_defaultAttrs
> > ) : View(context, attrs, defStyleAttr, defStyleRes) {
> > }
> > // å¦‚æœä½ æ²¡å¾— R.attr.mySection3View æˆ– R.style.MySection3View_defaultAttrs
> > // å¯ä»¥ç›´æ¥èµ‹å€¼ä¸º 0ï¼Œå°±æ˜¯æ²¡å¾—é»˜è®¤å±æ€§è®¾ç½®
> > ```
>
> **è®²åˆ°è¿™é‡Œï¼Œæ„é€ å‡½æ•°ä¸­çš„å››ä¸ªå‚æ•°å„ä½åº”è¯¥çŸ¥é“æœ‰ä»€ä¹ˆä½œç”¨äº†ï¼Œè¿™é‡Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼š**
>
> ```java
> public View(Context context)
> // ç”¨äºåœ¨ä»£ç ä¸­åŠ¨æ€ç”Ÿæˆè‡ªå®šä¹‰ View
> ```
>
> ```java
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs
> )
> // ç”¨äºå†™åœ¨ xml é‡Œé¢ç³»ç»Ÿè°ƒç”¨
> ```
>
> ```java
> public View(
>     Context context,
>     @Nullable AttributeSet attrs, 
>     int defStyleAttr
> )
> // ç”¨äºè®¾ç½®å…¨å±€é»˜è®¤å±æ€§å€¼ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¸Šé¢ä¸¤ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°æ¥é—´æ¥è°ƒç”¨
> ```
>
> ```java
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs, 
>     int defStyleAttr, 
>     int defStyleRes
> )
> // ä¹Ÿæ˜¯ç”¨äºè®¾ç½®é»˜è®¤å±æ€§å€¼ï¼Œåªæ˜¯ä¸ç”¨å†™åœ¨ theme ä¸­ï¼Œé€šå¸¸ç”¨äºåŠ¨æ€ç”Ÿæˆä»£ç ä¸­æˆ–è‡ªå·±è‡ªå®šä¹‰ View çš„æ—¶å€™
> ```
>
> å‰é¢è®²äº† 4 ç§æ–¹å¼æ¥è®¾ç½®å±æ€§ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼ä¹Ÿå¯ä»¥æ¥è®¾ç½®å±æ€§
>
> ### 5ã€ç›´æ¥åœ¨ theme ä¸­å®šä¹‰å±æ€§
>
> è¿™ä¸ªä¸ç¬¬ä¸‰ç‚¹ï¼š[åœ¨ theme ä¸­è®¾ç½®æŸç§æ§ä»¶çš„é»˜è®¤å±æ€§](#3ã€åœ¨ theme ä¸­è®¾ç½®æŸç§æ§ä»¶çš„é»˜è®¤å±æ€§) æœ‰äº›ç±»ä¼¼ï¼Œä½†å®ƒå€¼å…è®¸ç›´æ¥å†™åœ¨ theme ä¸­
>
> ```xml
> <resources xmlns:tools="http://schemas.android.com/tools">
>     <style name="Theme.CustomViewWithAnimStudy" parent="Theme.MaterialComponents.DayNight.DarkActionBar">
>         <!--å¦‚æœä½ åŠ äº†è¿™è¡Œä»£ç ï¼Œä½ ä¼šå‘ç°åº”ç”¨å¤§éƒ¨åˆ†æ§ä»¶å˜æˆé»‘è‰²äº†-->
>         <item name="android:background">@android:color/black</item>
>     </style>
> </resources>
> ```
>
> **ä½†æ˜¯ï¼Œ**è¿™ä¸ªæ˜¯ä¸åˆ†æ§ä»¶çš„ç»™å…¨éƒ¨ View è®¾ç½®å±æ€§ï¼Œä¸€èˆ¬ä¸ä¼šä½¿ç”¨åˆ°å®ƒï¼Œåªæœ‰è®¾ç½®æ•´ä¸ªåº”ç”¨çš„ä¸»é¢˜æ—¶ä¼šç”¨åˆ°
>
> æ¯”å¦‚ä½ å¯ä»¥è¯•è¯•æŠŠè¿™å‡ ä¸ªå±æ€§æ”¹ä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°åº”ç”¨çš„æ ‡é¢˜æ é¢œè‰²ä»ç´«è‰²æ”¹æˆäº†ä½ è®¾ç½®çš„é¢œè‰²
>
> ```xml
> <item name="colorPrimary">@color/purple_500</item>
> <item name="colorPrimaryVariant">@color/purple_700</item>
> <item name="colorOnPrimary">@color/white</item>
> <item name="colorSecondary">@color/teal_200</item>
> <item name="colorSecondaryVariant">@color/teal_700</item>
> <item name="colorOnSecondary">@color/black</item>
> ```
>
> è¿™äº›å±æ€§å¯¹åº”äº†æŸç§å…·ä½“ä½ç½®çš„é¢œè‰²ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡åšå®¢ï¼šhttps://blog.csdn.net/smartzzg/article/details/104788412
>
> ### äº”ç§å±æ€§å®šä¹‰æ–¹æ³•çš„é¡ºåº
>
> > æˆ‘ä»¬è®²äº†æœ‰ 5 ç§ä¸åŒçš„å±æ€§å®šä¹‰ï¼Œå¦‚æœå®šä¹‰äº†ç›¸åŒå±æ€§ï¼Œä»–ä»¬å­˜åœ¨ä¸€ä¸ªä¼˜å…ˆçº§é¡ºåºï¼š
> >
> > [1ã€ç›´æ¥å†™åœ¨ XML ä¸­](#1ã€ç›´æ¥å†™åœ¨ XML ä¸­)
> >
> > [2ã€ä½¿ç”¨ @style è®¾ç½®å±æ€§](#2ã€ä½¿ç”¨ @style è®¾ç½®å±æ€§)
> >
> > [3ã€åœ¨ theme ä¸­è®¾ç½®æŸç§æ§ä»¶çš„é»˜è®¤å±æ€§](#3ã€åœ¨ theme ä¸­è®¾ç½®æŸç§æ§ä»¶çš„é»˜è®¤å±æ€§)
> >
> > [4ã€è°ƒç”¨æ„é€ å‡½æ•°çš„ defStyleRes](#4ã€è°ƒç”¨æ„é€ å‡½æ•°çš„ defStyleRes)
> >
> > [5ã€ç›´æ¥åœ¨ theme ä¸­å®šä¹‰å±æ€§](#5ã€ç›´æ¥åœ¨ theme ä¸­å®šä¹‰å±æ€§)
> >
> > è¿™é‡Œæ³¨æ„ï¼šä½¿ç”¨ `defStyleRes ` æ—¶ä¸èƒ½è®¾ç½® `defStyleAttr`ï¼Œç»™ `defStyleAttr` å¡«å…¥ 0 æˆ–è€… theme ä¸­ä¸è®¾ç½®å¯¹åº”çš„å±æ€§å³å¯
>
> **åˆ°è¿™é‡Œ View çš„å››ä¸ªæ„é€ å‡½æ•°åŸºæœ¬åˆ†æå®Œæ¯•äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è®²è§£é‡Œé¢çš„æ–¹æ³•**

### 4ã€onDraw()

> 

### 5ã€è‡ªå®šä¹‰å±æ€§AttributeSet

### 6ã€invalidate()

### 7ã€onMeasure()

### 8ã€onLayout()

### 9ã€LayoutParams

### 10ã€requestLayout()

### 11ã€*ViewRootImpl

### 12ã€å‘å¸ƒå¼€æºåº“

### 13ã€åˆ†äº«ä¸€äº›ä¸œè¥¿

> è°æƒ³å†™è‡ªå®šä¹‰ View å•Šï¼Œä½ æƒ³å†™å—ï¼Ÿæ­£ç»äººå†™ä»€ä¹ˆè‡ªå®šä¹‰ Viewã€‚
>
> è‡ªå®šä¹‰ View ç¡®å®å¾ˆéš¾ï¼Œä¸œè¥¿åˆå¤šåˆæ‚ï¼Œåœ¨è€ƒè™‘å†™è‡ªå®šä¹‰ View ä¹‹å‰ï¼Œè¯·å…ˆæœç´¢ä¸€ä¸‹æ˜¯å¦æœ‰åˆ«äººå·²ç»é€ å¥½çš„è½®å­ï¼Œæœ‰è½®å­ç›´æ¥ç”¨ï¼Œä»–ä¸é¦™å—ï¼Ÿ[ç‹—å¤´]
>
> è¿™é‡Œåˆ†äº«ä¸€äº›è½®å­ï¼š
>
> ### 1ã€Material Design å®˜ç½‘
>
> > å®˜ç½‘é“¾æ¥ï¼šhttps://material.io/
> >
> > æºç åœ°å€ï¼šhttps://github.com/material-components/material-components-android
> >
> > ç¤ºä¾‹ä¸‹è½½ï¼šhttps://github.com/material-components/material-components-android/releases
> >
> > è¿™é‡Œé¢çš„éƒ½ç®—å®˜æ–¹æ§ä»¶ï¼Œè€Œä¸”æœ‰å¾ˆå¤šï¼Œå¦‚æœæƒ³å®ç°æŸä¸ªåŠŸèƒ½æ—¶å¯ä»¥å»çœ‹çœ‹æ˜¯å¦å·²ç»æœ‰å®ç°äº†çš„ï¼Œä»–è¿˜ä¸“é—¨å†™äº†ä¸€ä¸ªå®ä¾‹ appï¼Œå¯ä»¥ä¸‹ä¸‹æ¥çœ‹çœ‹ï¼Œæ‰¾åˆ°æƒ³è¦çš„å†å»çœ‹ä»–çš„æºç 

## äºŒã€åŠ¨ç”»