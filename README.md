[TOC]

***Áî±‰∫éÈááÁî® Typora ‰π¶ÂÜôÔºågithub ‰∏çÊîØÊåÅÈÉ®ÂàÜÊ†ºÂºèÔºåÂª∫ËÆÆ clone ÂêéÁî® Typora ËßÇÁúã***

# Ëá™ÂÆö‰πâView‰∏éÂä®Áîª

## ‰∏Ä„ÄÅËá™ÂÆö‰πâView

### 1„ÄÅ‰∏∫‰ªÄ‰πàË¶ÅËá™ÂÆö‰πâÔºü

> ‰∏ÄÂè•ËØùÔºöÂÆòÊñπÁöÑÊéß‰ª∂Êª°Ë∂≥‰∏ç‰∫Ü‰∫ßÂìÅÊÉ≥Ë¶ÅÁöÑÊïàÊûú (
>
> ‰ΩÜÂÖ∂ÂÆûÔºåÂÆòÊñπÊéß‰ª∂Â∑≤ÁªèËÉΩÊª°Ë∂≥ÁªùÂ§ßÂ§öÊï∞ÈúÄÊ±Ç‰∫ÜÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãËá™ÂÆö‰πâ View ÊòØ‰∏ã‰∏ãÁ≠ñÔºåÂõ†‰∏∫ÈÄ†Ëá™ÂÆö‰πâ View ÁöÑËΩÆÂ≠êÊòØ‰∏Ä‰ª∂ÂæàËÄóÊó∂‰πüÂæàËÄóÁ≤æÂäõÁöÑ‰∫ã„ÄÇ
>
> ËøôÈáåÂàÜ‰∫´‰∏Ä‰∏ãÊàëÂ§ß‰∏ÄÊöëÂÅáÊó∂ÈÅáÂà∞ÁöÑ‰∫ãÊÉÖÔºåÂΩìÊó∂ÂÖ± 5 ‰∏™ÁªÑÂàÜÂºÄÂÅöÁßØÂàÜÂïÜÂüéÔºå‰∫ßÂìÅÁªô‰∫Ü‰∏Ä‰∏™ÁßØÂàÜÂïÜÂüéÁöÑËÆæËÆ°ÂõæÔºåÂÖ∂‰∏≠‰∏ªÈ°µÊúâ‰∏Ä‰∏™‰∏äÊªëÂ±ïÂºÄÁöÑÈúÄÊ±ÇÔºåÊàë‰ª¨ÁªÑÔºàÊàëÂíåÈíüÊô∫ÔºâÔºåÊàëÂ∞±Ë¥üË¥£ÂÅöËøô‰∏™‰∏äÊªëÁöÑÁïåÈù¢„ÄÇÂΩìÊó∂ÊàëËä±‰∫ÜÂ•ΩÂÉè 3„ÄÅ4 Â§©ÁöÑÊó∂Èó¥ÂéªËÆæËÆ°‰∏Ä‰∏™Ëá™ÂÆö‰πâ ViewÔºàÂéüË∞ÖÊàëÂΩìÊó∂Ëøò‰∏çÁü•ÈÅìÂçèË∞ÉËÄÖÂ∏ÉÂ±ÄËøô‰∏™‰∏úË•øÔºâÔºåÁªìÊûúÂïäÔºå‰∫ßÂìÅÊîπÈúÄÊ±Ç‰∫ÜÔºåÈù†
>
> ÁªèËøá‰∏äÈù¢ÁöÑËøô‰∏™ÊïÖ‰∫ãÂêéÔºåÁõ∏‰ø°Â§ßÂÆ∂Â∫îËØ•ÁêÜËß£Âà∞‰∫ÜÈÄâÊã©Ëá™ÂÆö‰πâ View ‰ºöÈù¢‰∏¥ÁöÑÈ£éÈô©
>
> ÂêéÊù•ÊàëÂèàËä±‰∫ÜÊé•Ëøë‰∏ÄÂë®ÁöÑÊó∂Èó¥ËøòÊòØÁî®Ëá™ÂÆö‰πâ View ÂÜôÂá∫‰∫Ü‰∫ßÂìÅÁöÑÊñ∞ÈúÄÊ±ÇÔºåÈôê‰∫éÂΩìÊó∂ÊàëÁöÑËÉΩÂäõÔºåÁé∞Âú®ÂéªÁúãÂΩìÊó∂ÂÜôÁöÑ‰ª£Á†ÅÔºåÂ≠òÂú®‰∏Ä‰∫õËÄ¶ÂêàÁöÑÂú∞ÊñπÔºåÁÆóÊòØÁªô‰ª•ÂêéÂ≠¶ÂºüÁïôÂùë‰∫ÜüòÅ
>
> OKÔºåÂõûÂà∞ËøôÈáåÔºåËá™ÂÆö‰πâ View Á°ÆÂÆûÊòØ‰∏ã‰∏ãÁ≠ñÔºå‰∏çÊ≠¢‰ºöÂΩ±Âìç‰Ω†ÁöÑÂøÉÊÉÖÔºåÂ¶ÇÊûú‰Ω†ÁöÑ‰ª£Á†ÅËÆæËÆ°Âæó‰∏çÂ•ΩÁöÑËØùÔºàÊØîÂ¶ÇËÄ¶ÂêàÂ∫¶ÂæàÈ´òÔºå‰ª£Á†ÅÈÄªËæëÊ∑∑‰π±ÔºâÔºåËøò‰ºöÂΩ±Âìç‰ª•ÂêéÁª¥Êä§‰ª£Á†Å‰∫∫ÁöÑÂøÉÊÉÖ„ÄÇÔºàËØ¥‰∏™Á¨ëËØùÔºöÂê¨ËØ¥‰ª£Á†ÅÂÜôÂæóË∂äÁÉÇÔºåË∂ä‰∏çÂÆπÊòìË¢´ËæûÈÄÄ :Ôºâ

### 2„ÄÅÂàÜÁ±ª

> ËøôÈáåËá™ÂÆö‰πâ View ÊòØ‰∏Ä‰∏™‰π†ÊÉØÊÄßÁöÑÁªüÁß∞
>
> Â¶ÇÊûúÊåâÁÖßÁ±ªÂûãÊù•ÂàÜÔºö
>
> - Ëá™ÂÆö‰πâ View
>
>   > ÊåáÁõ¥Êé•ÊàñÈó¥Êé•ÁªßÊâø‰∫é View ÁöÑÊéß‰ª∂ÔºåÂ¶ÇÔºöTextView„ÄÅButton
>   >
>   > ```java
>   > public class TextView extends View {}
>   > ```
>   >
>   > ```java
>   > public class Button extends TextView {}
>   > ```
>   >
>   > 
>
> - Ëá™ÂÆö‰πâ ViewGroup
>
>   > ```java
>   > public class LinearLayout extends ViewGroup {}
>   > ```
>   >
>   > ```java
>   > public class FrameLayout extends ViewGroup {}
>   > ```
>
> 
>
> Â¶ÇÊûúÊåâÁÖßÂ≠¶‰π†ÁöÑÂÜÖÂÆπÊù•ÂàÜÔºåÂ§ßËá¥ÂàÜ‰∏∫‰ª•‰∏ãÂÜÖÂÆπ
>
> - View ÁöÑÊµãÈáè‰∏éÂ∏ÉÂ±Ä
>
>   > ÊµãÈáèÂ∞±ÊòØ‰∏é Measure Áõ∏ÂÖ≥ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÔºö`onMeasure()`
>   >
>   > Â∏ÉÂ±ÄÂ∞±ÊòØ‰∏é Layout Áõ∏ÂÖ≥ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÔºö`onLayout()`
>   >
>   > Ëøô‰∏§‰∏™‰∏ÄËà¨ÊòØÂú®‰∏ÄËµ∑Ë∞ÉÁî®ÁöÑÔºåÂπ∂‰∏îÈÄöÂ∏∏ÊòØÂú® Ëá™ÂÆö‰πâ ViewGroup ‰∏≠Êâç‰ºöÊ∂âÂèäÂà∞ÔºàView ‰∏≠‰πüÂèØ‰ª•ÂÆûÁé∞ÔºåÊØîÂ¶Ç TextView Â∞±ÈáçÂÜô‰∫Ü `onLayout()` ÊñπÊ≥ïÔºâ
>
> - View ÁöÑÁªòÂà∂
>
>   > ÁªòÂà∂Â∞±ÊòØ‰∏é Draw Áõ∏ÂÖ≥ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÔºö`onDraw()`
>   >
>   > ‰∏∫‰ªÄ‰πàË¶ÅÂàóÂá∫ÁªòÂà∂Ôºü
>   >
>   > Âõ†‰∏∫ÂæàÂ§öÂä®ÁîªÈÉΩÊòØ‰æùÈù†ÈáçÂÜôÁªòÂà∂Êù•ÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•ÁªòÂà∂‰πüÊØîËæÉÈáçË¶Å
>
> - ‰∫ã‰ª∂ÂàÜÂèë
>
>   >‰∏ÄËà¨ÊåáËß¶Êë∏‰∫ã‰ª∂ÁöÑÂàÜÂèë
>   >
>   >Ëøô‰∏™Â∫îËØ•ÊòØËá™ÂÆö‰πâ View ‰∏≠ÊúÄÈöæ‰πüÊúÄÈáçË¶ÅÁöÑÂÜÖÂÆπ‰∫ÜÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥ËÆæËÆ°Âá∫‰∏Ä‰∫õÂæàÁÇ´ÈÖ∑ÁöÑÁïåÈù¢ÔºåÂ∞±ÂæóÁ≤æÈÄö‰∫ã‰ª∂ÂàÜÂèë
>   >
>   >‰∫ã‰ª∂ÂàÜÂèë‰ºöÂú®‰∏ã‰∏ãËäÇËØæËÆ≤Ëß£
>
> Êé•‰∏ãÊù•Â∞±ÊòØÊ≠£ÂºèÂºÄÂßãËÆ≤Ëß£Ëá™ÂÆö‰πâ View ÁöÑÊó∂Èó¥ÔºåÁî±‰∫éÊó∂Èó¥ÂéüÂõ†ÔºåÂú®Âä†‰∏ä‰Ω†‰ª¨ÁöÑÁé∞Èò∂ÊÆµËÉΩÂäõÁöÑÂéüÂõ†ÔºåÊú¨ËäÇËØæÊõ¥ÂÅèÂêë‰∫éËÆ≤Ëß£Â¶Ç‰Ωï‰ΩøÁî®Ëá™ÂÆö‰πâ ViewÔºåËÄå‰∏çÊòØËÆ≤Ëß£Â∫ïÂ±ÇÂÜÖÂÆπÔºåÂ∫ïÂ±ÇÂÜÖÂÆπ‰ª•ÂçöÂÆ¢ÁöÑÂΩ¢ÂºèÂàÜ‰∫´

### 3„ÄÅÊûÑÈÄ†ÂáΩÊï∞

> ËØ•ÈÉ®ÂàÜÂÜÖÂÆπÂèÇËÄÉÔºöhttps://www.cnblogs.com/angeldevil/p/3479431.html#three
>
> View ‰∏ÄÂÖ±ÊúâÂõõ‰∏™ÊûÑÈÄ†ÂáΩÊï∞
>
> ```java
> public class View {
> // Ëøô‰∏™Áî®‰∫éÂú®‰ª£Á†Å‰∏≠Áõ¥Êé• new ‰∏Ä‰∏™ ViewÔºåËøô‰∏™ context ‰∏ÄËà¨ÈÉΩÊòØ activityÔºå‰ª£Ë°®‰∏ä‰∏ãÊñá
> public View(Context context)
> 
> // Ëøô‰∏™Áî®‰∫éÂú® xml ‰∏≠‰π¶ÂÜôÔºåÁ≥ªÁªüËá™Âä®Â∞Ü‰Ω†ÂÜôÂú® xml ‰∏≠ÁöÑÂ±ûÊÄßË£ÖÊç¢‰∏∫‰∏Ä‰∏™ AttributeSet ÂØπË±°ÔºåÁÑ∂ÂêéË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞
> public View(
> Context context, 
> @Nullable AttributeSet attrs
> )
> 
> // Ëøô‰∏™‰∏ÄËà¨Áî®‰∫éËÆæÁΩÆÈªòËÆ§Â±ûÊÄßÔºå‰ΩøÁî®ÁöÑÊÉÖÂÜµËæÉÂ∞ë
> // Á≥ªÁªü‰∏ç‰ºö‰∏ªÂä®Ë∞ÉÁî®Ôºå‰∏ÄËà¨ÊòØÂºÄÂèëËÄÖËá™Â∑±ËÆæÁΩÆ
> public View(
> Context context, 
> @Nullable AttributeSet attrs, 
> int defStyleAttr
> )
> 
> // Ëøô‰∏™‰∏é‰∏äÈù¢ÁöÑÁ±ª‰ººÔºå‰πüÊòØËÆæÁΩÆÈªòËÆ§Â±ûÊÄßÔºå‰ΩøÁî®ÁöÑÊÉÖÂÜµ‰πüËæÉÂ∞ëÔºå‰∏îÂè™ÊîØÊåÅ Android 5.0 ‰ª•‰∏ä
> // Á≥ªÁªü‰∏ç‰ºö‰∏ªÂä®Ë∞ÉÁî®
> public View(
> Context context, 
> @Nullable AttributeSet attrs, 
> int defStyleAttr, 
> int defStyleRes
> )
> }
> 
> ```
>
> ÂâçÈù¢‰∏§‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÂêÑ‰ΩçÂ∫îËØ•ÈÉΩËÉΩÁúãÊáÇÔºåÂÖ≥ÈîÆÂú®‰∫éÂêéÈù¢‰∏§‰∏™Ôºå‰ªñ‰ª¨‰∏éËÆæÁΩÆÈªòËÆ§Â±ûÊÄßÁõ∏ÂÖ≥ÔºåÂú®ËÆ≤Ëß£ÂâçÊàë‰ª¨ÂÖàÂæóÁü•ÈÅì‰∏Ä‰∏™ View ÂèØ‰ª•ÈÄöËøáÂì™‰∫õÊñπÂºèËÆæÁΩÆÂ±ûÊÄß

#### 1„ÄÅÁõ¥Êé•ÂÜôÂú® XML ‰∏≠

> ```xml
> <androidx.cardview.widget.CardView
> android:layout_width="200dp"
> android:layout_height="200dp"
> app:cardBackgroundColor="@android:color/darker_gray"
> app:cardCornerRadius="8dp"/>
> ```
>
> ËøôÊ†∑Â∞±‰ºöÁªôÂΩìÂâç View ËÆæÁΩÆÂ±ûÊÄß
>
> ÂéüÁêÜÊòØÁ≥ªÁªüËá™Âä®ÊääËøô‰∫õÂ±ûÊÄßÂÜôÂÖ•Âà∞ AttributeSet Á±ªÈáåÈù¢ÔºåÁÑ∂ÂêéË∞ÉÁî®
>
> ```kotlin
> public View(Context context, @Nullable AttributeSet attrs)
> ```
>
> Êù•ÁîüÊàê View ÂØπË±°
>
> 

#### 2„ÄÅ‰ΩøÁî® @style ËÆæÁΩÆÂ±ûÊÄß

> Âú® `style.xml` ‰∏≠Ôºö
>
> ```xml
> <style name="myCardView_style">
>     <item name="cardBackgroundColor">@android:color/darker_gray</item>
>     <item name="cardCornerRadius">8dp</item>
> </style>
> ```
>
> Âú® `layout.xml` ‰∏≠Ôºö
>
> ```xml
> <androidx.cardview.widget.CardView
>  android:layout_width="200dp"
>  android:layout_height="200dp"
>  style="@style/myCardView_style"/>
> ```
>
> Ëøô‰∏™‰∏ÄËà¨Áî®‰∫éÂ§ö‰∏™Áõ∏ÂêåÊéß‰ª∂Â§çÁî®Â±ûÊÄßÁöÑÊó∂ÂÄô
>
> ÂéüÁêÜ‰∏é‰∏ä‰∏Ä‰∏™ÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂÆÉ‰ºöÊää `style="@style/MyCardView"` ÈáåÂÜôÁöÑÂ±ûÊÄß‰∏ÄËµ∑ÂÜôÂÖ• AttributeSet Á±ªÈáåÈù¢
>
> > ÈóÆÈ¢òÔºöÂ¶ÇÊûú `style="@style/MyCardView"` ‰∏é xml ‰∏≠ÊúâÁõ∏ÂêåÂ±ûÊÄßÂÆÉ‰ºöÊÄé‰πàÂ§ÑÁêÜÂë¢Ôºü
> >
> > ÁªèËøáÊµãËØïÂêéÔºåxml ‰∏≠ÂÆö‰πâÁöÑÂ±ûÊÄß‰ºöË¶ÜÁõñ `style="@style/MyCardView"` ‰∏≠ÂÆö‰πâÁöÑÂ±ûÊÄß
> >
> > 

#### 3„ÄÅÂú® theme ‰∏≠ËÆæÁΩÆÊüêÁßçÊéß‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß

> Âú® `theme.xml` ‰∏≠Ôºö
>
> ```xml
> <style name="MyAppTheme" parent="Theme.MaterialComponents">
>     <!--‰∏ãÈù¢Ëøô‰∏™ @style/MyCardView Â∞±ÊòØÂâçÈù¢ÂÜôÁöÑ <style name="MyCardView">-->
>     <item name="cardViewStyle">@style/myCardView_style</item>
> </style>
> ```
>
> ËøôÈáå `name="cardViewStyle"` ÊÑèÊÄùÊòØÂÆö‰πâ CardView ÁöÑÈªòËÆ§Â±ûÊÄß
> Ëøô‰∏™ÈªòËÆ§Â±ûÊÄßÊòØÂ¶Ç‰ΩïÁîüÊïàÁöÑÂë¢Ôºü
>
> ```java
> // ÂéüÂõ†Âú®‰∫é CardView ÁöÑÊûÑÈÄ†ÂáΩÊï∞
> public CardView(
>  @NonNull Context context, 
>  @Nullable AttributeSet attrs
> ) {
>  this(context, attrs, R.attr.cardViewStyle);
> }
> 
> public CardView(
>  @NonNull Context context, 
>  @Nullable AttributeSet attrs, 
>  int defStyleAttr
> ) {
>  super(context, attrs, defStyleAttr);
> }
> ```
>
> ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞Ôºå‰∏§‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞‰ΩøÁî®‰∫Ü `this(context, attrs, R.attr.cardViewStyle)` Ë∞ÉÁî®‰∫Ü‰∏â‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂÖ∂‰∏≠‰ªñÁªôÁ¨¨‰∏â‰∏™ÂèÇÊï∞‰º†ÂÖ•‰∫Ü‰∏Ä‰∏™ÂÄº `R.attr.cardViewStyle`ÔºåÊàë‰ª¨ÂéªÊâíÂÆÉÊ∫êÁ†ÅÔºåÁúã‰∏ãËøôÊòØ‰ªÄ‰πà‰∏úË•øÔºàÁõ¥Êé•ÁÇπÂáªÂØºÂåÖ‰∏≠ÁöÑ `import androidx.cardview.R` Â∞±ÂèØ‰ª•Ë∑≥Âà∞Ê∫êÁ†Å‰∏≠Ôºâ
>
> ```xml
> <resources>
>  <attr format="reference" name="cardViewStyle"/>
> </resources>
> ```
>
> ËøôÈáåÂèØËÉΩ‰Ω†‰ª¨‰ºöÁúã‰∏çÊáÇÔºåÊàëÁÆÄÂçïËÆ≤‰∏Ä‰∏ãÔºöËøô‰∏™ `format="reference"` ‰ª£Ë°®Ëøô‰∏™Â±ûÊÄßÊé•ÂèóÁöÑÁ±ªÂûãÔºåËÄå `reference` Ë°®Á§∫Êé•ÂèóÁöÑÁ±ªÂûã‰∏∫‰∏Ä‰∏™ÂºïÁî®ÂÄºÔºåÊØîÂ¶ÇÔºö`@style/xxx`„ÄÅ`@color/xxx`„ÄÅ`@drawable/xxx` Â∞±ÊòØÂºïÁî®ÂÄº
>
> ÁÑ∂Âêé `name="cardViewStyle"` ‰ª£Ë°®Ëøô‰∏™Â±ûÊÄßÁöÑÂîØ‰∏ÄÂêçÂ≠ó
>
> Ëøô‰∏™ attr ÁöÑÂºïÁî®Â∞±ÊòØ CardView ÂèØ‰ª•Âú® theme ‰∏≠ËÆæÁΩÆÈªòËÆ§Â±ûÊÄßÁöÑÂéüÂõ†ÔºåÂõ†‰∏∫Á≥ªÁªüË∞ÉÁî® CardView ‰∏§‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁÑ∂ÂêéÂÆÉËøô‰∏™ÊûÑÈÄ†ÂáΩÊï∞‰∏ªÂä®Ë∞ÉÁî®‰∫Ü‰∏â‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂπ∂‰∏î‰º†ÂÖ•‰∫Ü `R.attr.cardViewStyle`ÔºåÊâÄ‰ª•ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÂØπÂ∫îÁöÑÊòØ‰∏Ä‰∏™`style` Ê†ºÂºèÁöÑÂºïÁî®Ôºå‰ΩÜÈúÄË¶Å‰Ω†Ëá™Â∑±Âú® View ‰∏≠ÊåáÂÆöÂêçÂ≠ó
>
> ÂºïÁî® `theme.xml` Êúâ‰ª•‰∏ãÂá†ÁßçÊñπÂºèÔºö
>
> - ÂÖ®Â±ÄÂºïÁî®ÔºåÊâÄÊúâ View ÈÉΩ‰ºö‰ΩøÁî®ËØ•ÈÖçÁΩÆ
>
>   ```xml
>   <application
>       android:theme="@style/MyAppTheme">
>   </application>
>   ```
>
> - Êüê‰∏™ Activity ÂºïÁî®ÔºåÂΩìÂâç ACtivity ÂÜÖ‰ΩøÁî®ËØ•ÈÖçÁΩÆ
>
>   ```xml
>   <activity
>       android:name=".section3.test.TestActivity"
>       android:theme="@style/MyAppTheme"
>       android:exported="false" />
>   ```
>
> - Êüê‰∏™ Activity ‰ΩøÁî®‰ª£Á†ÅÂºïÁî®
>
>   ```kotlin
>   override fun onCreate(savedInstanceState: Bundle?) {
>       super.onCreate(savedInstanceState)
>       setTheme(R.style.MyAppTheme)
>       setContentView(R.layout.layout_card0)
>   }
>   // Ê≥®ÊÑèÂú® Activity ‰∏≠‰ΩøÁî®ÂøÖÈ°ªÂú® setContentView ‰πãÂâç
>   ```
>
> - Âçï‰∏™ View ‰ΩøÁî®
>
>   ```xml
>   <androidx.cardview.widget.CardView
>       android:layout_width="200dp"
>       android:layout_height="200dp"
>       android:theme="@style/MyAppTheme" />
>   ```
>
> ÁúãÂà∞ËøôÈáå‰Ω†ÂèØËÉΩÊúâÁÇπÊôïÔºåÊàë‰ª¨ÁÆÄÂçïÊ¢≥ÁêÜ‰∏Ä‰∏ãÊµÅÁ®ãÔºö
>
> ```flow
> read=>start: Á≥ªÁªüËØªÂèñ‰Ω†ÂÜôÁöÑ xml
> new=>operation: ÁîüÊàê AttributeSetÔºåÁÑ∂ÂêéË∞ÉÁî®‰∏§‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞
> first=>operation: ‰∏§‰∏™ÂèÇÊï∞ÁöÑË∞ÉÁî®‰∏â‰∏™ÂèÇÊï∞ÁöÑÔºåÂπ∂‰º†ÂÖ• R.attr.cardViewStyle
> second=>operation: View ÂºÄÂßã‰ªé theme ‰∏≠ËØªÂèñÂ±ûÊÄß
> third=>operation: View Âú® theme ‰∏≠ÂèëÁé∞ <item name="cardViewStyle">@style/myCardView_style</item> ÁöÑÂÆö‰πâ
> fourth=>end: ËØªÂèñ @style/MyCardView ÈáåÈù¢ÁöÑÂ±ûÊÄß
> read->new->first->second->third->fourth
> ```
>
> 

#### 4„ÄÅË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞ÁöÑ defStyleRes

> Áî±‰∫é CardView Ê≤°ÊúâÈáçÂÜôÁ¨¨Âõõ‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÔºàÂèØËÉΩÊòØ‰∏∫‰∫ÜÂÖºÂÆπ Android 5.0 ‰ª•‰∏ãÔºüÔºâÔºåÊâÄ‰ª•ËøôÈáåÊàëÁî® FrameLayout Êù•ÊºîÁ§∫
>
> ÂÖàÂú® `style.xml` ‰∏≠ÂÆö‰πâÂ±ûÊÄßÔºö
>
> ```xml
> <style name="myFrameLayout">
>  <item name="android:layout_width">match_parent</item>
>  <item name="android:layout_height">match_parent</item>
>  <item name="android:background">@android:color/black</item>
> </style>
> ```
>
> ÁÑ∂ÂêéÂú®‰ª£Á†Å‰∏≠ËøôÊ†∑‰ΩøÁî®Ôºö
>
> ```kotlin
> val frameLayout = FrameLayout(this, null, 0, R.style.myFrameLayout_style)
> ```
>
> ÂΩì‰Ω†‰∏çËÉΩÂú® xml ‰∏≠Áî≥ÊòéÔºåÂè™ËÉΩÂú®‰ª£Á†Å‰∏≠Âä®ÊÄÅÁîüÊàêÊó∂ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®ËøôÁßçÂÜôÊ≥ïÔºåÊúâ‰∏™‰ºòÁÇπÂ∞±ÊòØ‰ΩøÁî® `style.xml` ÂèØ‰ª•ËøõË°åÂ±ûÊÄßÁöÑÂ§çÁî®Ôºå‰ΩÜ‰∏ÄËà¨ÈÉΩÁî®‰∏çÂà∞Â§çÁî®ÔºåËøôÊó∂ÂÄôÂ∞±ÂèØ‰ª•‰ΩøÁî® LayoutParams ÂíåË∞ÉÁî®ÂØπÂ∫îÊñπÊ≥ïÊù•‰ª£ÊõøÔºö
>
> ```kotlin
> val frameLayout = FrameLayout(this)
> // Android Á¨¨‰∏ÄËäÇËØæÊàë‰ª¨ËÆ≤ËøáÔºåÁà∂Â∏ÉÂ±ÄÂèØ‰ª•ÁªôÂ≠êÂ∏ÉÂ±ÄËÆæÁΩÆÂ±ûÊÄß
> // ‰∏îÂ±ûÊÄßÈÉΩ‰ª• layout_ ÂºÄÂ§¥ÔºåÊâÄ‰ª• layout_width Âíå layout_height 
> // ÂØπÂ∫îÁî± LayoutParams Êù•ËÆæÁΩÆ
> frameLayout.layoutParams = ViewGroup.LayoutParams(
>  ViewGroup.LayoutParams.MATCH_PARENT,
>  ViewGroup.LayoutParams.MATCH_PARENT
> )
> // background Â±û‰∫é View Ëá™Ë∫´Â±ûÊÄßÔºåÊâÄ‰ª•ÂØπÂ∫î View Ëá™Ë∫´ÊñπÊ≥ï
> frameLayout.setBackgroundColor(Color.BLACK)
> 
> // ‰ΩÜËøôÊ†∑ÂÜôÊúâ‰∏Ä‰∏™Áº∫ÁÇπÂ∞±ÊòØÔºöLayoutParams Ëøô‰∏úË•øÂè™ËÉΩËÆæÁΩÆÂ∞ëÈáèÁöÑÂ±ûÊÄßÔºå
> // ËÄå‰∏î LayoutParams ÊúâÂæàÂ§ö‰∏™ÔºåÂÖ∑‰ΩìÈÄâÊã©ÈÇ£‰∏™ÈúÄË¶ÅÁúã‰Ω†ÁöÑ View Ë¢´Ê∑ªÂä†Âà∞
> // Âì™ÁßçÁà∂Â∏ÉÂ±ÄÈáåÔºåÂ¶ÇÊûúÊòØ LinearLayoutÔºåÂ∞±ÊòØ LinearLayout.LayoutParams(...)
> ```
>
> ÂèØËÉΩÊúâ‰∫∫‰∏çÁü•ÈÅì LayoutParams ÊòØ‰ªÄ‰πà‰∏úË•øÔºå‰Ω†ÊöÇÊó∂ÂèØ‰ª•ÊääÂÆÉÁúãÊàêÊòØÁî®Êù•‰øùÂ≠ò View ‰∏≠ÊúâÂÖ≥**Áà∂Â∏ÉÂ±ÄÂ±ûÊÄß**ÁöÑ‰∏Ä‰∏™Êï∞ÊçÆÁ±ªÔºå‰æõÁà∂Â∏ÉÂ±Ä‰ΩøÁî®ÔºåÂêéÈù¢‰ºöÂÜçÊ¨°ËÆ≤Ëß£
>
> Èô§‰∫Ü‰∏äÈù¢ËøôÁßçÂä®ÊÄÅÁîüÊàêÊó∂‰º†ÂÖ•ÈªòËÆ§Â±ûÊÄßÔºå‰Ω†‰πüÂèØ‰ª•Âú®ÊûÑÈÄ†Âô®‰∏≠ËÆæÁΩÆ‰Ω†ÁöÑËá™ÂÆö‰πâ View ÁöÑÈªòËÆ§Â±ûÊÄßÔºö
>
> ‰∏ÄËà¨ÊòØËøôÊ†∑ÂÆö‰πâÊûÑÈÄ†Âô®ÁöÑÔºö
>
> ```kotlin
> // Áî±‰∫é java ÊòØÂü∫Á°ÄÔºåÊàëÂÖàÁî® java Êù•ÂÆö‰πâÊûÑÈÄ†Âô®ÔºåÂêéÈù¢ÂÜç‰ΩøÁî® kt Êù•‰ºòÂåñÂÜôÊ≥ï
> public class Section3View extends View {
>  public Section3View(Context context) {
>      // Ê≥®ÊÑèËøôÈáåË∞ÉÁî®ÁöÑÊòØ thisÔºåËÄå‰∏çÊòØ super
>      this(context, null);
>  }
> 
>  public Section3View(
>      Context context, 
>      @Nullable AttributeSet attrs
>  ) {
>      // Ê≥®ÊÑèËøôÈáåË∞ÉÁî®ÁöÑÊòØ thisÔºåËÄå‰∏çÊòØ super
>      this(context, attrs, R.attr.mySection3View_attrs);
>  }
> 
>  public Section3View(
>      Context context, 
>      @Nullable AttributeSet attrs, 
>      int defStyleAttr
>  ) {
>      // Ê≥®ÊÑèËøôÈáåË∞ÉÁî®ÁöÑÊòØ thisÔºåËÄå‰∏çÊòØ super
>      // ËøôÈáåÂ∞±ÊòØËÆæÁΩÆÈªòËÆ§Â±ûÊÄß
>      this(
>          context, 
>          attrs, 
>          defStyleAttr, 
>          R.style.mySection3View_defaultAttrs
>      );
>  }
> 
>  public Section3View(
>      Context context, 
>      @Nullable AttributeSet attrs, 
>      int defStyleAttr, 
>      int defStyleRes
>  ) {
>      // Áõ¥Âà∞ËøôÈáåÊâçË∞ÉÁî® super
>      super(context, attrs, defStyleAttr, defStyleRes);
>  }
> }
> ```
>
> ÂÖ∂‰∏≠ `R.attr.mySection3View_attrs`Ôºö
>
> ```xml
> <!--value/attrs.xml-->
> <resources>
>  <attr name="mySection3View_attrs" format="reference"/>
> </resources>
> ```
>
> ÂÖ∂‰∏≠ `R.style.mySection3View_defaultAttrs`Ôºö
>
> ```xml
> <!--value/style.xml-->
> <style name="mySection3View_defaultAttrs">
>  <item name="android:background">@android:color/black</item>
> </style>
> ```
>
> Â¶ÇÊûú‰Ω†ÂéªÂØπÁÖßÂÆòÊñπÊéß‰ª∂ÁöÑÂÜôÊ≥ïÔºå‰Ω†‰ºöÂèëÁé∞‰ªñ‰ª¨ÁöÑÊûÑÈÄ†ÂáΩÊï∞‰πüÊòØËøôÊ†∑ÂÜôÁöÑÔºåÂâç‰∏â‰∏™ÈÉΩÊòØË∞ÉÁî® `this()`ÔºåÂè™ÊúâÊúÄÂêé‰∏Ä‰∏™Ë∞ÉÁî®   `super()`Ôºå‰ΩÜ‰ªñ‰ª¨‰∏ÄËà¨Âè™ËÆæÁΩÆ‰∫Ü `R.attr.mySection3View_attrs`ÔºåÁî®‰∫éÂºÄÂèëËÄÖÂú® theme ‰∏≠ÂÆö‰πâÂÖ®Â±ÄÂ±ûÊÄßÔºà[Á¨¨‰∏âÁÇπ](#3„ÄÅÂú® theme ‰∏≠ËÆæÁΩÆÊüêÁßçÊéß‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß)ÔºâÔºåËÄå `R.style.mySection3View_defaultAttrs` Âú®ÂÆòÁΩëÊéß‰ª∂‰∏≠‰∏ÄËà¨Ê≤°ËÆæÁΩÆÔºåÈÉΩÊòØÂÜô‰∏™ 0Ôºå‰ª£Ë°®Ê≤°ÂæóÈªòËÆ§Â±ûÊÄß
>
> > ‰∏∫‰ªÄ‰πàÊúâ‰∏§‰∏™ÈªòËÆ§Â±ûÊÄßÔºü
> >
> > ```java
> > public View(
> > Context context, 
> > @Nullable AttributeSet attrs, 
> > int defStyleAttr, 
> > int defStyleRes
> > )
> > ```
> >
> > ‰Ω†‰ºöÂèëÁé∞Á¨¨‰∏â‰∏™ÂèÇÊï∞ `defStyleAttr` ÂíåÁ¨¨Âõõ‰∏™ `defStyleRes` ÈÉΩÊòØËÆæÁΩÆÈªòËÆ§ÂèÇÊï∞Ôºå‰ΩÜ‰∏∫‰ªÄ‰πàË¶ÅÂêåÊó∂Â≠òÂú®‰∏§‰∏™Âë¢Ôºü
> >
> > ÂéüÂõ†Ôºö`defStyleAttr` ÊòØ‰ªé theme ‰∏≠ËØªÂèñÈªòËÆ§ÂÄºÔºå‰ΩÜÂ¶ÇÊûúÊàë‰ª¨Âè™ËÉΩÂä®ÊÄÅÁîüÊàê ViewÔºåÂèàÈúÄË¶ÅÂ§öÊ¨°Áî®Âà∞‰∏Ä‰∫õÂ±ûÊÄßÔºåÂú® Android 5.0 ‰πãÂâçË¶Å‰πàÊØèÊ¨°ÈÉΩÊâãÂä®Ë∞ÉÁî®ÊñπÊ≥ïÊù•ËÆæÁΩÆÔºåË¶Å‰πàÂÜôÂú® theme ‰∏≠Ôºå‰ΩÜËøôÊ†∑Êú™ÂÖçÈ∫ªÁÉ¶‰∫Ü‰∫õÔºåÂú® Android 5.0 ÂêéÂ¢ûÂä†‰∫ÜËøô‰∏™ `defStyleRes` ÂèÇÊï∞ÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•ÊääÂ±ûÊÄßÂÜôÂú® `style.xml` ‰∏≠ÔºåÊñπ‰æøÂ§çÁî®
> >
> > **‰ΩÜËøôÈáåÊúâÂæàÈáçË¶ÅÁöÑ‰∏ÄÁÇπÔºö**‰ΩøÁî® `defStyleRes` Êó∂‰∏çËÉΩËÆæÁΩÆ `defStyleAttr`ÔºåÁªô `defStyleAttr` Â°´ÂÖ• 0 ÊàñËÄÖ theme ‰∏≠‰∏çËÆæÁΩÆÂØπÂ∫îÁöÑÂ±ûÊÄßÂç≥ÂèØ
>
> ÂõûÂà∞ËøôÈáåÔºåÂâçÈù¢ java ÁöÑÂÜôÊ≥ïÁ°ÆÂÆûÊÑüËßâÊúâ‰∫õËáÉËÇø‰∫ÜÔºåÊàë‰ª¨Êù•ÁúãÁúã kt ÁöÑÂÜôÊ≥ïÔºö
>
> ```kotlin
> // ÂøÖÈ°ªÊ∑ªÂä† @JvmOverloadsÔºå‰∏çÁÑ∂ java Â±ÇÊó†Ê≥ï‰ΩøÁî®ËØ•ÊûÑÈÄ†Âô®
> // ‰ºöÂØºËá¥ xml ‰∏≠ÁöÑ View Êó†Ê≥ïÁîüÊàê
> class Section3ViewKt @JvmOverloads constructor(
>     context: Context,
>     attrs: AttributeSet? = null,
>     defStyleAttr: Int = R.attr.mySection3View_attrs,
>     defStyleRes: Int = R.style.mySection3View_defaultAttrs
> ) : View(context, attrs, defStyleAttr, defStyleRes) {
> }
> // Â¶ÇÊûú‰Ω†Ê≤°Âæó R.attr.mySection3View Êàñ R.style.MySection3View_defaultAttrs
> // ÂèØ‰ª•Áõ¥Êé•ËµãÂÄº‰∏∫ 0ÔºåÂ∞±ÊòØÊ≤°ÂæóÈªòËÆ§Â±ûÊÄßËÆæÁΩÆ
> ```
>
> **ËÆ≤Âà∞ËøôÈáåÔºåÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÁöÑÂõõ‰∏™ÂèÇÊï∞ÂêÑ‰ΩçÂ∫îËØ•Áü•ÈÅìÊúâ‰ªÄ‰πà‰ΩúÁî®‰∫ÜÔºåËøôÈáåÊàë‰ª¨ÊÄªÁªì‰∏Ä‰∏ãÔºö**
>
> ```java
> public View(Context context)
> // Áî®‰∫éÂú®‰ª£Á†Å‰∏≠Âä®ÊÄÅÁîüÊàêËá™ÂÆö‰πâ View
> ```
>
> ```java
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs
> )
> // Áî®‰∫éÂÜôÂú® xml ÈáåÈù¢Á≥ªÁªüË∞ÉÁî®
> ```
>
> ```java
> public View(
>     Context context,
>     @Nullable AttributeSet attrs, 
>     int defStyleAttr
> )
> // Áî®‰∫éËÆæÁΩÆÂÖ®Â±ÄÈªòËÆ§Â±ûÊÄßÂÄºÔºåÈÄöÂ∏∏ÊòØÈÄöËøá‰∏äÈù¢‰∏§‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞Êù•Èó¥Êé•Ë∞ÉÁî®
> ```
>
> ```java
> public View(
>     Context context, 
>     @Nullable AttributeSet attrs, 
>     int defStyleAttr, 
>     int defStyleRes
> )
> // ‰πüÊòØÁî®‰∫éËÆæÁΩÆÈªòËÆ§Â±ûÊÄßÂÄºÔºåÂè™ÊòØ‰∏çÁî®ÂÜôÂú® theme ‰∏≠ÔºåÈÄöÂ∏∏Áî®‰∫éÂä®ÊÄÅÁîüÊàê‰ª£Á†Å‰∏≠ÊàñËá™Â∑±Ëá™ÂÆö‰πâ View ÁöÑÊó∂ÂÄô
> ```
>
> ÂâçÈù¢ËÆ≤‰∫Ü 4 ÁßçÊñπÂºèÊù•ËÆæÁΩÆÂ±ûÊÄßÔºåËøòÊúâ‰∏ÄÁßçÊñπÂºè‰πüÂèØ‰ª•Êù•ËÆæÁΩÆÂ±ûÊÄß
>

#### 5„ÄÅÁõ¥Êé•Âú® theme ‰∏≠ÂÆö‰πâÂ±ûÊÄß

> Ëøô‰∏™‰∏éÁ¨¨‰∏âÁÇπÔºö[Âú® theme ‰∏≠ËÆæÁΩÆÊüêÁßçÊéß‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß](#3„ÄÅÂú® theme ‰∏≠ËÆæÁΩÆÊüêÁßçÊéß‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß) Êúâ‰∫õÁ±ª‰ººÔºå‰ΩÜÂÆÉÂÄºÂÖÅËÆ∏Áõ¥Êé•ÂÜôÂú® theme ‰∏≠
>
> ```xml
> <resources xmlns:tools="http://schemas.android.com/tools">
>     <style name="Theme.CustomViewWithAnimStudy" parent="Theme.MaterialComponents.DayNight.DarkActionBar">
>         <!--Â¶ÇÊûú‰Ω†Âä†‰∫ÜËøôË°å‰ª£Á†ÅÔºå‰Ω†‰ºöÂèëÁé∞Â∫îÁî®Â§ßÈÉ®ÂàÜÊéß‰ª∂ÂèòÊàêÈªëËâ≤‰∫Ü-->
>         <item name="android:background">@android:color/black</item>
>     </style>
> </resources>
> ```
>
> **‰ΩÜÊòØÔºå**Ëøô‰∏™ÊòØ‰∏çÂàÜÊéß‰ª∂ÁöÑÁªôÂÖ®ÈÉ® View ËÆæÁΩÆÂ±ûÊÄßÔºå‰∏ÄËà¨‰∏ç‰ºö‰ΩøÁî®Âà∞ÂÆÉÔºåÂè™ÊúâËÆæÁΩÆÊï¥‰∏™Â∫îÁî®ÁöÑ‰∏ªÈ¢òÊó∂‰ºöÁî®Âà∞
>
> ÊØîÂ¶Ç‰Ω†ÂèØ‰ª•ËØïËØïÊääËøôÂá†‰∏™Â±ûÊÄßÊîπ‰∏Ä‰∏ãÔºåÂ∞±‰ºöÂèëÁé∞Â∫îÁî®ÁöÑÊ†áÈ¢òÊ†èÈ¢úËâ≤‰ªéÁ¥´Ëâ≤ÊîπÊàê‰∫Ü‰Ω†ËÆæÁΩÆÁöÑÈ¢úËâ≤
>
> ```xml
> <item name="colorPrimary">@color/purple_500</item>
> <item name="colorPrimaryVariant">@color/purple_700</item>
> <item name="colorOnPrimary">@color/white</item>
> <item name="colorSecondary">@color/teal_200</item>
> <item name="colorSecondaryVariant">@color/teal_700</item>
> <item name="colorOnSecondary">@color/black</item>
> ```
>
> Ëøô‰∫õÂ±ûÊÄßÂØπÂ∫î‰∫ÜÊüêÁßçÂÖ∑‰Ωì‰ΩçÁΩÆÁöÑÈ¢úËâ≤ÔºåÂèØ‰ª•ÁúãÁúãËøôÁØáÂçöÂÆ¢Ôºöhttps://blog.csdn.net/smartzzg/article/details/104788412
>
> ### ‰∫îÁßçÂ±ûÊÄßÂÆö‰πâÊñπÊ≥ïÁöÑÈ°∫Â∫è
>
> > Êàë‰ª¨ËÆ≤‰∫ÜÊúâ 5 Áßç‰∏çÂêåÁöÑÂ±ûÊÄßÂÆö‰πâÔºåÂ¶ÇÊûúÂÆö‰πâ‰∫ÜÁõ∏ÂêåÂ±ûÊÄßÔºå‰ªñ‰ª¨Â≠òÂú®‰∏Ä‰∏™‰ºòÂÖàÁ∫ßÈ°∫Â∫èÔºö
> >
> > [1„ÄÅÁõ¥Êé•ÂÜôÂú® XML ‰∏≠](#1„ÄÅÁõ¥Êé•ÂÜôÂú® XML ‰∏≠)
> >
> > [2„ÄÅ‰ΩøÁî® @style ËÆæÁΩÆÂ±ûÊÄß](#2„ÄÅ‰ΩøÁî® @style ËÆæÁΩÆÂ±ûÊÄß)
> >
> > [3„ÄÅÂú® theme ‰∏≠ËÆæÁΩÆÊüêÁßçÊéß‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß](#3„ÄÅÂú® theme ‰∏≠ËÆæÁΩÆÊüêÁßçÊéß‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß)
> >
> > [4„ÄÅË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞ÁöÑ defStyleRes](#4„ÄÅË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞ÁöÑ defStyleRes)
> >
> > [5„ÄÅÁõ¥Êé•Âú® theme ‰∏≠ÂÆö‰πâÂ±ûÊÄß](#5„ÄÅÁõ¥Êé•Âú® theme ‰∏≠ÂÆö‰πâÂ±ûÊÄß)
> >
> > ËøôÈáåÊ≥®ÊÑèÔºö‰ΩøÁî® `defStyleRes ` Êó∂‰∏çËÉΩËÆæÁΩÆ `defStyleAttr`ÔºåÁªô `defStyleAttr` Â°´ÂÖ• 0 ÊàñËÄÖ theme ‰∏≠‰∏çËÆæÁΩÆÂØπÂ∫îÁöÑÂ±ûÊÄßÂç≥ÂèØ
>
> **Âà∞ËøôÈáå View ÁöÑÂõõ‰∏™ÊûÑÈÄ†ÂáΩÊï∞Âü∫Êú¨ÂàÜÊûêÂÆåÊØï‰∫ÜÔºåÊé•‰∏ãÊù•Êàë‰ª¨ÂºÄÂßãËÆ≤Ëß£ÈáåÈù¢ÁöÑÊñπÊ≥ï**

### 4„ÄÅonDraw()

> ### ‰ΩúÁî®
>
> ÂØπ View ËøõË°åÁªòÂà∂
>
> ### Ê∂âÂèäÂÜÖÂÆπ
>
> - [Canvas ÁîªÂ∏É](#1„ÄÅCanvas ÁîªÂ∏É)
> - [Paint ÁîªÁ¨î](#2„ÄÅPaint ÁîªÁ¨î)
> - [Path Ë∑ØÂæÑ](#3„ÄÅPath Ë∑ØÂæÑ)
>
> ```kotlin
> // ËØ•ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÂõûË∞ÉÔºå‰∏∫‰ªÄ‰πàÊòØÂõûË∞ÉÔºåÂú®‰πãÂêéÁöÑ invalidate() ‰ºöËøõË°åËÆ≤Ëß£
> override fun onDraw(canvas: Canvas?) {
> super.onDraw(canvas)
> }
> ```
>
> > ËøôÈáåËÆ≤‰∏Ä‰∏™Â∞èÊäÄÂ∑ßÔºöÂèØ‰ª•Êää `Canvas?` ‰∏≠ÁöÑ `?` ‰∏∫ÂéªÊéâ
> >
> > Âõ†‰∏∫Âú® kt ÈáçÂÜô `onDraw()` ÊñπÊ≥ïÊó∂ÔºåÊ∫ê‰ª£Á†Å java Â±Ç‰∏≠Âπ∂Ê≤°ÊúâÁªôÂèÇÊï∞ `canvas` Âä†‰∏ä `@NonNull`ÔºåÂØºËá¥ kt ‰∏çÁü•ÈÅìÂÆÉ‰ºö‰∏ç‰ºö‰∏∫Á©∫Ôºå‰ΩÜÊàë‰ª¨‰Ωú‰∏∫ÂºÄÂèëËÄÖËÇØÂÆöÊòØÁü•ÈÅìÂÆÉ‰∏ç‰ºö‰∏∫Á©∫ÁöÑÔºåÊâÄ‰ª•ÂéªÊéâ `?`ÔºåÂèØ‰ª•ÂáèÂ∞ëÂêéÁª≠ÁöÑÂà§Êñ≠Ôºå‰∏çÁÑ∂ÂæàÂèØËÉΩÂÜôÂá∫ËøôÊ†∑ÁöÑ‰ª£Á†Å
> >
> > ```kotlin
> > override fun onDraw(canvas: Canvas?) {
> >     super.onDraw(canvas)
> >     canvas?.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> >     canvas?.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> >     canvas?.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> >     canvas?.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> >     canvas?.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> >     canvas?.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> > }
> > ```
> >
> > ÁúãÁùÄÂ•ΩÂÉèÊ≤°Âæó‰ªÄ‰πàÈóÆÈ¢òÔºå‰∏çÂ∞±Â§öÊâì‰∫Ü‰∏Ä‰∏™ `?` ÂêóÔºü
> >
> > Á°ÆÂÆûÁúãÁùÄÊ≤°Êúâ‰ªÄ‰πàÈóÆÈ¢òÔºå‰ΩÜ‰Ω†Êää kt ËΩ¨Êàê javaÔºå‰Ω†Â∞±‰ºöÂèëÁé∞Ôºö
> >
> > ```java
> > protected void onDraw(@Nullable Canvas canvas) {
> >    super.onDraw(canvas);
> >    if (canvas != null) {
> >       canvas.drawRect(0.0F, 0.0F, 100.0F, 200.0F, this.mBlackPaint);
> >    }
> >    if (canvas != null) {
> >       canvas.drawRect(0.0F, 0.0F, 100.0F, 200.0F, this.mBlackPaint);
> >    }
> >    if (canvas != null) {
> >       canvas.drawRect(0.0F, 0.0F, 100.0F, 200.0F, this.mBlackPaint);
> >    }
> >    if (canvas != null) {
> >       canvas.drawRect(0.0F, 0.0F, 100.0F, 200.0F, this.mBlackPaint);
> >    }
> >    if (canvas != null) {
> >       canvas.drawRect(0.0F, 0.0F, 100.0F, 200.0F, this.mBlackPaint);
> >    }
> >    if (canvas != null) {
> >       canvas.drawRect(0.0F, 0.0F, 100.0F, 200.0F, this.mBlackPaint);
> >    }
> > }
> > ```
> >
> > ÊØè‰∏™ canvas ÈÉΩÂçïÁã¨Âà§Êñ≠‰∫Ü‰∏ÄÈÅçÊòØÂê¶‰∏∫Á©∫Ôºå‰∏çÁü•ÈÅì‰Ω†‰ª¨ÊÄé‰πàÊÉ≥Ôºå‰ΩÜÊàëÁöÑÂº∫Ëø´Áóá‰∏çÂÖÅËÆ∏Âá∫Áé∞ËøôÁßçÊÉÖÂÜµÔºåÊâÄ‰ª•Âª∫ËÆÆÂêÑ‰ΩçÂÜôËá™ÂÆö‰πâ View Êó∂ÔºåÊääÊñπÊ≥ïÂèÇÊï∞‰∏≠ÂèØ‰ª•ÂéªÊéâ `?` ÁöÑÈ°∫ÊâãÁªôÂéªÊéâ
> >
> > Èô§‰∫Ü `onDraw()` ‰ª•Â§ñÔºåËøòÊúâ `override fun onTouchEvent(event: MotionEvent?)` ÁöÑ `?` ‰πüÂèØ‰ª•ÂéªÊéâ
> >
> > > ÊÄé‰πàÁúã kt ËΩ¨ÊàêÁöÑ java ‰ª£Á†ÅÔºü
> > >
> > >  <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320161207313.png" alt="image-20220320161207313" style="zoom:50%;" />
> > >
> > >  <img src="C:/Users/%E9%83%AD%E7%A5%A5%E7%91%9E/AppData/Roaming/Typora/typora-user-images/image-20220320144121673.png" alt="image-20220320144121673" style="zoom:50%;" />
> >
> > Êé•‰∏ãÊù•Êàë‰ª¨ÂºÄÂßãËÆ≤Ëß£ `onDraw()` ÈúÄË¶ÅÁöÑÂÖ∂‰ªñÁü•ËØÜ
>

#### 1„ÄÅCanvas ÁîªÂ∏É

> Áî±‰∫éÊó∂Èó¥ÂéüÂõ†ÔºåËøôÈáå‰∏ç‰ºöËÆ≤ÂæóÂæàËØ¶ÁªÜÔºå‰Ω†‰ª¨ÂèØ‰ª•Âú®Ëøô‰∫õÂú∞ÊñπËøõË°åÂ≠¶‰π†Ôºö
>
> - https://carsonho.blog.csdn.net/article/details/60598775
> - https://qijian.blog.csdn.net/article/details/50995268
>
>
> | ÂèÇÊï∞         | Á±ªÂûã   | ‰ΩúÁî®                                                         |
> | ------------ | ------ | ------------------------------------------------------------ |
> | ***canvas*** | Canvas | Â≠óÈù¢ÁøªËØëÊòØ‚ÄúÂ∏ÜÂ∏É‚ÄùÔºå‰Ω†ÂèØ‰ª•ÁúãÊàêÊòØÁ≥ªÁªüÂ∫ïÂ±ÇÁªô‰∫Ü‰Ω†‰∏ÄÂº†‚ÄúÁîªÂ∏É‚ÄùÔºàcanvasÔºâÔºåÁÑ∂Âêé‰Ω†Âú®ËøôÂº†ÁîªÂ∏É‰∏äËøõË°åÁªòÂõæ |
>
> ÈÇ£ÊÄé‰πàËøõË°åÁîªÂõæÂë¢Ôºü
>
> ```kotlin
> // Ëøô‰∏™ paint ‰Ω†ÂèØ‰ª•ÊääÂÆÉÁúãÊàêÊòØ‚ÄúÁîªÁ¨î‚Äù
> private val mBlackPaint = Paint().apply {
> color = Color.BLACK // ËÆæÁΩÆÁîªÁ¨îÈ¢úËâ≤‰∏∫ÈªëËâ≤
> }
> override fun onDraw(canvas: Canvas) {
> super.onDraw(canvas)
> // Áîª‰∏Ä‰∏™ (0, 0) - (100, 200) ÁöÑÈªëËâ≤Áü©ÂΩ¢
> canvas.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
> }
> ```
>
> Â¶Ç‰∏äÈù¢‰ª£Á†ÅÔºåË∞ÉÁî® `canvas.drawRect()` Â∞±ÂèØ‰ª•Áîª‰∏Ä‰∏™ÈªëËâ≤Áü©ÂΩ¢Âú® View ÈáåÈù¢
>
> Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Áúã‰∏Ä‰∏ãÊïàÊûúÔºö
>
> <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320144833039.png" alt="image-20220320144833039" style="zoom:50%;float:left" />
>
> Â¶ÇÊûú‰Ω†Ê≤°ÊúâËá™ÂÆö‰πâ View Âü∫Á°ÄÁöÑËØùÔºåÂèØËÉΩ‰ºöËßâÂæóÊúâ‰∫õÂ•áÊÄ™
>
> Êàë‰ª¨‰ªéÂ∞èÂ≠¶ÂºÄÂßãÂ≠¶ÁöÑÂùêÊ†áÁ≥ªÁ¨¨‰∏ÄË±°Èôê‰∏çÊòØÂêë‰∏ä‰∏∫ Y Ê≠£ÂçäËΩ¥ÔºåÂêëÂè≥‰∏∫ X Ê≠£ÂçäËΩ¥ÔºåÈÇ£‰πàÊåâÁÖßÊÉØÊÄßÊÄùÁª¥Ôºå(0, 0) - (100, 200) ‰∏∫‰ªÄ‰πà‰∏çÊòØ‰∏ãÂõæËøôÊ†∑ÁöÑÔºü
>
> <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320144833039.png" alt="image-20220320144833039" style="zoom:50%;transform:rotateX(180deg);float:left" />
>
> ÂÖ∂ÂÆûÂéüÂõ†Âú®‰∫é View ‰∏≠ÂùêÊ†áÁ≥ªÁöÑ y ËΩ¥ÊòØÂèçËøáÊù•ÁöÑÔºåÊàëÁåúÊµãÊòØÂõ†‰∏∫Ôºö‰∏∫‰∫ÜËÆæÈÖçÊâãÊú∫ÁöÑÁâπÁÇπÔºåÊØîÂ¶ÇÊàë‰ª¨Áúã‰∏Ä‰∫õÂàóË°®ÔºåÈÉΩÊòØÊâãÊåáÂæÄ‰∏äÊªëÂä®ÔºåÊü•Áúã‰∏ãÈù¢ÁöÑÂÜÖÂÆπÔºåÊâÄ‰ª•‰∏∫‰∫ÜÂ•ΩÂºÄÂèëÔºåView ‰∏≠ÁöÑÂùêÊ†áÂéüÁÇπÂ∞±ËÆæÁΩÆÂú®‰∫ÜÂ∑¶‰∏äËßíÔºåÂêë‰∏ã‰∏∫ Y Ê≠£ÂçäËΩ¥ÔºåÂêëÂè≥‰∏∫ X Ê≠£ÂçäËΩ¥
>
> Ëøô‰∏™ÁÆóÊòØÂü∫Á°ÄÂÜÖÂÆπ‰∫ÜÔºåÂ¶ÇÊûú‰∏çÁü•ÈÅìÁöÑËØùÔºåÂèØ‰ª•ÂéªÁúãÁúãËøôÁØáÊñáÁ´†Ôºöhttps://blog.csdn.net/carson_ho/article/details/56009827
>
> Canvas ÈáåÈù¢‰∏çÊ≠¢ÊúâÁªòÂà∂Áü©ÂΩ¢ÁöÑÊñπÊ≥ïÔºåËøòÊúâÁªòÂà∂ÂúÜÁöÑÊñπÊ≥ïÔºåÁªòÂà∂ÊñáÂ≠óÁöÑÊñπÊ≥ï¬∑¬∑¬∑¬∑¬∑¬∑ÔºåËøôÈáå‰∏ç‰ºöÂéªËÆ≤Ëß£Ëøô‰∫õÂü∫Á°ÄÂÜÖÂÆπÔºåÂèØ‰ª•Âéª‰∏ãÈù¢Ëøô‰∫õÂú∞ÊñπÂéªÊü•ÁúãÔºö
>
> - https://developer.android.google.cn/reference/kotlin/androidx/compose/ui/graphics/Canvas?hl=en

#### 2„ÄÅPaint ÁîªÁ¨î

> ÂâçÈù¢ÁöÑ‰ª£Á†ÅÊºîÁ§∫‰∏≠Âá∫Áé∞‰∫Ü `Paint`ÔºåËøô‰∏™Á±ª‰∏ªË¶ÅÊòØÁÆ°ÁîªÁ¨îÁöÑÔºåÈô§‰∫ÜËÆæÁΩÆÈ¢úËâ≤‰ª•Â§ñÔºå‰ªñËøòÂèØ‰ª•ËÆæÁΩÆÁ∫øÁöÑÁ≤óÁªÜÁ≠â
>
> ```kotlin
> // ËøôÊòØÊàëÁöÑÊüê‰∏™Ëá™ÂÆö‰πâ View ËÆæÁΩÆÁöÑ Paint
> private val mCircleBackgroundPaint by lazyUnlock {
>     Paint().apply {
>         color = mCircleBackground
>         style = Paint.Style.FILL
>         isAntiAlias = true
>     }
> }
> ```
>
> Paint ÁöÑÊñπÊ≥ïÊúâÂæàÂ§öÔºåËøôÈáåÁªôÂá∫ÊñáÁ´†Ôºå‰Ω†‰ª¨ÊúâÊó∂Èó¥ÂèØ‰ª•ÂéªÁúãÁúãÔºåÈÇ£Êú¨Ëá™ÂÆö‰πâÈªë‰π¶ÂØπ‰∫é Paint ÁöÑÂÜÖÂÆπÊúâÁÇπÂ∞ëÔºåÂª∫ËÆÆÂéªÁúã‰π¶‰ΩúËÄÖÂÜôÁöÑÊñáÁ´†ÔºåÈáåÈù¢ÊúâÂæàÂ§öÂÖ∂‰ªñÈ´òÁ∫ßÁî®Ê≥ï
>
> - https://qijian.blog.csdn.net/article/details/50995268

#### 3„ÄÅPath Ë∑ØÂæÑ

> Path Ë°®Á§∫Ë∑ØÂæÑÔºåÂ∏∏Áî®‰∫éÁªòÂà∂Êõ≤Á∫øÔºåÁªòÂà∂‰∏çËßÑÂàôÁöÑÂõæÂΩ¢Á≠â
>
> ```kotlin
> // ËøôÊòØÊàëÁöÑÊüê‰∏™Ëá™ÂÆö‰πâ View ËÆæÁΩÆÁöÑ Path
> // ‰∏ªË¶ÅÊòØÂÜô‰∫ÜÊ†πÊçÆÂèòÂåñÁöÑ offset ÂÄºÊù•ËÆ°ÁÆóÂúÜÁöÑÂçäÂæÑÔºåÊúÄÂêéÁªòÂà∂‰∏Ä‰∏™ÂúÜ
> private fun drawFirstCircle(path: Path, offset: Float, total: Float) {
>     val radio = abs(offset / total)
>     val startMove = 0.6F
>     val k = 1 / (1 - startMove)
>     val b = 1 - k
>     val y = offset / abs(offset) * max(0F, k * radio + b) * total
>     val r = getNewRadius(y)
>     val dx = (outerX - abs(y)) / (outerR + r) * r
>     val dy = outerY / (outerR + r) * r
>     firstPointX = if (offset > 0) dx + y else -dx + y
>     firstPointY = dy
>     path.addCircle(y, 0F, r, Path.Direction.CCW)
> }
> ```
>
> ÊñπÊ≥ïÊúâÂæàÂ§öÔºåËøôÈáå‰∏çËøõË°åËÆ≤Ëß£ÔºåÁªôÂá∫‰∏ãÈù¢ÊñáÁ´†Ôºö
>
> - https://developer.android.google.cn/reference/kotlin/androidx/compose/ui/graphics/Path?hl=en
> - https://carsonho.blog.csdn.net/article/details/60597923
> - https://qijian.blog.csdn.net/article/details/50995268

#### 4„ÄÅÂÖ∂‰ªñ‰∏úË•ø

> ‰∏äÈù¢Âπ∂Ê≤°ÊúâÂàóÂÆåÂü∫Á°ÄÁü•ËØÜÔºåÂõ†‰∏∫Âü∫Á°ÄÁü•ËØÜÂÆûÂú®ÊòØÂ§™Â§ö‰∫ÜÔºåËøôÈáåÊòØÂÜô‰∏ç‰∏ãÁöÑÔºåÊé•‰∏ãÊù•ÊàëËÆ≤‰∏Ä‰∫õÂÖ∂‰ªñÁªèÈ™åÊÄßÁöÑ‰∏úË•ø

##### 1„ÄÅonDraw() ÈáåÈù¢Á¶ÅÊ≠¢ new ÂØπË±°

> ÂæàÂ§öÂàùÂ≠¶ËÄÖÂú®ÂàöÂºÄÂßãÂÜôÁöÑÊó∂ÂÄôÂæàÂñúÊ¨¢Âú® `onDraw()` ÈáåÈù¢ new ÂØπË±°Ôºå‰πãÂâç `canvas.drawRect()` ‰∏çÊòØË¶Å‰º†ÂÖ•‰∏Ä‰∏™ÁîªÁ¨îÂêóÔºüÂ∞±‰ºöÊúâ‰∫∫ËøôÊ†∑ÂÜô
>
> ```kotlin
> override fun onDraw(canvas: Canvas) {
>  super.onDraw(canvas)
>  val blackPaint = Paint()
>  blackPaint.color = Color.BLACK
>  canvas.drawRect(0F, 0F, 100F, 200F, blackPaint)
> }
> ```
>
> ËøôÊ†∑ÂÜôÊó∂ AS Ëøò‰ºöÊä•‰∏Ä‰∏™ÈªÑÔºåÂëäËØâ‰Ω†ËøôÊ†∑ÂÜôÊòØ‰∏çÂØπÁöÑÔºå‰ΩÜ‰Ω†Áü•ÈÅì‰∏∫‰ªÄ‰πà‰∏çÂØπÂêóÔºü
>
> ÂéüÂõ†Ôºö`onDraw()` Âú®‰∏ÄÁõ¥Âà∑Êñ∞ËßÜÂõæÊó∂ÔºåÂú® 60 Â∏ßÁöÑÊâãÊú∫‰∏ä‰ºöÊØèÈöî 16 ÊØ´ÁßíÂõûË∞É‰∏ÄÊ¨°Ôºå90 Â∏ßÁöÑÊâãÊú∫‰∏äÊØèÈöî 11 ÊØ´ÁßíÂõûË∞É‰∏ÄÊ¨°Ôºà1000 √∑ 90ÔºâÔºåÊâÄ‰ª•Âú®‰∏ÄÁßíÈíüÔºå60 Â∏ßÁöÑÊâãÊú∫‰ºöÁîüÊàê 60 ‰∏™ Paint ÂØπË±°Ôºå90 Â∏ßÊâãÊú∫ÁîüÊàê 90 ‰∏™ÂØπË±°ÔºåËøôÊ†∑ÁñØÁãÇ new ÂØπË±°Ôºå‰ºöËÆ©ÊâãÊú∫Âá∫Áé∞Âç°È°øÔºåËøôË∑ü‰∏äËäÇËØæËÆ≤ÁöÑ `onBindViewHolder()` ‰∏çË¶ÅÂÜôÁÇπÂáªÁõëÂê¨‰∏ÄÊ†∑Ôºå‰ΩÜËøô‰∏™‰ºöÊØîÂÆÉÊõ¥‰∏•Èáç
>
> ‰ΩÜ AS ÁöÑÊô∫ËÉΩÊèêÁ§∫Âπ∂‰∏çÊòØËÉΩÂèëÁé∞ÊâÄÊúâÁöÑÈóÆÈ¢òÔºåÊØîÂ¶Ç‰∏ãÈù¢ËøôÊ†∑Ôºö
>
> ```kotlin
> override fun onDraw(canvas: Canvas) {
>  super.onDraw(canvas)
>  set { 
>      // ...
>  }
> }
> 
> private fun set(func: () -> Unit) {
>  func.invoke()
> }
> ```
>
> ËøôÁßçÊÉÖÂÜµËæÉÈöæÂèëÁé∞ÔºåËøôÊ†∑ÂÜôÊØèÊ¨°ÈÉΩ‰ºöÁîüÊàê‰∏Ä‰∏™ÂåøÂêçÂÜÖÈÉ®Á±ªÔºåÂª∫ËÆÆÂä†‰∏ä `inline` ÂÖ≥ÈîÆÂ≠ó
>
> **ËØ•Á¶Å‰ª§ÂêåÊ†∑ÈÄÇÁî®‰∫é `onMeasure()`„ÄÅ`onLayout()`ÔºÅ**

##### 2„ÄÅ‰∏çË¶ÅÂú® onDraw() ÈáåÈù¢ËøõË°åËÄóÊó∂Êìç‰Ωú

> ÂéüÂõ†Ë∑ü‰∏äÈù¢‰∏ÄÊ†∑
>
> **ËØ•Á¶Å‰ª§ÂêåÊ†∑ÈÄÇÁî®‰∫é `onMeasure()`„ÄÅ`onLayout()`ÔºÅ**

##### 3„ÄÅ‰∏çË¶ÅÊåÅÊúâ canvas ÂØπË±°

> ÊØèÊ¨°ÂõûË∞ÉÁöÑ canvas ÂØπË±°Âπ∂‰∏çÊòØ‰∏ÄÂÆöÊòØÂêå‰∏Ä‰∏™ÔºàÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÊòØÂêå‰∏Ä‰∏™ÔºâÔºåËÄå‰∏îÊØèÊ¨°ÁöÑÂõûË∞ÉÂè™ËÉΩË°®Á§∫ÂΩìÂâçÂ∏ßÁöÑÁä∂ÊÄÅÔºåÊØîÂ¶ÇÊàë‰ª¨Êù•‰∏™ËøùËßÑÊìç‰ΩúÔºö
>
> ```kotlin
> override fun onDraw(canvas: Canvas) {
>  super.onDraw(canvas)
>  // ÂºÄ‰∏Ä‰∏™Á∫øÁ®ãÊ®°ÊãüÊåÅÊúâ canvas ÂØπË±°
>  thread {
>      // Âª∂Ëøü 20 ÊØ´ÁßíÊâçÁªòÂõæ
>      sleep(20)
>      canvas.drawRect(0F, 0F, 100F, 200F, mBlackPaint)
>  }
> }
> ```
>
> ‰Ω†ÂèØËÉΩÁåúÈÉΩÁåú‰∏çÂà∞ÂÆÉÊääÂõæÁªòÂà∂Âà∞Âì™ÈáåÂéª‰∫Ü
>
> 
>
> 
>
> 
>
> 
>
> 
>
> 
>
> 
>
> 
>
> 
>
> 
>
> <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320163052101.png" alt="image-20220320163052101" style="zoom:50%;float:left" />
>
> Â•ΩÂÆ∂‰ºôÔºåÂÆÉÁ´üÁÑ∂ÊääÂõæÁªòÂà∂Âà∞Ê†áÈ¢òÊ†è‰∏ä‰∫ÜÔºåËøôÈáåÁåúÊµãÂéüÂõ†Â¶Ç‰∏ãÔºàÊ≤°ÊúâÂéªÊü•ÁúãÊ∫êÁ†ÅÊâæÁúüÊ≠£ÂéüÂõ†ÔºâÔºö
>
> - Êï¥‰∏™Â∫îÁî®ÂÖ±Áî®‰∫ÜÂêå‰∏Ä‰∏™ canvas ÂØπË±°
> - Âõ†ÂºÄÂêØÁ∫øÁ®ãÂêé sleepÔºåÊâÄ‰ª• canvas ÊòØÊï¥‰∏™Â∫îÁî®ÁªòÂà∂ÂÆåÊàêÂêéÂÜçË∞ÉÁî®ÁöÑ `canvas.drawRect()`
> - **Ê†áÈ¢òÊ†èÊòØÂú®ÊúÄÂêéËøõË°åÁªòÂà∂ÁöÑ**ÔºåÊ≠§Êó∂ÁöÑ canvas ÁöÑÂùêÊ†áÁ≥ªÊòØ‰ª•Ê†áÈ¢òÊ†è‰∏∫ÂáÜÁöÑ
>
> ËøôÊÄé‰πàÈ™åËØÅÂë¢Ôºü
>
> > ‰Ω†ÊääÂºÄÂèëËÄÖÊ®°ÂºèÊ®°ÂºèÁöÑ `ÊòæÁ§∫Â∏ÉÂ±ÄËæπÁïå` ÁªôÊâìÂºÄÔºå‰Ω†‰ºöÁúãÂà∞‰∏ãÈù¢ËøôÁßçÂõæÔºö
> >
> > <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320164459116.png" alt="image-20220320164459116" style="zoom: 67%;float:left" />
> >
> > ËøôÈáåËØ¥ÊòéÊ†áÈ¢òÊ†èÁöÑÊñáÂ≠óÊòØ‰∏Ä‰∏™ View Êù•ÊòæÁ§∫ÁöÑ
> >
> > ÈÇ£Êàë‰ª¨ËØïËØïÊääÊ†áÈ¢òÊ†èÁªôÂéªÊéâ‰ºöÂèëÁîü‰ªÄ‰πàÔºü
> >
> > ```xml
> > <!--theme.xml-->
> > <style name="xxx" parent="Theme.MaterialComponents.DayNight.NoActionBar">
> > ```
> >
> > <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320164844556.png" alt="image-20220320164844556" style="zoom: 67%;float:left" />
> >
> > ÂòøÔºåÂéªÊéâÊ†áÈ¢òÊ†èÂêéÁªòÂà∂ÁöÑ‰ΩçÁΩÆÂØπ‰∫ÜÔºåÊâÄ‰ª•ËøôÈáåÊàëÊèêÂá∫ÁåúÊµãÔºöÊ†áÈ¢òÊ†èÊòØÂú®ÊúÄÂêéËøõË°åÁªòÂà∂ÁöÑ
> >
> > ÂÖ∂ÂÆûÊàë‰ª¨ÂèØ‰ª•È™åËØÅ‰∏Ä‰∏ãËøô‰∏™ÁåúÊµãÔºåÂÜô‰∏Ä‰∏™Âú®ÂÆÉÂêéÈù¢ÁªòÂà∂ÁöÑ View È™åËØÅ‰∏ãÔºö
> >
> > ```xml
> > <com.ndhzs.lib.section4.MySection4ViewCanvas
> >  android:layout_width="300dp"
> >  android:layout_height="300dp"
> >  app:layout_constraintBottom_toBottomOf="parent"
> >  app:layout_constraintLeft_toLeftOf="parent"
> >  app:layout_constraintRight_toRightOf="parent"
> >  app:layout_constraintTop_toTopOf="parent" />
> > 
> > <View
> >  android:layout_width="match_parent"
> >  android:layout_height="match_parent"/>
> > ```
> >
> > <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320165148269.png" alt="image-20220320165148269" style="zoom: 67%;float:left" />
> >
> > ÊûúÁÑ∂ÔºåÊàëÁöÑÁåúÊµãÂ∫îËØ•ÊòØÂêàÁêÜÁöÑ

##### 4„ÄÅËá™ÂÆö‰πâ View Âíå ViewGroup Âú®ÁªòÂà∂‰∏≠ÁöÑ‰∏çÂêå

> Âú®Ëá™ÂÆö‰πâ ViewGroup ‰∏≠Ôºå‰∏ÄËà¨‰∏ç‰ºöÈáçÂÜô `onDraw()`ÔºåÂõ†‰∏∫ ViewGroup ÂØπ `onDraw()` ËøõË°å‰∫ÜÂ§ÑÁêÜÔºåÂè™ÊúâÂú®**ÊúâËÉåÊôØÂõæÊó∂**ÔºåÊâç‰ºöË∞ÉÁî® `onDraw()`ÔºåÊâÄ‰ª•Âú®Ëá™ÂÆö‰πâ ViewGroup Êó∂ÊÉ≥ÁªòÂõæ‰∏ÄËà¨ÊòØÈáçÂÜô `dispatchDraw(Canvas canvas)`ÔºåËøô‰∏™ÊñπÊ≥ï‰πüÂèØ‰ª•ÂÜ≥ÂÆöÊòØÁªòÂà∂Âú®Â≠ê View ‰∏äÂ±ÇËøòÊòØÂ≠ê View ‰∏ãÂ±ÇÔºåÂÖ∑‰ΩìÁöÑ‰Ω†‰ª¨Ëá™Â∑±ÂéªÂÆûË∑µ‰∏Ä‰∏ãÂêßÔºåËøôÈáåÁªôÂá∫ÊñáÁ´†ÈìæÊé•Ôºöhttps://www.jianshu.com/p/89efaf8bd3dd

#### 5„ÄÅonDraw() ÁöÑÁªòÂà∂ÊµÅÁ®ã

> Ëøô‰∏úË•øÂ±û‰∫éÈ´òÈò∂ÂÜÖÂÆπÔºåÈôê‰∫éÊó∂Èó¥ÂÖ≥Á≥ªÔºåËøôÈáåÊàëÂ∞±‰∏çËÆ≤‰∫ÜÔºåÂèØ‰ª•ÁúãÁúãËøô‰∫õÊñáÁ´†Ôºö
>
> - https://blog.csdn.net/carson_ho/article/details/56011153
> - https://github.com/Idtk/Blog/blob/master/Blog/9%E3%80%81Invalidate.md
>
> 

### 5„ÄÅinvalidate()

> Ëøô‰∏úË•ø‰Ω†ÁõÆÂâçÂè™ÈúÄË¶ÅËÆ∞‰Ωè‰ª•‰∏ãÂá†ÁÇπÂ∞±ÂèØ‰ª•‰∫ÜÔºö
>
> - Ë∞ÉÁî®Âêé‰ºöÂú®**‰∏ã‰∏ÄÂ∏ßÂõûË∞É** `onDraw()` ËøõË°åÂà∑Êñ∞
> - ‰∏ã‰∏ÄÂ∏ßÊòØÊåá‰∏ã‰∏ÄÊ¨°Â±èÂπïÂà∑Êñ∞ÁöÑÊó∂ÂÄô
>
> Â¶ÇÊûú‰Ω†ÊÉ≥Êé¢Á©∂Ê∫êÁ†ÅÁöÑËØùÔºåÊàëÂè™ËÉΩ‰∏¢ÊñáÁ´†Âá∫Êù•‰∫ÜÔºö
>
> - https://juejin.cn/post/7017452765672636446
>
> OKÔºåËøô‰∏™ÊñπÊ≥ïËÆ≤ÂÆå‰∫ÜÔºåÂõ†‰∏∫ÂæÄÊ∑±‰∫ÜËÆ≤Ôºå‰ºöÊ∂âÂèäÂà∞ Handler Êú∫Âà∂„ÄÅViewRootImpl Á≠â Framwork Â±ÇÊ∫êÁ†Å
>
> Âì¶ÔºåÊÉ≥Ëµ∑‰∫ÜÔºåËøòË¶Å‰∏ÄÁÇπÔºåÈô§‰∫Ü `invalidate()` Â§ñËøòÊúâ‰∏Ä‰∏™ `postInvalidate()` Áî®‰∫éÂú®ÂÖ∂‰ªñÁ∫øÁ®ãÈáåÂà∑Êñ∞
>
> ‰ΩÜËÄÉËôëÂà∞ÂèØËÉΩ‰ºöÊúâÂÖ∂‰ªñÂ≠¶ÈïøÊù•Âê¨ËØæÔºåÊàëËøòÊòØÁîª‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊµÅÁ®ãÂõæ
>
> ```mermaid
> graph TB
> id1("View")-->id2
> id2["Ë∞ÉÁî®invalidate()Âà∑Êñ∞"]-->id3
> id3{"parent == null"}--‰∏ç‰∏∫ null-->id4
> id4["ÂëäËØâÁà∂Â∏ÉÂ±ÄÊúâÂ≠êÂ∏ÉÂ±ÄË¶ÅÈáçÁªò"]-->id3--‰∏∫ null-->id5
> id5["‰º†ÈÄíÂà∞‰∫Ü ViewRootImpl (‰∏Ä‰∏™ÁÆ°ÁêÜÂ∏ÉÂ±ÄÁöÑÁ±ª)"]-->id6
> id6["ViewRootImpl Ë∞ÉÁî® mChoreographer ÂèëÈÄÅ‰∏Ä‰∏™ post (‰∏Ä‰∏™‰∏ìÈó®ÁõëÂê¨Â±èÂπïÂà∑Êñ∞ÁöÑÁ±ª)"]-.->id7
> id7["Â±èÂπïÂà∑Êñ∞‰∫ÜÔºåÂõûË∞É ViewRootImplÔºåÂºÄÂßãÈáçÊñ∞Ëµ∞ View ÊµãÈáèÂíåÁªòÂõæÊµÅÁ®ã"]-->id8
> id8("‰ªéÈ°∂ÈÉ®Â∏ÉÂ±ÄÊúÄÂêéÂõûË∞ÉÂà∞ View ÁöÑ onDraw()")
> ```
>
> ÂÖ∂ÂÆûËøòÊúâ‰∫øÁÇπÁªÜËäÇÔºåËøôÈáåÊàëÂ∞±‰∏çËÆ≤Ëø∞‰∫ÜÔºåËá™Â∑±Áúã‰∏ãÈù¢ÂõæÔºåÂÖ∂ÂÆûËøôÂõæ‰ªçÊúâËÆ∏Â§öÊ≤°ÊúâÁîª‰∏ä
>
> ```mermaid
> sequenceDiagram
> View->>View: invalidate()
> View->>ViewGroup: invalidateChild()
> alt Â¶ÇÊûúÊòØÁ°¨‰ª∂Âä†ÈÄü
> 	ViewGroup->>other ViewGroups: onDescendantInvalidated()
> 	other ViewGroups->>DecorView: onDescendantInvalidated()
> 	DecorView->>ViewRootImpl: onDescendantInvalidated()
> 	ViewRootImpl->>ViewRootImpl: invalidate()
> else Â¶ÇÊûúÊòØËΩØ‰ª∂Âä†ÈÄü
> 	ViewGroup->>other ViewGroups: invalidateChildInParent()
> 	other ViewGroups->>DecorView: invalidateChildInParent()
> 	DecorView->>ViewRootImpl: invalidateChildInParent()
> 	ViewRootImpl->>ViewRootImpl: invalidateRectOnScreen()
> end
> ViewRootImpl->>ViewRootImpl: scheduleTraversals()
> ViewRootImpl->>Choreographer: postCallback(mTraversalRunnable)
> Choreographer->>Handler: sendMessage*()
> Handler->>Handler: Á≠âÂà∞‰∏ã‰∏ÄÊ¨°Â±èÂπïÂà∑Êñ∞
> Handler->>ViewRootImpl: mTraversalRunnable.run()
> ViewRootImpl->>ViewRootImpl: doTraversal()
> ViewRootImpl->>ViewRootImpl: performTraversals()
> ViewRootImpl->>ViewRootImpl: performDraw()
> ViewRootImpl->>DecorView: draw()
> DecorView->>other ViewGroups: draw()
> other ViewGroups->>ViewGroup: draw()
> ViewGroup->>View: draw()
> View->>View: onDraw()
> ```
>
> END

### 6„ÄÅËá™ÂÆö‰πâÂ±ûÊÄß AttributeSet

> ÂâçÈù¢Êàë‰ª¨ÊèêÂà∞Á≥ªÁªü‰ºöÊää‰Ω† xml ‰∏≠ÂÜôÂæóÂ±ûÊÄßË£ÖÊç¢‰∏∫‰∏Ä‰∏™ AttributeSet ÂØπË±°ÔºåÈÇ£Êàë‰ª¨ÊÄé‰πàËá™ÂÆö‰πâËá™Â∑±ÁöÑÂ±ûÊÄßÂë¢Ôºü
>
> È¶ñÂÖàÔºåÈúÄË¶ÅÊñ∞Âª∫‰∏Ä‰∏™ `res/value/attrs.xml` Êñá‰ª∂ÔºåÊØîÂ¶ÇÊàëÊÉ≥Ë¶ÅËá™ÂÆö‰πâ‰∏Ä‰∏™ÂúÜÂçäÂæÑÁöÑÂ±ûÊÄß
>
> ```xml
> <resources>
>  <!--Ëøô‰∏™ name ÊòØ View ÁöÑÁ±ªÂêç-->
>  <declare-styleable name="MySection6View">
>      <!--Ëøô‰∏™ name ÊòØËá™ÂÆö‰πâÂ±ûÊÄßÁöÑÂêçÁß∞Ôºåformate ÊòØÊé•ÂèóÁöÑÁ±ªÂûã-->
>      <attr name="my6_circleRadius" format="dimension"/>
>  </declare-styleable>
> </resources>
> ```
>
> Â¶Ç‰∏äËø∞‰ª£Á†ÅÔºåËøôÈáåÊúâÈúÄË¶ÅÊ≥®ÊÑèÁöÑ‰∏ÄÁÇπÔºö
>
> - Ëá™ÂÆö‰πâÂ±ûÊÄßÁöÑÂêçÁß∞‰∏çËÉΩ‰∏éÂÆòÊñπÁöÑÈáçÂ§çÔºåËÄå‰∏îÂª∫ËÆÆÂä†‰∏äÂâçÁºÄÔºå‰∏éÂÆòÊñπÁöÑËøõË°åÂå∫ÂàÜÔºåÊØîÂ¶ÇÊàëÂ∞±Âä†‰∏ä‰∫Ü `my6_`
>
> `formate` Êúâ‰∏ãÈù¢Âá†ÁßçÁ±ªÂûãÔºö
>
> | Á±ªÂûã            | ËØ¥Êòé     | Áî®Ê≥ï                          |                                        |
> | --------------- | -------- | ----------------------------- | -------------------------------------- |
> | ***dimension*** | ÈïøÂ∫¶ÂÄº   | "1dp"„ÄÅ"1px"„ÄÅ"@dimen/xxx"    | ËøôÈáåÊó†ÊâÄË∞ì dp„ÄÅpxÔºåÁ≥ªÁªü‰ºöÊúÄÁªàË£ÖÊç¢Êàê px |
> | ***reference*** | ÂºïÁî®ÂÄº   | "@drawable/xxx"„ÄÅ"@style/xxx" |                                        |
> | ***color***     | È¢úËâ≤ÂÄº   | "#FFFFFFFF"„ÄÅ"@color/xxx"     |                                        |
> | ***float***     | Â∞èÊï∞     | "1.0"                         |                                        |
> | ***boolean***   | Â∏ÉÂ∞îÁ±ªÂûã | "true"„ÄÅ"@bool/xxx"           |                                        |
> | ***interger***  | Êï¥Êï∞     | "1"„ÄÅ"@interget/xxx"          |                                        |
> | ***string***    | Â≠óÁ¨¶‰∏≤   | "string"„ÄÅ"@string/xxx"       |                                        |
> | ***fraction***  | ÁôæÂàÜÊï∞   | "50%"„ÄÅ"@fraction/xxx"        |                                        |
> | ***enum***      | Êûö‰∏æ     | [Áúã‰∏ãÊñá](#enum)               |                                        |
> | ***flag***      | ‰ΩçËøêÁÆó   | [Áúã‰∏ãÊñá](#flag)               |                                        |
>
> ### enum
>
> > ```xml
> > <!--ÊØîÂ¶ÇÊàëËÆæÁΩÆÂúÜÁöÑ‰ΩçÁΩÆÂ±ûÊÄß-->
> > <attr name="my6_circleGravity" format="enum">
> >     <enum name="left" value="0"/>
> >     <enum name="center" value="1"/>
> >     <enum name="right" value="2"/>
> > </attr>
> > ```
> >
> > <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220320195658810.png" alt="image-20220320195658810" style="zoom:50%;float:left" />
> >
> > ËÆæÁΩÆÂêéÂú®‰ΩøÁî®Êó∂ÂÆÉÁöÑÂ±ûÊÄßÂ∞±Âè™ËÉΩÈÄâÊã©‰Ω†Â°´ÂÜôÁöÑÈÇ£Âá†‰∏™
>
> ### flag
>
> > Â∞±ÊòØËøõË°å‰ΩçËøêÁÆóÔºåËøôÈáåÊàë‰ª¨‰ª• FrameLayout ÁöÑ `layout_gravity` ‰∏∫‰æã
> >
> > ```xml
> > <attr name="layout_gravity">
> >     <!--0011 0000-->
> >     <flag name="top" value="0x30" />
> >     <!--0101 0000-->
> >     <flag name="bottom" value="0x50" />
> >     <!--0000 0011-->
> >     <flag name="left" value="0x03" />
> >     <!--0000 0101-->
> >     <flag name="right" value="0x05" />
> >     <!--0001 0000-->
> >     <flag name="center_vertical" value="0x10" />
> >     <!--0000 0001-->
> >     <flag name="center_horizontal" value="0x01" />
> >     <!--0001 0001-->
> >     <flag name="center" value="0x11" />
> >     <flag name="start" value="0x00800003" />
> >     <flag name="end" value="0x00800005" />
> > </attr>
> > ```
> >
> > ‰Ω†ÊòØÂê¶ËøòËÆ∞Âæó‰Ω†ÊõæÁªèËøôÊ†∑‰ΩøÁî®ËøáÔºü
> >
> > ```xml
> > <FrameLayout
> >     android:layout_width="match_parent"
> >     android:layout_height="match_parent">
> > 
> >     <View
> >         android:layout_width="match_parent"
> >         android:layout_height="match_parent"
> >         android:layout_gravity="top|left"/>
> > 
> > </FrameLayout>
> > ```
> >
> > > ËøôÈáå‰Ω†‰ºöÂèëÁé∞ÂÆÉÊää `top|left` Êä•ÈªÑ‰∫ÜÔºåÂéüÂõ†Âú®‰∫éÂÆÉÊé®Ëçê‰Ω†‰ΩøÁî® `start` Âéª‰ª£Êõø `left`ÔºåÂõ†‰∏∫Âú®ÈÉ®ÂàÜÂõΩÂÆ∂ÊòØ‰ªéÂè≥ËæπÂæÄÂ∑¶ËæπÈòÖËØªÊñáÂ≠óÁöÑÔºåÊâÄ‰ª•ÔºåAndroid ‰∏∫‰∫ÜÂõΩÈôÖÂåñÔºåÂ∞±ËÆæËÆ°Âá∫‰∫Ü `start` ‰ª£Êõø `left`Ôºå`end` ‰ª£Êõø `right`
>
> ### Á±ªÂûãÁöÑÊ∑∑Áî®
>
> > ÊØîÂ¶Ç `android:layout_width` ÊòØËøôÊ†∑ÂÆö‰πâÁöÑÔºö
> >
> > ```xml
> > <attr name="layout_width" format="dimension">
> >     <enum name="fill_parent" value="-1" />
> >     <enum name="match_parent" value="-1" />
> >     <enum name="wrap_content" value="-2" />
> > </attr>
> > ```
> >
> > 
> >
> > ËøòÊúâ `android:background` ÊòØËøôÊ†∑ÂÆö‰πâÁöÑÔºö
> >
> > ```xml
> > <attr name="background" format="reference|color" />
> > ```
> >
> > ÊâÄ‰ª•‰Ω†‰º†ÂÖ• `@drawable/xxx` Âíå `#FFFFFFFF`ÔºåÂÆÉÈÉΩÂèØ‰ª•Ëé∑ÂèñÔºåÂè™ÊòØÂ°´ÂÖ•È¢úËâ≤ÂÄºÊó∂‰ΩøÁî® `TypedValue#getDrawable()` ÂæóÂà∞ÊòØ ColorDrawable
> >
> > 
> >
> > ‰πüÊîØÊåÅËøôÊ†∑Ê∑∑Áî®Ôºö
> >
> > ```xml
> > <!--ËøôÊòØ View ÁöÑ‰∏Ä‰∏™Â±ûÊÄß-->
> > <attr name="focusable" format="boolean|enum">
> >     <enum name="auto" value="0x00000010" />
> > </attr>
> > ```
> >
> > ‰ΩÜËøôÊ†∑‰ΩøÁî®Âè™ËÉΩÊâãÂä®ÂéªÂà§Êñ≠Ôºö
> >
> > ```java
> > private int getFocusableAttribute(TypedArray attributes) {
> >     TypedValue val = new TypedValue();
> >     if (attributes.getValue(com.android.internal.R.styleable.View_focusable, val)) {
> >         if (val.type == TypedValue.TYPE_INT_BOOLEAN) {
> >             return (val.data == 0 ? NOT_FOCUSABLE : FOCUSABLE);
> >         } else {
> >             return val.data;
> >         }
> >     } else {
> >         return FOCUSABLE_AUTO;
> >     }
> > }
> > ```
>
> ÂâçÈù¢ËÆ≤‰∫ÜÁ±ªÂûãÁöÑÂÆö‰πâÔºåÈÇ£Êàë‰ª¨ÊÄé‰πàËé∑ÂèñËøô‰∫õÂ±ûÊÄßÂë¢Ôºü
>
> ```kotlin
> private var mCircleRadius = 100
> // Ëøô‰∏™ enum Â±ûÊÄßÊõ¥Âª∫ËÆÆ‰ΩøÁî®Êûö‰∏æÊù•‰øùÂ≠òÔºåÂÆòÊñπÈÄöÂ∏∏‰ΩøÁî®ÁöÑÊ≥®Ëß£Ôºå‰ΩÜ kt ÂæàÊÄ™ÔºåÊ≥®Ëß£‰∏çËµ∑‰ΩúÁî®
> private var mCircleGravity = 0
> init {
>     if (attrs != null) {
>         // ‰∏ªË¶ÅÂ∞±ÊòØË∞ÉÁî®‰∏ãÈù¢Ëøô‰∏™ÊñπÊ≥ïÂéªËé∑ÂèñÂ±ûÊÄß
>         val ty = context.obtainStyledAttributes(attrs, R.styleable.MySection6View)
>         mCircleRadius = ty.getDimensionPixelSize(
>             R.styleable.MySection6View_my6_circleRadius,
>             mCircleRadius
>         )
>         mCircleGravity = ty.getInt(
>             R.styleable.MySection6View_my6_circleGravity,
>             mCircleGravity
>         )
>         ty.recycle()
>     }
> }
> ```
>
> ËøôÈáåËøòÂ•ΩÂè™Êúâ‰∏§‰∏™Â±ûÊÄßÔºå‰ΩÜÂ¶ÇÊûúÊúâÂ§öËææ‰∏äÁôæ‰∏™Â±ûÊÄßËøôÊ†∑ÂÜôÊú™ÂÖçÂ§™Âç†Ë°åÊï∞‰∫ÜÔºåÊâÄ‰ª•ÔºåÁßâÊåÅÁùÄÂ∞ëÂÜô‰ª£Á†ÅÁöÑÂéüÂàôÔºåÊàë‰ΩøÁî®‰∫Ü kt Êâ©Â±ïÂáΩÊï∞Êù•‰ºòÂåñÔºà‰∏ãÈù¢ÊòØÊàëÂÜôÁöÑËØæË°®Ëá™ÂÆö‰πâ ViewÔºâÔºö
>
> ```kotlin
> // ÂÖàÊääÂ±ûÊÄßÁöÑËØªÂèñÂçïÁã¨ÊèêÂèñÂà∞‰∏Ä‰∏™Á±ª‰∏≠
> open class NetLayout @JvmOverloads constructor(
>     context: Context,
>     attrs: AttributeSet? = null,
>     defStyleAttr: Int = R.attr.netLayoutStyle,
>     defStyleRes: Int = 0
> ) : ViewGroup(context, attrs, defStyleAttr, defStyleRes), INetLayout {
>     // Â±ûÊÄßÂÄº
>     protected val mNetAttrs: NetLayoutAttrs = NetLayoutAttrs.newInstance(this, attrs)
> }
> ```
>
> ````kotlin
> // ÊàëÊääÂ±ûÊÄßÂçïÁã¨ÂÜôÂú®‰∫Ü‰∏Ä‰∏™Á±ªÈáåÈù¢
> open class NetLayoutAttrs(
>     rowCount: Int,
>     columnCount: Int
> ) : BaseViewAttrs {
> 
>     var rowCount = rowCount
>         internal set
>     var columnCount = columnCount
>         internal set
> 
>     companion object {
>         fun newInstance(
>             view: View,
>             attrs: AttributeSet?,
>             defStyleAttr: Int = 0,
>             defStyleRes: Int = 0,
>         ): NetLayoutAttrs {
>             return newAttrs(
>                 view,
>                 attrs,
>                 R.styleable.NetLayout,
>                 defStyleAttr,
>                 defStyleRes
>             ) {
>                 // ËøôÈáå‰Ω†Â∞±‰ºöÁúãÂà∞Áõ¥Êé•‰ΩøÁî® R.styleable.xxx.int() Êù•Ëé∑ÂèñÂ±ûÊÄßÔºåËøôÊ†∑ÂÜôËµ∑Êù•ËàíÊúçÂ§ö‰∫Ü
>                 NetLayoutAttrs(
>                     R.styleable.NetLayout_net_rowCount.int(ROW_COUNT),
>                     R.styleable.NetLayout_net_columnCount.int(COLUMN_COUNT)
>                 )
>             }
>         }
> 
>         const val ROW_COUNT = 4
>         const val COLUMN_COUNT = 4
>     }
> }
> ````
>
> ```kotlin
> // ËøôÊòØÂÆö‰πâÊâ©Â±ïÂáΩÊï∞ÁöÑÊé•Âè£
> internal interface BaseViewAttrs {
> 
>     fun <T> newAttrs(
>         view: View,
>         attrs: AttributeSet?,
>         @StyleableRes
>         styleableId: IntArray,
>         defStyleAttr: Int = 0,
>         defStyleRes: Int = 0,
>         func: Typedef.() -> T
>     ): T = BaseViewAttrs.newAttrs(view, attrs, styleableId, defStyleAttr, defStyleRes, func)
> 
>     companion object {
>         fun <T> newAttrs(
>             view: View,
>             attrs: AttributeSet?,
>             @StyleableRes
>             styleableId: IntArray,
>             defStyleAttr: Int = 0,
>             defStyleRes: Int = 0,
>             func: Typedef.() -> T
>         ): T {
>             val ty = view.context.obtainStyledAttributes(attrs, styleableId, defStyleAttr, defStyleRes)
>             if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
>                 // ËøôÊòØ‰øùÂ≠òÂú® Debug Ê®°Âºè‰∏≠ËÉΩÁúãÂà∞ÁöÑ‰ø°ÊÅØÔºåÂÖ∑‰ΩìÊÄé‰πàÊü•ÁúãÔºå‰Ω†ÂèØ‰ª•ÂéªÁúãÁúãËøô‰∏™ÊñπÊ≥ïÁöÑÊ∫êÁ†Å
>                 view.saveAttributeDataForStyleable(
>                     view.context, styleableId, attrs, ty, defStyleAttr, defStyleRes)
>             }
>             try {
>                 return Typedef(ty, view.context).func()
>             } finally {
>                 ty.recycle()
>             }
>         }
>     }
> 
>     class Typedef(val ty: TypedArray, private val context: Context) {
>         fun Int.int(defValue: Int): Int = this.int(ty, defValue)
>         fun Int.color(defValue: Int): Int = this.color(ty, defValue)
>         fun Int.colorById(@ColorRes defValueId: Int): Int = this.color(
>             ContextCompat.getColor(context, defValueId))
>         fun Int.dimens(defValue: Int): Int = this.dimens(ty, defValue)
>         fun Int.dimens(defValue: Float): Float = this.dimens(ty, defValue)
>         fun Int.layoutDimens(defValue: Int): Int = this.layoutDimens(ty, defValue)
>         fun Int.dimensById(@DimenRes defValueId: Int): Int = this
>         .dimens(context.resources.getDimensionPixelSize(defValueId))
>         fun Int.string(defValue: String? = null): String = this.string(ty, defValue)
>         fun Int.boolean(defValue: Boolean): Boolean = this.boolean(ty, defValue)
>         fun Int.float(defValue: Float): Float = this.float(ty, defValue)
>         internal inline fun <reified E: RuntimeException> Int.intOrThrow(
>             attrsName: String): Int = this.intOrThrow<E>(ty, attrsName)
>         internal inline fun <reified E: RuntimeException> Int.stringOrThrow(
>             attrsName: String): String = this.stringOrThrow<E>(ty, attrsName)
>     }
> }
> 
> internal fun Int.int(ty: TypedArray, defValue: Int): Int {
>     return ty.getInt(this, defValue)
> }
> 
> internal fun Int.color(ty: TypedArray, defValue: Int): Int {
>     return ty.getColor(this, defValue)
> }
> 
> internal fun Int.dimens(ty: TypedArray, defValue: Int): Int {
>     return ty.getDimensionPixelSize(this, defValue)
> }
> 
> internal fun Int.dimens(ty: TypedArray, defValue: Float): Float {
>     return ty.getDimension(this, defValue)
> }
> 
> internal fun Int.layoutDimens(ty: TypedArray, defValue: Int): Int {
>     return ty.getLayoutDimension(this, defValue)
> }
> 
> internal fun Int.string(ty: TypedArray, defValue: String? = null): String {
>     return ty.getString(this) ?: defValue ?: ""
> }
> 
> internal fun Int.boolean(ty: TypedArray, defValue: Boolean): Boolean {
>     return ty.getBoolean(this, defValue)
> }
> 
> internal fun Int.float(ty: TypedArray, defValue: Float): Float {
>     return ty.getFloat(this, defValue)
> }
> 
> internal inline fun <reified E: RuntimeException> Int.intOrThrow(
>     ty: TypedArray, attrsName: String
> ): Int {
>     if (!ty.hasValue(this)) {
>         throw E::class.java.getConstructor(String::class.java)
>             .newInstance("Â±ûÊÄß $attrsName Ê≤°ÊúâË¢´ÂÆö‰πâÔºÅ")
>     }
>     return this.int(ty, 0)
> }
> 
> internal inline fun <reified E: java.lang.RuntimeException> Int.stringOrThrow(
>     ty: TypedArray, attrsName: String
> ): String {
>     if (!ty.hasValue(this)) {
>         throw E::class.java.getConstructor(String::class.java)
>             .newInstance("Â±ûÊÄß $attrsName Ê≤°ÊúâË¢´ÂÆö‰πâÔºÅ")
>     }
>     return this.string(ty)
> }
> ```
>
> ### Ëá™ÂÆö‰πâ layout_ Â±ûÊÄß
>
> ‰πãÂâçÂú®ÊàëÁªôÂ§ßÂÆ∂‰∏äÁöÑ Android Á¨¨‰∏ÄËäÇËØæËÆ≤ËøáÔºåÁà∂ View ÊòØÂèØ‰ª•ÁªôÂ≠ê View È¢ùÂ§ñÊ∑ªÂä†Â±ûÊÄßÁöÑÔºå‰∏îÂ±ûÊÄßÂêç‰ª• `layout_` ÂºÄÂ§¥
>
> ```xml
> <!--ÊØîÂ¶ÇËØ¥Ëøô‰∏™ÈáåÈù¢ÊâÄÊúâ layout_ ÂºÄÂ§¥ÁöÑÈÉΩÊòØÁà∂ View ÁªôÂ≠ê View Ê∑ªÂä†ÁöÑÈ¢ùÂ§ñÂ±ûÊÄß-->
> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
>     android:layout_width="match_parent"
>     android:layout_height="match_parent"
>     xmlns:app="http://schemas.android.com/apk/res-auto">
> 
>     <FrameLayout
>         android:layout_width="match_parent"
>         android:layout_height="match_parent"
>         app:layout_constraintEnd_toEndOf="parent"
>         app:layout_constraintStart_toStartOf="parent"
>         app:layout_constraintTop_toTopOf="parent">
> 
>         <View
>             android:layout_width="match_parent"
>             android:layout_height="match_parent"
>             android:layout_gravity="top|left" />
> 
>     </FrameLayout>
> </androidx.constraintlayout.widget.ConstraintLayout>
> ```
>
> ÈÇ£Â¶Ç‰ΩïËá™ÂÆö‰πâ ViewGroup Â¶Ç‰ΩïËÆæÁΩÆËá™Â∑±ÊÉ≥Ë¶ÅÁöÑÂ±ûÊÄßÔºü
>
> ÊØîÂ¶ÇÊàëÁªôÂÆÉÊ∑ªÂä†‰∏Ä‰∏™Ë°®Á§∫Â≠ê View ‰ΩçÁΩÆÁöÑÂ±ûÊÄßÔºö
>
> ```xml
> <resources>
>     <!--Ê≥®ÊÑèÔºöËøôÁßçÂ±ûÊÄßÁöÑËÆæÁΩÆÂøÖÈ°ª‰ª• _Layout ÁªìÂ∞æÔºåËøôÊòØÂÆòÊñπÁöÑËßÑËåÉÔºÅ-->
>     <declare-styleable name="My6ViewGroup_Layout">
>         <!--Ê≥®ÊÑèÔºöÂ±ûÊÄßÂêçÂª∫ËÆÆÂ∏¶Êúâ layout_ ÂºÄÂ§¥ÁöÑÊ†áËØÜ-->
>         <attr name="my6VG_layout_position" format="integer"/>
>     </declare-styleable>
> </resources>
> ```
>
> ÁÑ∂ÂêéÂú® xml ‰∏≠ÂÜôÂæóÊó∂ÂÄôÔºåAS ‰ºöËøõË°åÊô∫ËÉΩÊèêÁ§∫
>
> <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220321194906364.png" alt="image-20220321194906364" style="zoom:67%;" />
>
> ÈÇ£ÊÄé‰πàËé∑ÂèñËøô‰∏™Â±ûÊÄßÂë¢Ôºü
>
> Ëøô‰∏™Êàë‰ª¨ÁïôÂà∞ [LayoutParams](#1„ÄÅLayoutParams) ÂÜçËÆ≤Ëß£

### 7„ÄÅonMeasure()

> ### ‰ΩúÁî®
>
> ÊµãÈáèËá™Ë∫´ÂíåÂ≠êÊéß‰ª∂Â§ßÂ∞è
>
> ### Ê∂âÂèäÁü•ËØÜ
>
> - `MeasureSpecs`
> - `LayoutParams`
>
> ```kotlin
> // ‰∏é‰∏äÈù¢ËÆ≤ÁöÑ onDraw() ‰∏ÄÊ†∑Ôºå‰πüÊòØ‰∏Ä‰∏™ÂõûË∞ÉÔºåËØ•ÂõûË∞ÉÁöÑ‰ΩúÁî®ÊòØÁî± requestLayout() Ëß¶Âèë
> override fun onMeasure(widthMeasureSpec: Int, heightMeasureSpec: Int) {
>     super.onMeasure(widthMeasureSpec, heightMeasureSpec)
> }
> ```
>
> ### ‰∏ªË¶ÅÁî®Ê≥ï
>
> - Ë∞ÉÁî® `setMeasuredDimension()`ÔºåËÆæÁΩÆËá™Ë∫´ÂÆΩÂíåÈ´ò
> - ÈÅçÂéÜÂ≠ê ViewÔºåÂÜçË∞ÉÁî® `child.measure()`ÔºåËÆæÁΩÆÂ≠ê View ÁöÑÂÆΩÂíåÈ´ò
>
> ```mermaid
> graph LR
> id1("ViewRootImpl ÂºÄÂßãÊµãÈáè")-->id2
> id2["ViewGroup#mearsure()"]-->id3
> id3["ViewGroup#onMeasure()"]-->id4
> id4["View#measure()"]-->id5("View#onMeasure()")
> ```
>
> 

#### 1„ÄÅLayoutParams

> ËøôÂ∞±ÊòØ‰∏Ä‰∏™ÂæàÁÆÄÂçïÁöÑÊï∞ÊçÆÁ±ªÔºåÁî®‰∫éÂú®Â≠ê View ‰∏≠‰øùÂ≠òÁà∂Á±ªÈúÄË¶ÅÁöÑ‰ø°ÊÅØ
>
> Êàë‰ª¨Áõ¥Êé•Êù•Áúã‰∏Ä‰∏ã FrameLayout ÁöÑ LayoutParams
>
> ```java
> // ‰Ω†‰ºöÂèëÁé∞Ëøô LayoutParams ÂæàÁÆÄÂçï
> public static class LayoutParams extends MarginLayoutParams {
>  /**
>      * ÂØπÂ∫î layout_gravity Â±ûÊÄßÊ≤°ÊúâË¢´ËÆæÁΩÆ
>      */
>     public static final int UNSPECIFIED_GRAVITY = -1;
> 
>     /**
>      * ËøôÂ∞±ÊòØ layout_gravity Â±ûÊÄßÁöÑ‰øùÂ≠òÂÄº
>      * @see android.view.Gravity
>      * @attr ref android.R.styleable#FrameLayout_Layout_layout_gravity
>      */
>     public int gravity = UNSPECIFIED_GRAVITY;
> 
>     public LayoutParams(@NonNull Context c, @Nullable AttributeSet attrs) {
>         super(c, attrs);
>         // ÁúãÂà∞ËøôÈáå‰Ω†Â∫îËØ•Â∞±ËÉΩÂõûÁ≠î‰πãÂâçÁïô‰∏ãÁöÑÈóÆÈ¢ò‰∫Ü
>         // Áà∂ View ËØªÂèñÂ≠ê View ‰∏≠ÁöÑÂ±ûÊÄßÊòØÂú® LayoutParams ‰∏≠Ëé∑ÂèñÁöÑ
>         // ÂèØËÉΩ‰Ω†‰ºöÂ•áÊÄ™‰∫é View ÊòØ‰ªÄ‰πàÊó∂ÂÄôÂºÄÂßãÂä†ËΩΩ LayoutParams
>         // Ëøô‰∏™ÁïôÂà∞ÂêéÈù¢ËÆ≤ setContentView ÂÜçËÆ≤Ëß£
>         final TypedArray a = c.obtainStyledAttributes(attrs, R.styleable.FrameLayout_Layout);
>         gravity = a.getInt(R.styleable.FrameLayout_Layout_layout_gravity, UNSPECIFIED_GRAVITY);
>         a.recycle();
>     }
> 
>     public LayoutParams(int width, int height) {
>         super(width, height);
>     }
> 
>     public LayoutParams(int width, int height, int gravity) {
>         super(width, height);
>         this.gravity = gravity;
>     }
> 
>     public LayoutParams(@NonNull ViewGroup.LayoutParams source) {
>         super(source);
>     }
> 
>     public LayoutParams(@NonNull ViewGroup.MarginLayoutParams source) {
>         super(source);
>     }
> 
>     public LayoutParams(@NonNull LayoutParams source) {
>         super(source);
>         this.gravity = source.gravity;
>     }
> }
> ```
>
> Â¶ÇÊûúË¶ÅÊÉ≥‰ΩøÁî®Ëøô‰∏™ `LayoutParams` ËøòÂæóÈáçÂÜôËøôÂá†‰∏™ÊñπÊ≥ïÔºö
>
> ```kotlin
> // Ëøô‰∏™ÊòØÊ£ÄÊü• LayoutParams ÊòØÂê¶ÊòØ‰Ω†ÊÉ≥Ë¶ÅÁöÑ LayoutParams
> // Ê≥®ÊÑèÔºöËøô‰∏™ LayoutParams ÊòØÈúÄË¶ÅÊâì‰∏™ ? ÁöÑÔºåÂõ†‰∏∫Â≠òÂú®‰º†ÂÖ•‰∏Ä‰∏™ null ÁöÑÊÉÖÂÜµ
> override fun checkLayoutParams(p: LayoutParams?): Boolean {
>     // ËøôÊòØÊÉØÁî®ÂÜôÊ≥ï
>     return p is NetLayoutParams
> }
> 
> // Ëøô‰∏™ÊòØÈÄöËøá AttributeSet ÂæóÂà∞‰Ω†Ëá™Â∑±ÁöÑ LayoutParmas
> override fun generateLayoutParams(attrs: AttributeSet): LayoutParams {
>     return NetLayoutParams(context, attrs)
> }
> 
> // Ëøô‰∏™ÊòØË£ÖÊç¢ LayoutParms
> override fun generateLayoutParams(lp: LayoutParams): LayoutParams {
>     // Ëøô‰πüÊòØÊÉØÁî®ÂÜôÊ≥ïÔºåÊ≥®ÊÑèÔºöË¶ÅÊää‰Ω† LayoutParams ÁöÑÊâÄÊúâÁà∂Á±ªÈÉΩË¶ÅÂÜôÂÆå
>     return when (lp) {
>         is NetLayoutParams -> NetLayoutParams(lp)
>         is MarginLayoutParams -> NetLayoutParams(lp)
>         else -> NetLayoutParams(lp)
>     }
> }
> 
> // Ëøô‰∏™ÊòØÂæóÂà∞ÈªòËÆ§ÁöÑ LayoutParams
> override fun generateDefaultLayoutParams(): LayoutParams {
>     return NetLayoutParams(
>         NetLayoutParams.UNSET,
>         NetLayoutParams.UNSET,
>         NetLayoutParams.UNSET,
>         NetLayoutParams.UNSET
>     )
> }
> ```
>
> ËøôÂá†‰∏™ÊñπÊ≥ï‰ºöÂú®‰ªÄ‰πàÊó∂ÂÄôË¢´Ë∞ÉÁî®ÔºåÊàë‰ª¨‰ºöÂú®ÂêéÈù¢ÁöÑ [LayoutInflater](#1„ÄÅLayoutInflater) ËÆ≤Ëß£

#### 2„ÄÅMeasureSpecs

> Êé®ËçêÊñáÁ´†Ôºöhttps://www.jianshu.com/p/1260a98a09e9
>
> ÂÆÉ‰øùÂ≠ò‰∫ÜÊµãÈáèÊ®°ÂºèÂíåÊµãÈáèÂ§ßÂ∞è
>
> ÊØîÂ¶Ç‰∏äÈù¢‰ª£Á†Å‰∏≠ÁöÑÔºö`widthMeasureSpec` Âíå `heightMeasureSpec`
>
> ÂèØËÉΩ‰Ω†‰ºöÊØîËæÉÁñëÊÉëÂÆÉÊòØÊÄé‰πàÁî®‰∏Ä‰∏™ int Êù•‰øùÂ≠òÁöÑÔºåÂÖ∂ÂÆûÂéüÁêÜÂæàÁÆÄÂçïÔºåÂÆÉ‰ΩøÁî®È´ò 2 ‰Ωç‰øùÂ≠òÊµãÈáèÊ®°ÂºèÔºåÂêé 30 ‰∏∫ÊµãÈáèÂ§ßÂ∞è
>
> ```kotlin
> // ‰ΩøÁî®ÊñπÂºèÔºåÂéüÁêÜÂ∞±ÊòØ‰ΩçËøêÁÆó
> val wSize = MeasureSpec.getSize(widthMeasureSpec)
> val wMode = MeasureSpec.getMode(widthMeasureSpec)
> ```
>
> ÊµãÈáèÊ®°ÂºèÊúâ‰ª•‰∏ã‰∏âÁßçÔºö
>
> | Ê®°Âºè              | ËØ¥Êòé       | Â∫îÁî®Âú∫ÊôØ                                     |
> | ----------------- | ---------- | -------------------------------------------- |
> | ***EXACTLY***     | ÊúâÂÖ∑‰ΩìÂÄºÊó∂ | ‰∏ÄËà¨ÂØπÂ∫î `match_parent` ÂíåÂÖ∑‰ΩìÁöÑÂÄº           |
> | ***AT_MOST***     | Ëá™ÈÄÇÂ∫îÂ§ßÂ∞è | ‰∏ÄËà¨ÂØπÂ∫î `wrap_content`                      |
> | ***UNSPECIFIED*** | ÂèØ‰ªªÊÑèÂèñÂÄº | Âè™Âá∫Áé∞‰∫é `ScrollView`„ÄÅ`ListView` ËøôÁ±ªÊéß‰ª∂‰∏≠ |
>
> ÈáçÂÜô ViewGroup Êó∂Â∞±ÊòØÈÄöËøáËøô‰∫õÊù•Âà§Êñ≠Â≠ê View Â∫îËØ•ÂèñÂæóÁöÑÈ´òÂ∫¶ÁöÑ
>
> ÂÖ≥‰∫éÊÄé‰πàÂèñÔºåÂèØ‰ª•ÁúãËøô‰∏™Âú® ViewGroup ‰∏≠ÁöÑÊñπÊ≥ïÔºåÈáåÈù¢ÊòØÂ∏∏ËßÅÊÉÖÂÜµÊó∂ÁöÑÂèñÊ≥ïÔºåËØ•ÊñπÊ≥ïÂú®ÂæàÂ§öÂÆòÊñπÊéß‰ª∂‰∏≠Ë¢´‰ΩøÁî®
>
> ```java
> /**
>  * @param spec Â≠ê View ËÉΩÂæóÂà∞ÁöÑ MeasureSpecsÔºå‰∏ÄËà¨ÊòØÁà∂ View ÁöÑÊµãÈáèÊ®°Âºè + ÊÉ≥ÁªôÂá∫ÁöÑÂ§ßÂ∞è
>  * @param padding Èó¥Ë∑ùÂÄºÔºå‰∏ÄËà¨ËøôÊ†∑Â°´ÂÖ•ÔºölayoutParams.leftMargin + layoutParams.rightMargin
>  * @param childDimension Â≠ê View ÁöÑÂÆΩÊàñËÄÖÈ´òÔºåÂõ∫ÂÆöÂ°´ÂÖ•Ôºöchild.width ÊàñËÄÖ child.height
>  */
> public static int getChildMeasureSpec(int spec, int padding, int childDimension) {
>     int specMode = MeasureSpec.getMode(spec); // ÊµãÈáèÊ®°Âºè
>     int specSize = MeasureSpec.getSize(spec); // ÊµãÈáèÈïøÂ∫¶
> 
>     int size = Math.max(0, specSize - padding); // ÂÖàÂáèÂéªÈó¥Ë∑ùÂÄºÂæóÂà∞ÁöÑÊúÄÂ§ßÈïøÂ∫¶
> 
>     int resultSize = 0; // ‰øùÂ≠òÊúÄÂêéÁöÑÈïøÂ∫¶ÂÄº
>     int resultMode = 0; // ‰øùÂ≠òÊúÄÂêéÁöÑÊµãÈáèÔºåÊ®°Âºè
> 
>     switch (specMode) {
>     // Â¶ÇÊûúÊµãÈáèÊ®°ÂºèÊòØÂÖ∑‰ΩìÂÄºÔºåÂç≥‰∏ÄËà¨ÂØπÂ∫îÁà∂ View ‰∏∫ match_parent ÊàñËÄÖ Á°ÆÂÆöÂÄº
>     case MeasureSpec.EXACTLY:
>         if (childDimension >= 0) {
>             // ÂÅáËÆæÂ≠ê View Âõ∫ÂÆö‰∏∫ 100dp
>             resultSize = childDimension;
>             resultMode = MeasureSpec.EXACTLY;
>         } else if (childDimension == LayoutParams.MATCH_PARENT) {
>             // Â≠ê View ÊòØ match_parent
>             resultSize = size; // ÈÇ£ÁªìÊûúÂÄºÂ∞±ÊòØÊúÄÂ§ßÂÄº
>             resultMode = MeasureSpec.EXACTLY; // ÊµãÈáèÊ®°Âºè‰øùÊåÅ‰∏ÄÊ†∑Ôºå‰∏∫ÂÖ∑‰ΩìÂÄº
>         } else if (childDimension == LayoutParams.WRAP_CONTENT) {
>             // Â≠ê View ÊòØ wrap_content
>             resultSize = size;
>             resultMode = MeasureSpec.AT_MOST; // ÊîπÂèòÊµãÈáèÊ®°Âºè‰∏∫Ëá™ÈÄÇÂ∫îÂ§ßÂ∞è
>         }
>         break;
> 
>     // Â¶ÇÊûúÊµãÈáèÊ®°ÂºèÊòØËá™ÈÄÇÂ∫îÂ§ßÂ∞èÔºåÂç≥‰∏ÄËà¨ÂØπÂ∫îÁà∂ View ‰∏∫ wrap_content
>     case MeasureSpec.AT_MOST:
>         if (childDimension >= 0) {
>             // ÂÅáËÆæÂ≠ê View Âõ∫ÂÆö‰∏∫ 100dp
>             resultSize = childDimension;
>             resultMode = MeasureSpec.EXACTLY;
>         } else if (childDimension == LayoutParams.MATCH_PARENT) {
>             // Â≠ê View ÊòØ match_parent
>             // ËøôÈáåÊØîËæÉÈáçË¶Å
>             // ËøôÈáåÂØπÂ∫îÁà∂ View ‰∏∫ wrap_contentÔºå‰ΩÜÂ≠ê View Âç¥‰∏∫ match_parent
>             resultSize = size; // ËøôÈáåÁöÑÊÑèÊÄùÊòØÁªôÂá∫Â≠ê View ËÉΩÂæóÂà∞ÁöÑÊúÄÂ§ßÂÄº
>             resultMode = MeasureSpec.AT_MOST;
>         } else if (childDimension == LayoutParams.WRAP_CONTENT) {
>             // Â≠ê View ÊòØ wrap_content
>             resultSize = size;
>             resultMode = MeasureSpec.AT_MOST;
>         }
>         break;
> 
>     // Â¶ÇÊûúÊµãÈáèÊ®°ÂºèÊòØÂèØ‰ªªÊÑèÂèñÂÄºÔºåÂç≥‰∏ÄËà¨ÂØπÂ∫îÁà∂ View ‰∏∫ ScrollView
>     case MeasureSpec.UNSPECIFIED:
>         if (childDimension >= 0) {
>             // ÂÅáËÆæÂ≠ê View Âõ∫ÂÆö‰∏∫ 100dp
>             resultSize = childDimension;
>             resultMode = MeasureSpec.EXACTLY;
>         } else if (childDimension == LayoutParams.MATCH_PARENT) {
>             // Â≠ê View ÊòØ match_parent
>             // Ëøô‰∏™ sUseZeroUnspecifiedMeasureSpec ÂèòÈáèÁî®‰∫éÂÖºÂÆπ Android ÊóßÁâàÊú¨
>             resultSize = View.sUseZeroUnspecifiedMeasureSpec ? 0 : size;
>             resultMode = MeasureSpec.UNSPECIFIED;
>         } else if (childDimension == LayoutParams.WRAP_CONTENT) {
>             // Â≠ê View ÊòØ wrap_content
>             resultSize = View.sUseZeroUnspecifiedMeasureSpec ? 0 : size;
>             resultMode = MeasureSpec.UNSPECIFIED;
>         }
>         break;
>     }
>     return MeasureSpec.makeMeasureSpec(resultSize, resultMode);
> }
> ```
>
> Â¶ÇÊûú‰Ω†‰ª•ÂêéÂºÄÂèëËá™ÂÆö‰πâ ViewGroupÔºåÂú®ÁªôÂ≠ê View ÊµãÈáèÊó∂ÊàëÊõ¥Êé®Ëçê‰ΩøÁî®ËØ•ÊñπÊ≥ïÔºåÈÅµÂæ™ÂÆòÊñπÁöÑÂÜôÊ≥ïÂèØ‰ª•ÊèêÈ´òÂèØËØªÊÄß

##### 1„ÄÅFrameLayout ÁöÑ `onMeasure() Ê∫êÁ†ÅÂàÜÊûê`

> ```java
> // Êé•‰∏ãÊù•ÊòØËµ∑È£ûÁéØËäÇ
> @Override
> protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
>  int count = getChildCount();
> 
>  // Âà§Êñ≠Ëá™Ë∫´ÊòØÂê¶Êúâ‰∏ÄËæπ‰∏çÊòØÂÖ∑‰ΩìÂÄºÔºå‰ΩúÁî®Â¶Ç‰∏ãÔºö
>  // ÊØîÂ¶Ç FrameLayout ÁöÑÂÆΩÊòØ wrap_contentÔºå‰ΩÜÂÖ∂‰∏≠‰∏Ä‰∏™Â≠ê View ÂÆΩ‰∏∫ match_parent
>  // ÈÇ£‰πàËøô‰∏™Êó∂ÂÄô FrameLayout ÊòØ‰∏çÁü•ÈÅìËØ•ÁªôËøô‰∏™Â≠ê View ÂÆΩÂ∫¶Â§öÂ∞ëÁöÑ
>  // ‰ΩÜÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂÖ∂‰ªñ View Êù•Âà§Êñ≠ FrameLayout ËÉΩÂæóÂà∞ÁöÑÂÆΩÂ∫¶
>  // Ëøô‰∏™Êó∂ÂÄôÂ∞±Áü•ÈÅì FraneLayout ÂÆΩÂ∫¶ÂÄºËÉΩÂèñÂ§öÂ∞ë‰∫Ü
>  final boolean measureMatchParentChildren =
>          MeasureSpec.getMode(widthMeasureSpec) != MeasureSpec.EXACTLY ||
>          MeasureSpec.getMode(heightMeasureSpec) != MeasureSpec.EXACTLY;
>  // Ëøô‰∏™ÊòØ‰øùÂ≠ò‰∏äËø∞ÊâÄËØ¥ÁöÑÈÇ£ÁßçÂ≠ê ViewÔºåÁî®‰∫é‰∫åÊ¨°ÊµãÈáè
>  mMatchParentChildren.clear(); 
> 
>  int maxHeight = 0;
>  int maxWidth = 0;
>  // Áä∂ÊÄÅÂÄºÔºåÁî®Êù•ËÆ∞ÂΩïÂ≠ê View ÊòØÂê¶ÂæóÂà∞‰∫ÜÊÉ≥Ë¶ÅÁöÑÂ§ßÂ∞èÔºåÁî®ÁöÑÂæàÂ∞ëÔºåÂøΩÁï•Âç≥ÂèØ
>  int childState = 0; 
> 
>  // ÈÅçÂéÜÊâÄÊúâÂ≠ê View
>  for (int i = 0; i < count; i++) {
>      final View child = getChildAt(i);
>      // Ëøô‰∏™ mMeasureAllChildren ÊòØ‰∏Ä‰∏™Â±ûÊÄßÔºå‰ΩúÁî®ÔºöÊòØÂê¶ÂøΩÁï• Gone ÁöÑÂΩ±Âìç
>      // child.getVisibility() != GONEÔºöGone Êó∂‰∏çÊµãÈáèÂ≠ê View
>      // Ëøô‰∏™ Gone Êó∂ÂÜçËá™Â∑±ÂÜôËá™ÂÆö‰πâ View Âª∫ËÆÆ‰πüÂà§Êñ≠‰∏ä
>      if (mMeasureAllChildren || child.getVisibility() != GONE) {
>          // measureChildWithMargins() ÈáåÈù¢Ë∞ÉÁî®‰∫ÜÊµãÈáèÂ≠ê View ÁöÑÊñπÊ≥ï
>          // ‰πãÂêé‰ºöÊèêÂà∞ËØ•ÊñπÊ≥ïÔºå‰Ω†Âè™ÈúÄË¶ÅÁü•ÈÅìË∞ÉÁî®ÂêéÂèØ‰ª•ÂæóÂà∞Â≠ê View ÊµãÈáèÁöÑÂÆΩÂíåÈ´ò
>          // ‰ΩÜËøô‰∏™ÂÆΩÂíåÈ´ò‰∏çÊòØ width Âíå heightÔºåËÄåÊòØ measuredWidth Âíå measuredHeight
>          measureChildWithMargins(child, widthMeasureSpec, 0, heightMeasureSpec, 0);
>          // ÂæóÂà∞ LayoutParamsÔºå‰∏ªË¶ÅÊòØ‰ªéÈáåÈù¢ÂèñÂæóÂÆö‰πâÁöÑ Margin ÂÄº
>          final LayoutParams lp = (LayoutParams) child.getLayoutParams();
>          // ‰øùÂ≠òÂ≠ê View ‰∏≠ÊúÄÂ§ßÁöÑÂÆΩÂ∫¶
>          maxWidth = Math.max(maxWidth,
>                  child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin);
>          // ‰øùÂ≠òÂ≠ê View ‰∏≠ÊúÄÂ§ßÁöÑÈ´òÂ∫¶
>          maxHeight = Math.max(maxHeight,
>                  child.getMeasuredHeight() + lp.topMargin + lp.bottomMargin);
>          // Áä∂ÊÄÅÂÄºÔºåÂøΩÁï•Âç≥ÂèØÔºåÂú® ViewRootImpl ‰∏≠Êúâ‰ΩøÁî®Ôºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãËá™ÂÆö‰πâ View ‰∏çÁî®
>          childState = combineMeasuredStates(childState, child.getMeasuredState());
>          // ÊúÄÂºÄÂßãÁöÑÈÇ£‰∏™ boolean ÂÄºÔºåÁî®Êù•‰øùÂ≠òÊòØ match_parent ÁöÑ View
>          if (measureMatchParentChildren) {
>              if (lp.width == LayoutParams.MATCH_PARENT ||
>                      lp.height == LayoutParams.MATCH_PARENT) {
>                  mMatchParentChildren.add(child);
>              }
>          }
>      }
>  }
> 
>  // ÊúÄÂ§ßÂÄºÂä†‰∏ä padding ÂÄº
>  // getPadding*WithForeground() ÊòØÂÜÖÈÉ®ÊñπÊ≥ïÔºåÊàë‰ª¨Ëá™Â∑±Áî®Êó∂ÊòØ‰ΩøÁî® getPadding*() ‰ª£Êõø
>  maxWidth += getPaddingLeftWithForeground() + getPaddingRightWithForeground();
>  maxHeight += getPaddingTopWithForeground() + getPaddingBottomWithForeground();
> 
>  // Ê£ÄÊü•ÊúÄÂ∞èÂÄºÁöÑËÆæÁΩÆ
>  // View ÈÉΩËá™Â∏¶‰∫Ü‰∏Ä‰∏™ android:minHeight Â±ûÊÄßÔºåËá™Â∑±Ëá™ÂÆö‰πâ View Êó∂Âª∫ËÆÆÊääËøô‰∏™ÈÄÇÈÖç‰∏Ä‰∏ã
>  maxHeight = Math.max(maxHeight, getSuggestedMinimumHeight());
>  maxWidth = Math.max(maxWidth, getSuggestedMinimumWidth());
> 
>  // ÂæóÂà∞ÂâçÂè∞ÁöÑËÉåÊôØÂõæÔºåÂÜç‰∏éÊúÄÂ§ßÂÄºÊØîËæÉ
>  final Drawable drawable = getForeground();
>  if (drawable != null) {
>      maxHeight = Math.max(maxHeight, drawable.getMinimumHeight());
>      maxWidth = Math.max(maxWidth, drawable.getMinimumWidth());
>  }
> 
>  // ÂÖ≥ÈîÆÊñπÊ≥ïÔºåË∞ÉÁî® setMeasuredDimension() ËÆæÁΩÆËá™Ë∫´ÂÆΩÂíåÈ´ò
>  setMeasuredDimension(resolveSizeAndState(maxWidth, widthMeasureSpec, childState),
>          resolveSizeAndState(maxHeight, heightMeasureSpec,
>                  childState << MEASURED_HEIGHT_STATE_SHIFT));
> 
>  // Âú®‰∏äÈù¢ÈÇ£‰∏™Ë∞ÉÁî®ËøáÂêéÔºåÂ∞±ËÉΩÂæóÂà∞Ëá™Ë∫´ÁöÑÂÆΩÂíåÈ´ò‰∫Ü
>  // ÁÑ∂ÂêéËøôÈáåÂÜçÈáçÂÜôÊµãÈáè‰∏∫ match_parent ÁöÑ View
>  count = mMatchParentChildren.size();
>  // Ëøô‰∏™ count Âà§Êñ≠Êàë‰∏™‰∫∫ÊÑüËßâÊúâÁÇπÈóÆÈ¢ò
>  // count ÊòØÊåá‰∏∫ match_parent View ÁöÑÊï∞ÈáèÔºå
>  // ËÄåÂ¶ÇÊûúÊàëÂè™Êúâ‰∏Ä‰∏™ View ÊòØ match_parentÔºåÈÇ£ÂÆÉ‰∏çÊòØÂ∞±‰∏ç‰ºöÈáçÊñ∞ÊµãÈáè‰∫ÜÂêóÔºü
>  // ÁúüÂ•áÊÄ™ÔºåÊàëÊÑüËßâËØ•Áî® childCount
>  if (count > 1) {
>      for (int i = 0; i < count; i++) {
>          final View child = mMatchParentChildren.get(i);
>          final MarginLayoutParams lp = (MarginLayoutParams) child.getLayoutParams();
> 
>          final int childWidthMeasureSpec;
>          if (lp.width == LayoutParams.MATCH_PARENT) {
>              final int width = Math.max(0, getMeasuredWidth()
>                         - getPaddingLeftWithForeground() - getPaddingRightWithForeground()
>                         - lp.leftMargin - lp.rightMargin);
>                 childWidthMeasureSpec = MeasureSpec.makeMeasureSpec(
>                         width, MeasureSpec.EXACTLY);
>             } else {
>                 childWidthMeasureSpec = getChildMeasureSpec(widthMeasureSpec,
>                         getPaddingLeftWithForeground() + getPaddingRightWithForeground() +
>                         lp.leftMargin + lp.rightMargin,
>                         lp.width);
>             }
> 
>             final int childHeightMeasureSpec;
>             if (lp.height == LayoutParams.MATCH_PARENT) {
>                 final int height = Math.max(0, getMeasuredHeight()
>                         - getPaddingTopWithForeground() - getPaddingBottomWithForeground()
>                         - lp.topMargin - lp.bottomMargin);
>                 childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(
>                         height, MeasureSpec.EXACTLY);
>             } else {
>                 childHeightMeasureSpec = getChildMeasureSpec(heightMeasureSpec,
>                         getPaddingTopWithForeground() + getPaddingBottomWithForeground() +
>                         lp.topMargin + lp.bottomMargin,
>                         lp.height);
>             }
>             // ËøôÈáåÂèØ‰ª•ÂèëÁé∞ onMeasure() ‰∏çÊ≠¢‰ºöË∞ÉÁî®‰∏ÄÊ¨°ÔºåÊúâÊó∂ÂÄôÈúÄË¶ÅË∞ÉÁî®Â§öÊ¨°ÊâçËÉΩÊµãÈáèÂÆåÊàê 
>             child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
>         }
>     }
> 
> ```
>
> 

##### 2„ÄÅNestedScrollView ÂµåÂ•ó Rv Â§çÁî®Â§±Êïà

> Êé•‰∏ãÊù•ÂºÄÂßãÂÅöÁÅ´ÁÆ≠
>
> Êàë‰ª¨Êù•ÂàÜÊûê‰∏Ä‰∏ãÊàëÂØíÂÅáÊó∂Â§öÊ¨°ÊèêÂà∞ NestedScrollView ÂµåÂ•ó RvÔºåÂØºËá¥ Rv Â§çÁî®Â§±ÊïàÁöÑÈóÆÈ¢òÔºåÁΩë‰∏äÊàëËøòÊ≤°ÊúâÁúãËøáÂæàËØ¶ÁªÜÁöÑ‰ªéÊ∫êÁ†ÅËßíÂ∫¶Êù•ÂàÜÊûêÁöÑÊñáÁ´†
>
> È¶ñÂÖàÊàë‰ª¨Ë¶ÅÊÉ≥ÊÉ≥ÈóÆ‰ªÄ‰πà‰ºöÂ§±ÊïàÔºü
>
> Â§±ÊïàËØ¥Êòé Rv ÊääÂÖ®ÈÉ®Â≠ê View ÈÉΩÊµãÈáèÂÆå‰∫ÜÔºåÈÇ£ËØ¥ÊòéËÇØÂÆöÊòØ `onMeasure()` ÁöÑÈóÆÈ¢òÔºåokÔºåÈÇ£Êàë‰ª¨Êù• debug ‰∏Ä‰∏ã `onMeasure()` ÁöÑÊï¥‰∏™ÊµÅÁ®ã
>
> ##### È¶ñÂÖà‰ªé NestedScrollView ÁöÑ onMeasure() ÂºÄÂßã debug
>
> > ![image-20220321225743926](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321225743926.png)
> >
> > ÂèØ‰ª•ÂèëÁé∞ NestedScrollView ÊääÊµãÈáèÁõ¥Êé•‰∫§Áªô‰∫ÜÁà∂Á±ª FrameLayout Â§ÑÁêÜÔºåÔºà‰Ω†ÂèØËÉΩ‰ºöÁñëÊÉëÔºå‰∏çÈáçÂÜô `onMeasure()` ÈÇ£ NestedScrollView ÊòØÊÄé‰πàÂÆûÁé∞‰∏çÂêå‰∫éÂÖ∂‰ªñ View ÊµãÈáèÁöÑÔºüËøô‰∏™ÈóÆÈ¢òÂú®‰∏ãÈù¢‰ºöËÆ≤Ëß£Ôºâ
> >
> > ÂèàÁî±‰∫é `mFillViewport` ‰∏∫ `false`ÔºåÂ∞±Áõ¥Êé• return ‰∫ÜÔºåËá≥‰∫é `mFillViewport` ÊòØ‰ªÄ‰πàÊàë‰ª¨ÂêéÈù¢‰ºöËÆ≤Ëß£
>
> ##### Êù•Âà∞ FrameLayout ÁöÑ onMeasure() ÂÆûÁé∞
>
> > ![image-20220321230004519](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321230004519.png)
> >
> > ËøôÈáåÂè™Êúâ‰∏Ä‰∏™ ViewÔºåÂ∞±ÊòØ RvÔºåÁÑ∂Âêé FrameLayout Ë∞ÉÁî®‰∫Ü `measureChildWithMargins(child, widthMeasureSpec, 0, heightMeasureSpec, 0)`ÔºåËøô‰∏™ÂáΩÊï∞Ë¢´ NestedScrollView ÈáçÂÜô‰∫ÜÔºåÁÑ∂ÂêéÁªôÂá∫‰∫Ü‰∏Ä‰∏™ `MeasureSpec.UNSPECIFIED`ÔºåËøôÂ∞±ÊòØ NestedScrollView ‰∏çÂêå‰∫éÂÖ∂‰ªñ View ÊµãÈáèÁöÑÂéüÂõ†
> >
> > ![image-20220321230432739](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321230432739.png)
> >
> > ‰ªîÁªÜÁúãÁ∫¢Á∫øÂ§ÑÔºåËøôÈáåÂÆÉÁªôÂá∫ÁöÑÈ´òÂ∫¶Á´üÁÑ∂Áõ¥Êé•‰∏∫ `lp.topMargin + lp.bottomMargin`ÔºåÂèØËÉΩ‰Ω†‰∏ç‰ºöÊÑèËØÜÂà∞Ëøô‰∏™Êúâ‰ªÄ‰πàÈóÆÈ¢òÔºåÊàë‰ª¨Êù•ÁúãÁúã NestedScrollView ÁöÑÂ≠™ÁîüÂÖÑÂºü ScrollView ÂØπ‰∫éËØ•ÊñπÊ≥ïÁöÑÂÆûÁé∞
> >
> > ![image-20220321230936516](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321230936516.png)
> >
> > ÂèëÁé∞‰∏çÂêå‰∫ÜÂêóÔºåScrollView Êúâ‰∏™ `parentHeightMeasureSpec` ÁöÑÈ´òÂ∫¶ÔºåËÄå NestedScrollView Âè™‰ΩøÁî®‰∫Ü `lp.topMargin + lp.bottomMargin`ÔºåÂ¶ÇÊûúÂ≠ê View Ê≤°Âæó margin ÂÄºÔºåÈÇ£‰∏çÂ∞±Áõ¥Êé•ÁªôÂ≠ê View ‰º†ÂÖ•ÁöÑÈ´òÂ∫¶‰∏∫ 0 ‰∫ÜÔºü
> >
> > NestedScrollView ‰∏é ScrollView Âú®Ëøô‰∏™ÊñπÊ≥ï‰∏äÁöÑ‰∏çÂêåÔºåÂ∞±ÊòØÈÄ†Êàê Rv Â§çÁî®Â§±ÊïàÁöÑÁõ¥Êé•ÂéüÂõ†ÔºåÊé•‰∏ãÊù•Êàë‰ª¨Êé¢Á©∂‰∏Ä‰∏ãÊ†πÊú¨ÂéüÂõ†
>
> ##### Êù•Âà∞ Rv ÁöÑ onMeasure
>
> > Á¥ßÊé•ÁùÄ‰∏äÈù¢ÁªßÁª≠ debugÔºåÊàë‰ª¨Êù•Âà∞‰∫Ü Rv ÁöÑ `onMeasure()` ÂÆûÁé∞
> >
> > ![image-20220321231555746](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321231555746.png)
> >
> > ÂèØ‰ª•ÂèëÁé∞ËøôÈáå `heightSpec` ‰∏∫ 0
>
> ##### Êù•Âà∞ dispatchLayoutStep2() ÊñπÊ≥ï
>
> > ![image-20220321231735164](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321231735164.png)
> >
> > ÂâçÈù¢ÈÇ£‰∏™ `dispatchLayoutStrp1()` Âõ†‰∏∫‰∏çÂ§Ñ‰∫é `State.STEP_START` ËÄåË∑≥Ëøá‰∫Ü
>
> ##### ÂèëÁé∞ mLayout.onLayoutChildren()
>
> > ![image-20220321232502431](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321232502431.png)
> >
> > Êï¥‰∏™ `dispatchLayoutChild2()` ‰∏ÄÁúãÂ∞±Âè™ÊúâËøô‰∏™ÊñπÊ≥ïÊòØÁî®‰∫éÂ∏ÉÂ±ÄÁöÑÔºådebug ËøõÂéªËØïËØï
>
> ##### Êé¢Á¥¢ onLayoutChild() ÊñπÊ≥ï
>
> > ![image-20220321233030377](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321233030377.png)
> >
> > ÂâçÈù¢Êúâ‰∏ÄÂ†ÜÊñπÊ≥ïÔºå‰ΩÜÂÖ∂ÂÆû Rv ÊòØË∞ÉÁî®Ëøô‰∏™ `fill()` Êù•ÁªôÂ≠ê View Â∏ÉÂ±ÄÁöÑ
>
> ##### Êé¢Á¥¢ fill()
>
> > ![image-20220321233713916](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321233713916.png)
> >
> > Ëøô‰∏™ while ÂæàÈáçË¶ÅÔºåÂ∞±ÊòØ‰æùÈù†Ëøô‰∏™Âæ™ÁéØÊù•ÊµãÈáèÂ≠ê View ÁöÑÔºåËôΩÁÑ∂‰Ω†Â∫îËØ•ÁúãÁöÑÂæàÊáµÈÄºÔºå‰ΩÜËØ∑ËÆ∞‰ΩèËøô‰∏§‰∏™‰∏úË•øÔºö
> >
> > `layoutState.mInfinite = true` Âíå `remainingSpace = 0`ÔºåÂêéÈù¢ÁöÑ `layoutState.hasMore(state)` ÊòØÁî®‰∫éÂà§Êñ≠Ê¨°Êï∞ÊòØÂê¶ËææÂà∞ ItemCount ÁöÑÔºåÂèØ‰ª•‰∏çÁî®ÁÆ°
> >
> > ËøôÈáåÂ∞±Áõ¥Êé•ÂëäËØâ‰Ω†ÁªìËÆ∫ÔºåÂ∞±ÊòØÂõ†‰∏∫Ëøô‰∏™ `layoutState.mInfinite = true` ÂØºËá¥ÂÆÉ‰∏ÄÁõ¥ÊâßË°åÂæ™ÁéØÔºåÁÑ∂Âêé‰∏ÄÁõ¥Âà∞ `layoutState.hasMore(state) = false` ÊâçÁªìÊùüÔºåÂç≥Êää ItemCount ‰∏™ item ÈÉΩÊµãÈáèÂÆå‰∫Ü
> >
> > ÂæàÊáµÈÄºÊòØ‰∏çÊòØÔºåÊàë‰ª¨Êù•ÁúãÁúãÂ¶ÇÊûú‰ΩøÁî® ScrollView ÂåÖË£πËøêË°åÂà∞ËøôÈáåÊó∂‰ºöÊÄé‰πàÊ†∑Ôºü
> >
> > ![image-20220321234733578](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321234733578.png)
> >
> > ÁúãÂà∞Âå∫Âà´‰∫ÜÂêßÔºå‰ΩøÁî® ScrollView Êó∂‰ºö‰∏ç‰∏ÄÊ†∑ÔºåÂÖ∂‰∏≠ `layoutState.mInfinite = false` Âíå `remainingSpace = 1868` 
> >
> > Â¶ÇÊûú‰ΩøÁî® ScrollView ÁªßÁª≠ÂæÄ‰∏ãËµ∞
> >
> > ![image-20220321234928364](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321234928364.png)
> >
> > ‰ªñ‰ºöÂú®Ëøô‰∏™Âú∞ÊñπÂáèÂ∞ë `remainingSpace` ÁöÑÂÄºÔºåÊúÄÂêéÂ∞±ÂèØ‰ª•‰Ωø while Âæ™ÁéØÊèêÂâçÈÄÄÂá∫‰∫Ü
>
> OKÔºåÂü∫Êú¨‰∏äÊ†πÊú¨ÂéüÂõ†ÊâæÂà∞‰∫ÜÔºå‰ΩÜ‰∏∫‰ªÄ‰πàÈÇ£‰∏™ `layoutState.mInfinite = true` ‰∏î `remainingSpace = 0` Âë¢Ôºü
>
> ÁªßÁª≠ÂàÜÊûê
>
> ##### ‰∏∫‰ªÄ‰πà layoutState.mInfinite = true ?
>
> > ![image-20220321235408579](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321235408579.png)
> >
> > ÁÇπÂáª `layoutState.mInfinite`ÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ `mLayoutState.mInfinite` Âú®ËøôÈáåË¢´ËµãÂÄº
> >
> > ÁÇπËøõÂéªÁúãÁúãÂÆÉËµãÁöÑ‰ªÄ‰πàÂÄº
> >
> > ![image-20220321235709470](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321235709470.png)
> >
> > Á¨¨‰∏Ä‰∏™ `getMode() == View.MeasureSpec.UNSPECIFIED` ËÇØÂÆöÊòØ `true`ÔºåÂõ†‰∏∫Â§ñÂ∏ÉÂ±ÄÊòØ NestedScrollView ÂòõÔºåÂâçÈù¢ÊèêÂà∞‰∫ÜÂÆÉÈáçÂÜô‰∫Ü FrameLayout ÁöÑ `measureChildWithMargins()` ÊñπÊ≥ïÔºåÁªôÁöÑÂ≠ê View ÁöÑÊµãÈáèÊ®°ÂºèÊòØ `MeasureSpec.UNSPECIFIED` ÔºåÁ¨¨‰∫å‰∏™Âà§Êñ≠ `mOrientationHelper.getEnd() == 0`ÔºåÊ†πÊçÆ debug ÂèØ‰ª•ÂæóÂà∞ÂÄº‰πü‰∏∫ `true`
> >
> > ÁªßÁª≠Ë∑üË∏™ `mOrientationHelper.getEnd() == 0` ÁöÑÂéüÂõ†
> >
> > ![image-20220322000124439](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322000124439.png)
> >
> > ÂèØ‰ª•ÂèëÁé∞ÂÆÉÁõ¥Êé•Ë∞ÉÁî®‰∫Ü `mLayoutManger.getHeight()`ÔºåÁªßÁª≠
> >
> > ![image-20220322000411111](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322000411111.png)
> >
> > `mHeight` Ë¢´‰øÆÊîπÁöÑÂú∞ÊñπÂ¶Ç‰∏ã
> >
> > ![image-20220322000630000](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322000630000.png)
> >
> > ÂÖ∂‰∏≠ÂâçÈù¢‰∏§‰∏™ÊòØ `setRecyclerView()` ÊòØÂú® Rv Ê∑ªÂä† Adapter Êó∂ËÆæÁΩÆÁöÑÂàùÂßãÂÄºÔºåËÇØÂÆö‰∏çÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑÂú∞ÊñπÔºåÈÇ£Âè™ËÉΩÊòØ `setMeasureSpecs()` ‰∫Ü
> >
> > ![image-20220322000826091](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322000826091.png)
> >
> > ËøôÈáåÊúâ‰∏Ä‰∏™ `mHeight = 0` ÁöÑÊìç‰ΩúÔºåÁÇπÂáªÊñπÊ≥ïÂêçÁß∞ÁúãÁúãÊòØË∞ÅË∞ÉÁî®‰∫ÜÂÆÉ
> >
> > ![image-20220322000941813](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322000941813.png)
> >
> > ËøêÊ∞îÁúüÂ•ΩÔºåÂàöÂ•ΩÂõûÂà∞‰∫ÜÊàë‰ª¨‰πãÂâçÂ§ßÁöÑÊñ≠ÁÇπÂâçÔºåÈÇ£Âè™ËÉΩËØ¥ÊòéÂ∞±ÊòØÂú®ËøôÈáåË∞ÉÁî®ÁöÑÔºåÊâÄ‰ª• `mHeight = 0`ÔºåÂØºËá¥ÂâçÈù¢ÁöÑ `mOrientationHelper.getEnd() == 0` ‰∏∫ `true`ÔºåÊúÄÂêéÂØºËá¥ `layoutState.mInfinite` ‰∏∫ `true` ‰∫Ü 
>
> ##### ‰∏∫‰ªÄ‰πà remainingSpace = 0Ôºü
>
> > Â¶ÇÊûú‰Ω†Â§ßËÉÜÁåúÊµãÁöÑËØùÔºåÂ∫îËØ•ËÉΩÁåúÂà∞ËÇØÂÆö‰∏é `mHeight` ÊúâÂÖ≥Á≥ª
> >
> > ÂÖàÊù•Âà∞ËøôÈáå
> >
> > ![image-20220322001506870](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322001506870.png)
> >
> > Êàë‰ª¨ÂèØ‰ª•Áü•ÈÅì `remainingSpace` Áî± `layoutState.mAvailable + layoutState.mExtraFillSpace` ÁªÑÊàêÔºåÂÖ∂‰∏≠ÈÄöËøáÊü•ÁúãÊ≥®ÈáäÂèØ‰ª•Áü•ÈÅìË∑ü `layoutState.mExtraFillSpace` Ê≤°ÊúâÂÖ≥Á≥ªÔºåÈÇ£Â∞±ÂéªÂØªÊâæ `layoutState.mAvailable` Âêß
> >
> > ÂèØÊòØ `layoutState.mAvailable` Ë¢´ÊîπÂèòÁöÑÂú∞ÊñπÊúâÁÇπÂ§öÔºå‰∏çÊòØÂæàÂ•ΩÂÆö‰ΩçÔºåÈÇ£Êàë‰ª¨ÂèØ‰ª•ËØïËØïÁªôËøô‰∏™ÂèòÈáèÊâì‰∏äÊñ≠ÁÇπÔºåÈáçÊñ∞Ëµ∞‰∏Ä‰∏ãÊµÅÁ®ãÔºåÊé•‰∏ãÊù•Â∞±ÊòØÈáçÊñ∞ debug ‰∏ÄÈÅç
> >
> > ![image-20220322002054498](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322002054498.png)
> >
> > ‰∏Ä‰∏ãÂ≠êÂ∞±ÊâæÂà∞‰∫ÜÔºå‰∏çÂæó‰∏çËØ¥ debug Á°ÆÂÆûÂæàÊñπ‰æø
> >
> > ÁÇπÂáªÂéªÁúã‰∏Ä‰∏ã `mOrientationHelper.getEndAfterPadding()` ÊñπÊ≥ï
> >
> > ![image-20220322002252433](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322002252433.png)
> >
> > ÊûúÁÑ∂ÔºåË∑üÊúÄÂºÄÂßãÁöÑÁåúÊµã‰∏ÄÊ†∑ÔºåÂÆÉ‰∏é `mHeight` ÊúâÂÖ≥Á≥ª
> >
> > ÈÇ£ `updateLayoutStateToFillEnd()` ÊòØÂú®‰ªÄ‰πàÊó∂ÂÄôË∞ÉÁî®ÁöÑÂë¢Ôºü
> >
> > ![image-20220322002424079](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322002424079.png)
> >
> > ‰ªéË∞ÉÁî®Ê†àÂèëÁé∞ÂéüÊù•‰ªñÂú® `fill()` ÊñπÊ≥ïÂâçË¢´Ë∞ÉÁî®‰∫Ü
> >
> > OKÔºåËøô‰∏ãÂ≠ê NestedScrollView ÂµåÂ•ó Rv ‰ΩøÂ§çÁî®Â§±ÊïàÁöÑÊ†πÊú¨ÂéüÂõ†ÂíåÂÜ≥ÂÆöÊÄßÂõ†Á¥†ÈÉΩÊâæÂà∞‰∫Ü
>
> ### Â¶Ç‰ΩïËß£ÂÜ≥Â§çÁî®Â§±ÊïàÈóÆÈ¢òÔºü
>
> Ê†πÊçÆ‰∏äÈù¢ÁöÑÊµÅÁ®ãÔºåÊàë‰ª¨ÂèØ‰ª•ÊâæÂà∞‰∏ãÈù¢ËøôÂá†ÁßçÊñπÊ≥ïÔºö
>
> ##### 1„ÄÅÈáçÂÜô NestedScrollView ÁöÑ `measureChildWithMargins()` ÊñπÊ≥ï
>
> > ```kotlin
> > /**
> >  * ÈáçÂÜôËØ•ÊñπÊ≥ïÁöÑÂá†‰∏™ÂéüÂõ†Ôºö
> >  * 1„ÄÅ‰∏∫‰∫ÜÂú® UNSPECIFIED Ê®°Âºè‰∏ãÔºåRv ‰πüËÉΩÂæóÂà∞ NestedScrollView ÁöÑÈ´òÂ∫¶
> >  * 2„ÄÅNestedScrollView ‰∏é ScrollView Âú®ÂØπ‰∫éÂ≠ê View È´òÂ∫¶Â§ÑÁêÜÊó∂Âú®‰∏ãÈù¢Ëøô‰∏™ÊñπÊ≥ï‰∏ç‰∏ÄÊ†∑, ÂØºËá¥
> >  *    NestedScrollView ‰∏≠Â≠ê View ÂøÖÈ°ª‰ΩøÁî®ÂÖ∑‰ΩìÁöÑÈ´òÂ∫¶, ËÆæÁΩÆÊàê wrap_content Êàñ match_parent
> >  *    ÈÉΩÂ∞ÜÊó†ÊïàÔºåÂÖ∑‰ΩìÁöÑÂèØ‰ª•ÂéªÁúã ScrollView Âíå NestedScrollView ‰∏≠ÂØπ‰∫éËøôÂêå‰∏ÄÊñπÊ≥ïÁöÑÊ∫êÁ†Å
> >  * 3„ÄÅÂú® NestedScrollView ‰∏≠ÂµåÂ•ó RecyclerView ‰ºö‰Ωø RecyclerView ÁöÑÊáíÂä†ËΩΩÂ§±ÊïàÔºåÁõ¥Êé•ÂéüÂõ†Â∞±‰∏é
> >  *    Ëøô‰∏™ÊñπÊ≥ïÊúâÂÖ≥ÔºåËÄå‰ΩøÁî® ScrollView Â∞±‰∏ç‰ºöÈÄ†ÊàêÊáíÂä†ËΩΩÂ§±ÊïàÁöÑÊÉÖÂÜµ
> >  * 4„ÄÅËá≥‰∫é‰∏∫‰ªÄ‰πà NestedScrollView ‰∏é ScrollView Âú®ËØ•ÊñπÊ≥ï‰∏çÂêåÔºåÊàëÁåúÊµãÂéüÂõ†ÊòØ‰∏∫‰∫ÜÂÖºÂÆπ‰ª•ÂâçÁöÑ Android ÁâàÊú¨Ôºå
> >  *    Âú® ViewGroup#getChildMeasureSpec() ÊñπÊ≥ï‰∏≠ÂèØ‰ª•ÂèëÁé∞‰ΩøÁî®‰∫Ü
> >  *    ‰∏Ä‰∏™ÈùôÊÄÅÂèòÈáè sUseZeroUnspecifiedMeasureSpec
> >  *    Êù•Âà§Êñ≠ UNSPECIFIED Ê®°Âºè‰∏ãÂ≠ê View ËØ•ÂæóÂà∞ÁöÑÂ§ßÂ∞èÔºå‰ΩÜÂèØËÉΩËÆæËÆ° NestedScrollView ‚ÄúÂÅ∑Êáí‚Äù‰∫ÜÔºå
> >  *    Ê≤°ÊúâÂä†Ëøô‰∏™‰∏úË•øÔºåÂÖ∑‰ΩìÂéüÂõ†‰∏çÁü•
> >  */
> > override fun measureChildWithMargins(
> >     child: View,
> >     parentWidthMeasureSpec: Int,
> >     widthUsed: Int,
> >     parentHeightMeasureSpec: Int,
> >     heightUsed: Int
> > ) {
> >     val lp = child.layoutParams as MarginLayoutParams
> > 
> >     val childWidthMeasureSpec = getChildMeasureSpec(
> >         parentWidthMeasureSpec,
> >         paddingLeft + paddingRight + lp.leftMargin + lp.rightMargin
> >                 + widthUsed, lp.width
> >     )
> >     // ËøôÈáåÁöÑÂÜôÊ≥ï‰∏é ScrollView ÈáåÈù¢ÁöÑ‰∏ÄÊ†∑
> >     val usedTotal = paddingTop + paddingBottom + lp.topMargin + lp.bottomMargin + heightUsed
> >     val childHeightMeasureSpec: Int = MeasureSpec.makeMeasureSpec(
> >         max(0, MeasureSpec.getSize(parentHeightMeasureSpec) - usedTotal),
> >         MeasureSpec.UNSPECIFIED
> >     )
> > 
> >     child.measure(childWidthMeasureSpec, childHeightMeasureSpec)
> > }
> > ```
>
> ##### 2„ÄÅÁõ¥Êé•Áªô Rv ËÆæÁΩÆÂõ∫ÂÆöÈ´òÂ∫¶
>
> > Ëøô‰∏™ÊñπÊ≥ïÂ∞±ÂèØ‰ª•Áõ¥Êé•‰øÆÊîπ `mHeight` ÁöÑÂÄºÔºå‰ªé‰πãÂâçÁöÑÂàÜÊûê‰∏≠ÂèØ‰ª•ÂæóÂà∞`layoutState.mInfinite` Âíå `remainingSpace` ÈÉΩ‰∏é `mHeight` ÊúâÂÖ≥ÔºåÊâÄ‰ª•‰øÆÊîπ `mHeight` Â∞±ÂèØ‰ª•‰ªéÊ†πÊ∫ê‰∏äËß£ÂÜ≥Â§çÁî®Â§±ÊïàÈóÆÈ¢ò
>
> ##### 3„ÄÅ‰ΩøÁî® mFillViewport Â±ûÊÄßÔºå‰ΩÜÈúÄË¶Å NsetedScrollView ÁöÑ layout_height = match_parent Êàñ Á°ÆÂÆöÂÄº
>
> > ÂâçÈù¢Âú® `onMeasure()` ÊèêÂà∞‰∫Ü‰∏Ä‰∏™ `mFillViewport` ÂèòÈáè
> >
> > ËøôÊòØÂÆÉÁöÑÂÆòÊñπËß£ÈáäÔºö
> >
> > > ËÆæÁΩÆÊ≠§ ScrollView ÊòØÂê¶Â∫îÊãâ‰º∏ÂÖ∂ÂÜÖÂÆπÈ´òÂ∫¶‰ª•Â°´ÂÖÖËßÜÂè£
> >
> > ÂÆÉÂØπÂ∫îËøô‰∏™Â±ûÊÄßÔºö
> >
> > ![image-20220322003418726](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322003418726.png)
> >
> > ‰ΩÜÂÜçÊ¨°‰πãÂâçÊàë‰ª¨ÂÖàÁúã‰∏Ä‰∏ãÔºåËÆæÁΩÆ‰∏∫ `true` Âêé `onMeasure()` Âπ≤‰∫Ü‰∫õ‰ªÄ‰πà‰∏úË•ø
> >
> > ```java
> > @Override
> > protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
> >     super.onMeasure(widthMeasureSpec, heightMeasureSpec);
> >     // mFillViewport ‰∏∫ true ‰∏ç‰ºöË¢´ return ‰∫Ü
> >     if (!mFillViewport) {
> >         return;
> >     }
> > 
> >     final int heightMode = MeasureSpec.getMode(heightMeasureSpec);
> >     if (heightMode == MeasureSpec.UNSPECIFIED) {
> >         return;
> >     }
> > 
> >     if (getChildCount() > 0) {
> >         View child = getChildAt(0);
> >         final NestedScrollView.LayoutParams lp = (LayoutParams) child.getLayoutParams();
> > 
> >         int childSize = child.getMeasuredHeight();
> >         
> >         // ÂÖ≥ÈîÆÂú®‰∫éËøôÈáåÔºåÂæóÂà∞Ëá™Ë∫´ÁöÑÊµãÈáèÈ´òÂ∫¶
> >         // Ëøô‰∏™ÊµãÈáèÈ´òÂ∫¶ÊòØ‰πãÂâçË∞ÉÁî® super.onMeasure() ËÄåËÆæÁΩÆÁöÑ
> >         int parentSpace = getMeasuredHeight()
> >                 - getPaddingTop()
> >                 - getPaddingBottom()
> >                 - lp.topMargin
> >                 - lp.bottomMargin;
> > 
> >         if (childSize < parentSpace) {
> >             int childWidthMeasureSpec = getChildMeasureSpec(widthMeasureSpec,
> >                     getPaddingLeft() + getPaddingRight() + lp.leftMargin + lp.rightMargin,
> >                     lp.width);
> >             // ÁªôÂ≠ê View ÁöÑÊµãÈáèÊ®°Âºè‰ΩøÁî®‰∫Ü MeasureSpec.EXACTLY
> >             int childHeightMeasureSpec =
> >                     MeasureSpec.makeMeasureSpec(parentSpace, MeasureSpec.EXACTLY);
> >             child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
> >         }
> >     }
> > }
> > ```
> >
> > ‰ªé‰∏äÈù¢‰ª£Á†ÅÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÔºåËÆæÁΩÆ `mFillViewport = true` Âêé NestedScrollView ‰ºö‰ΩøÁî® `MeasureSpec.EXACTLY` Ê®°ÂºèÂÜçÊ¨°ÊµãÈáèÂ≠ê ViewÔºåÈ´òÂ∫¶‰ΩøÁî®ÁöÑÊòØËá™Ë∫´ÁöÑÈ´òÂ∫¶
> >
> > ËÄåËá™Ë∫´ÁöÑÈ´òÂ∫¶Âè™ÊúâÂú® `match_parent` ÊàñËÄÖ Á°ÆÂÆöÂÄº Êó∂ÊâçÊúâÁî®Ôºå‰∏çÁÑ∂ÔºåÂ¶ÇÊûú‰Ω†ÁöÑ `layout_height` ‰∏∫ `wrap_content`ÔºåÈÇ£ `NestedScrollView#getMeasuredHeight()` ÂæóÂà∞‰ªçÁÑ∂ÊòØ Rv ÂÖ®ÈÉ®ÊµãÈáèÊó∂ÁöÑÈ´òÂ∫¶ÔºåÊâÄ‰ª•ËøôÊó∂ÂÜçÊµãÈáèËøòÊòØ‰ºöÂØºËá¥ Rv Â§çÁî®Â§±Êïà
> >
> > ‰ΩøÁî® mFillViewport Â±ûÊÄßÔºå‰ΩÜÈúÄË¶Å NsetedScrollView ÁöÑ **layout_height = match_parent Êàñ Á°ÆÂÆöÂÄº**
> >
> > ‰ΩÜ‰∏ÄËà¨ÈÉΩ‰∏ç‰ºö‰ΩøÁî®Âà∞Ëøô‰∏™Â±ûÊÄßÊù•Ëß£ÂÜ≥ Rv Â§çÁî®Â§±ÊïàÈóÆÈ¢òÔºåËøôÈáåÂè™ÊòØÂΩì‰∏™Êâ©Â±ïÊù•ËÆ≤Ëß£
>
> ##### ÈóÆÈ¢òÔºöÂ¶ÇÊûúÁªô Rv Â§ñÈù¢ÂÜçÂåÖ‰∏ÄÂ±ÇÔºåÈÇ£Â§çÁî®Ëøò‰ºöÂ§±ÊïàÂêóÔºü
>
> > Á≠îÊ°àÔºö‰ªçÁÑ∂‰ºöÂ§±Êïà
> >
> > È¶ñÂÖàÔºåÊàë‰ª¨Áü•ÈÅìÂ§±ÊïàÁöÑÂÜ≥ÂÆöÂõ†Á¥†ÊòØ `mHeight == 0 && mode == MeasureSpec.UNSPECIFIED`ÔºåËÄå NestedScrollView Âú®Â≠ê View Ê≤°ÊúâËÆæÁΩÆ Margin ÂÄºÊó∂ÁªôÂ≠ê View ‰º†ÂÖ•ÁöÑÈ´òÂ∫¶ËÇØÂÆöÊòØ 0
> >
> > ![image-20220321230936516](https://gitee.com/guo985892345/typora/raw/master/img/image-20220321230936516.png)
> >
> > ËÄå `MeasureSpec.UNSPECIFIED` ÊµãÈáèÊ®°ÂºèÂÖ∑Êúâ‰º†ÈÄíÊÄßÔºåÂâçÈù¢Êàë‰ª¨ÊèêÂà∞ `getChildMeasureSpec()` ÊñπÊ≥ïÔºà[MeasureSpecs](#2„ÄÅMeasureSpecs)Ôºâ
> >
> > ```java
> > // Â¶ÇÊûúÊµãÈáèÊ®°ÂºèÊòØÂèØ‰ªªÊÑèÂèñÂÄºÔºåÂç≥‰∏ÄËà¨ÂØπÂ∫îÁà∂ View ‰∏∫ ScrollView
> > case MeasureSpec.UNSPECIFIED:
> >     if (childDimension >= 0) {
> >         // ÂÅáËÆæÂ≠ê View Âõ∫ÂÆö‰∏∫ 100dp
> >         resultSize = childDimension;
> >         resultMode = MeasureSpec.EXACTLY;
> >     } else if (childDimension == LayoutParams.MATCH_PARENT) {
> >         // Â≠ê View ÊòØ match_parent
> >         // Ëøô‰∏™ sUseZeroUnspecifiedMeasureSpec ÂèòÈáèÁî®‰∫éÂÖºÂÆπ Android ÊóßÁâàÊú¨
> >         resultSize = View.sUseZeroUnspecifiedMeasureSpec ? 0 : size;
> >         resultMode = MeasureSpec.UNSPECIFIED;
> >     } else if (childDimension == LayoutParams.WRAP_CONTENT) {
> >         // Â≠ê View ÊòØ wrap_content
> >         resultSize = View.sUseZeroUnspecifiedMeasureSpec ? 0 : size;
> >         resultMode = MeasureSpec.UNSPECIFIED;
> >     }
> >     break;
> > ```
> >
> > ÂèØ‰ª•ÁúãÂà∞Èô§‰∫Ü `childDimension >= 0` Â§ñÂÖ∂‰ªñÊÉÖÂÜµÊµãÈáèÊ®°ÂºèÈÉΩÊòØ `MeasureSpec.UNSPECIFIED`ÔºåÊâÄ‰ª•‰Ω†‰∏≠Èó¥Â§π‰∏ÄÂ±ÇÂÖ∂‰ªñÂ∏ÉÂ±ÄÊòØËß£ÂÜ≥‰∏ç‰∫ÜÁöÑ

##### 3„ÄÅDialog Ê†πÂ∏ÉÂ±ÄËÆæÁΩÆÂÆΩÈ´òÂ§±Êïà

> Ëøô‰∏™‰∏úË•ø‰πãÂâçÂú®ÂØíÂÅáÊúüÈó¥ËÆ≤ËøáÔºå‰ΩÜÊâçÂèëÁé∞ÂΩìÊó∂ËÆ≤ÁöÑÊúâ‰∫õÂ∞èÈóÆÈ¢òÔºö
>
> - Âè™Êúâ DialogFragment Êâç‰ºö‰ΩøÂ§ñÂ±ÇÂ∏ÉÂ±ÄÁöÑÊâÄÊúâ `layout_` Â±ûÊÄßÂ§±ÊïàÔºåËÄå Dialog Âàô**‰∏ÄËà¨**‰∏ç‰ºö
>
> ÂÖ∂ÂÆû‰πü‰∏çÊòØ‰∏ÄËà¨‰∏ç‰ºöÔºå‰∏ªË¶ÅÊòØ DialogFragment Âíå Dialog Âú®‰∏Ä‰∏™ÊñπÊ≥ï‰ΩøÁî®‰∏äÁöÑ‰∏çÂêåÔºåÊâÄ‰ª•‰∏∫‰ªÄ‰πàÊàëÊúÄÂºÄÂßãÁªôÈÇ£‰ΩçÂ≠¶ÂºüËÆ≤ÁöÑ<img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220322180055610.png" alt="image-20220322180055610" style="zoom: 50%;" />
>
> ÂéüÊù•ÊòØÊàë‰ª•‰∏∫ dialog ËÉΩËÆæÁΩÆÔºåÈÇ£ DialogFragment ‰πüËÉΩËÆæÁΩÆ‰∫ÜÔºåÂéüÊù• DialogFragment ËÆæÁΩÆÊòØÂ§±ÊïàÁöÑ
>
> ËøôÈáåÁõ¥Êé•ÂÖàËÆ≤ÂéüÂõ†Ôºö
>
> DialogFragment ÊòØ‰ΩøÁî® `setContentView(View view)` Êù•ËÆæÁΩÆÊ†πÂ∏ÉÂ±ÄÁöÑÔºåËÄå Dialog ‰∏ÄËà¨‰ΩøÁî® `setContentView(int id)` Êù•ËÆæÁΩÆÊ†πÂ∏ÉÂ±ÄÔºåËøô‰∏§‰∏™ÊñπÊ≥ïÂú®Â∫ïÂ±ÇÁöÑË∞ÉÁî®‰ºöÊúâ‰∫õ‰∏çÂêå
>
> Êàë‰ª¨Áõ¥Êé•‰ªé DialogFragment ÂºÄÂßã debug
>
> DialogFragment ÊòØ‰∏Ä‰∏™ FragmentÔºåÈáåÈù¢Â§πÂ∏¶‰∫Ü‰∏Ä‰∏™ dialogÔºåÊ†πÊçÆ Fragment Â∏∏ËßÅÁöÑÂÜôÊ≥ïÔºåÂÖàÁªô `onCreateView()` Êâì‰∏ä debug
>
> ![image-20220322175441660](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322175441660.png)
>
> debug ËøõÊù•ÂèëÁé∞‰∏ÄÂ†ÜÊñπÊ≥ïÔºå‰ΩÜÂ¶ÇÊûú‰∏ç‰∫ÜËß£Ëøô‰∫õ‰∏úË•øÁöÑËØùÔºåÁ°ÆÂÆûÂæàÈöæÁü•ÈÅìÂÆÉÊääËøô‰∏™ËøîÂõûÁöÑ View ÊãøÊù•Âπ≤‰∫Ü‰ªÄ‰πàÔºåÂÖ∂ÂÆûÂΩìÊó∂ÊàëÂú®ÁªôÈÇ£‰ΩçÂ≠¶ÂºüÊâæËøô‰∏™ÈóÆÈ¢òÁ≠îÊ°àÁöÑÊó∂ÂÄôÊâæ‰∫ÜÂæà‰πÖÔºåÊúÄÂêéÊòØ‰ªé `View#setLayoutParams()` ÊñπÊ≥ïÂÖ•ÊâãÔºåÂú®‰∏ÄÂ†ÜË∞ÉÁî®Ê†à‰∏≠ÂèëÁé∞‰∫ÜÁ≠îÊ°à„ÄÇËøôÈáå‰∏∫‰∫ÜÁúÅÊó∂Èó¥Â∞±Áõ¥Êé•ÊåâÊ≠£ÂêëÊµÅÁ®ãËÆ≤‰∏ÄÈÅçÂêß
>
> ![image-20220322180533094](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322180533094.png)
>
> ËøôÈáåÂÆÉÊúâ‰∏Ä‰∏™ `LiveData` ÈÄöÁü•ËßÇÂØüËÄÖ
>
> ![image-20220322180809792](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322180809792.png)
>
> DialogFragment ÈáåÈù¢ÂØπÂÆÉËøõË°å‰∫ÜËßÇÂØüÔºåDialogFragment ÊòØÂú® `onAttach()` ÁöÑÊó∂ÂÄôÂºÄÂßãËøõË°åËßÇÂØüÁöÑÔºåÊÄ™‰∏çÂæóÊàëÊåâÊ≠£Â∏∏ÊµÅÁ®ãËµ∞‰∫ÜÂçäÂ§©‰πüÊâæ‰∏çÂà∞ÈóÆÈ¢ò :( 
>
> ËøôÈáåÁöÑËßÇÂØüËÄÖË¢´ÈÄöÁü•Êó∂Ë∞ÉÁî®‰∫Ü `mDialog.setContentView(view)`ÔºåÁÇπÂáªÂÆÉÁªßÁª≠ÂæÄ‰∏ãËµ∞
>
> ![image-20220322190910124](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322190910124.png)
>
> ÂèØ‰ª•ÂèëÁé∞ËøôÈáåÂÆÉÁõ¥Êé•‰º†ÂÖ•‰∫ÜËá™Â∑±ÁöÑ LayoutParamsÔºåËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊâÄÊúâ `layout_` Â±ûÊÄßÂÖ®ÈÉ®Â§±ÊïàÁöÑÂéüÂõ†
>
> ÈÇ£ÊôÆÈÄöÁöÑ dialog ‰∏∫‰ªÄ‰πà‰∏ç‰ºöÂ§±ÊïàÂë¢Ôºü
>
> ‰∏ªË¶ÅÂéüÂõ†ÊòØ dialog ‰∏ÄËà¨ÊòØËøôÊ†∑ÂÜôÁöÑÔºö
>
> ![image-20220322191150701](https://gitee.com/guo985892345/typora/raw/master/img/image-20220322191150701.png)
>
> <img src="https://gitee.com/guo985892345/typora/raw/master/img/image-20220322191527878.png" alt="image-20220322191527878" style="zoom: 50%;" />
>
> ÂèØ‰ª•ÁúãÂà∞ÂÆÉË∞ÉÁî®‰∫Ü
>
> ```java
> mLayoutInflater.inflate(layoutResID, mContentParent);
> ```
>
> ËÄå‰∏çÊòØ‰ΩøÁî®ÁöÑ `setContenView(View view)`
>
> Ëá≥‰∫é `LayoutInflater` ‰ºöÂú®ÂêéÈù¢ËøõË°åËÆ≤Ëß£ÔºåËøôÈáå‰Ω†Âè™ÈúÄË¶ÅÁü•ÈÅìË∞ÉÁî®‰∫ÜËøô‰∏™ÊñπÊ≥ïÂêéÔºåÂÆÉ‰ºöËØªÂèñ xml Êñá‰ª∂ÔºåÂπ∂Êää xml ‰∏≠ÂÜôÁöÑ `layout_` Â±ûÊÄß‰øùÂ≠òÂú®‰∏Ä‰∏™ `LayoutParams` ‰∏≠‰æõÁà∂Â∏ÉÂ±Ä‰ΩøÁî®ÔºåÊâÄ‰ª•ËøôÂ∞±ÊòØ DialogFragment ÁöÑ `layout_` Â±ûÊÄß‰∏ç‰ºöÂ§±ÊïàÁöÑÂéüÂõ†ÔºåÂΩìÁÑ∂ÔºåÂè™ÊòØ‰∏ÄËà¨‰∏ç‰ºöÂ§±ÊïàÔºåÂ¶ÇÊûú‰Ω†ÈùûË¶ÅÂú® dialog ‰∏≠Ë∞ÉÁî® `setContentView(View view)`ÔºåÈÇ£ËÇØÂÆö‰πüÊòØ‰∏ÄÊ†∑‰ºöÂ§±ÊïàÁöÑ
>
> ### Ëß£ÂÜ≥ÊñπÊ°à
>
> ##### 1„ÄÅÂú® DialogFragment ÁöÑÊ†πÂ∏ÉÂ±ÄÂ§ñÈù¢ÂÜçÂåÖ‰∏ÄÂ±Ç FrameLayout
>
> > ËøôÊ†∑ÂåÖ‰∫Ü‰∏ÄÂ±ÇÂêéÂ∞±ÂèØ‰ª•ËÆ©‰Ω†Ëá™Â∑±ÁöÑÂ∏ÉÂ±ÄÁöÑ `layout_` Âú® FrameLayout ‰∏ãÁîüÊïàÔºåFrameLayout ÁöÑ `layout_width`„ÄÅ`layout_height` ‰ªªÊÑèËÆæÁΩÆÈÉΩÂèØ‰ª•ÔºåÂõ†‰∏∫Â§±Êïà‰∫ÜÔºå‰ΩÜÊàëÊõ¥Êé®ËçêËÆæÁΩÆÊàê `wrap_content`ÔºåËøôÊ†∑ÁúãËµ∑Êù•ÈÄªËæëË¶ÅÂ•Ω‰∏ÄÁÇπ
>
> ##### 2„ÄÅÈÄöËøá‰ª£Á†ÅËÆæÁΩÆÂÆΩÂíåÈ´ò
>
> > ÂèØ‰ª•ËÆæÁΩÆÊ†πÂ∏ÉÂ±ÄÁöÑÂÆΩÂíåÈ´ò
> >
> > ```java
> > // Âè™ÊúâÂú® onViewCreated() ÂõûË∞ÉÈáåËÆæÁΩÆÊâçÊúâÊïà
> > override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
> >     super.onViewCreated(view, savedInstanceState)
> >     // density ÊòØ dp / px ÁöÑËΩ¨Êç¢ÁéáÔºåÊØîÂ¶ÇÔºöÊàëÁöÑÊâãÊú∫ËΩ¨Êç¢ÁéáÊòØ 2.75ÔºåÂàô 1dp ÂØπÂ∫î 2.75px
> >     val density = requireContext().resources.displayMetrics.density
> >     val lp = view.layoutParams
> >     lp.width = (density * 400).toInt()
> >     lp.height = (density * 300).toInt()
> >     // ËøôÈáåÂè™ÊòØ‰øÆÊîπ‰∫ÜÂÆΩÂíåÈ´òÔºåÂõ†‰∏∫ View ËøòÊ≤°ÊúâË¢´ÊµãÈáèÂ∏ÉÂ±Ä
> >     // ÊâÄ‰ª•ÂèØ‰ª•‰∏çÁî®Ë∞ÉÁî® view.layoutParams = lp Êù•Âà∑Êñ∞ÔºåÂú®ÂÖ∂‰ªñÂú∞Êñπ‰ΩøÁî®Êó∂ÊòØË¶ÅÈÄöËøáËøôÁßçÊñπÂºèÊâçËÉΩÂà∑Êñ∞ÁöÑÔºÅ
> > }
> > ```
> >
> > ‰πüÂèØ‰ª•ËÆæÁΩÆ window ÁöÑÂÆΩÂíåÈ´ò
> >
> > ```java
> > // Âè™ÊúâÂú® onViewCreated() ÂõûË∞ÉÈáåËÆæÁΩÆÊâçÊúâÊïà
> > override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
> >     super.onViewCreated(view, savedInstanceState)
> >     // density ÊòØ dp / px ÁöÑËΩ¨Êç¢ÁéáÔºåÊØîÂ¶ÇÔºöÊàëÁöÑÊâãÊú∫ËΩ¨Êç¢ÁéáÊòØ 2.75ÔºåÂàô 1dp ÂØπÂ∫î 2.75px
> >     val density = requireContext().resources.displayMetrics.density
> >     dialog?.window?.setLayout(
> >         (density * 400).toInt(),
> >         (density * 300).toInt()
> >     )
> > }
> > ```
> >
> > Ëøô‰∏™ window ÂÖ∂ÂÆûÊòØ Android ÈáåÁöÑ `PhoneWindow`ÔºåÂê¨ÂêçÂ≠óÂ∞±Áü•ÈÅìÊòØ‰∏Ä‰∏™ÁÆ°ÁêÜÊâãÊú∫Á™óÂè£ÁöÑÁ±ªÔºåË∞ÉÁî®Ëøô‰∏™ `setLayout()` ÊúÄÂêé‰ºöÈáçÊñ∞Áªô `DectorView` ËÆæÁΩÆ `LayoutParams`Ôºå`DectorView` ÊòØÊâÄÊúâÁ™óÂè£ÁöÑÊ†πÂ∏ÉÂ±Ä
>
> ‰∏äÈù¢‰∏§ÁßçËß£ÂÜ≥ÊñπÊ≥ïÊàëÊõ¥Êé®Ëçê‰ΩøÁî®Á¨¨‰∏ÄÁßçÔºåÂõ†‰∏∫Âú® xml ‰∏≠ÂÆö‰πâÂ±ûÊÄßÊõ¥Â•Ω‰øÆÊîπÔºå‰∏çÁÑ∂Âú®‰ª£Á†Å‰∏≠‰øÆÊîπÂÆΩÂíåÈ´òÔºå‰ºöÁªô‰ª•ÂêéÁúã‰ª£Á†ÅÁöÑ‰∫∫Â∏¶Êù•ÁñëÊÉë
>
> ##### 
>
> OKÔºå`onMeasure()` Âü∫Êú¨‰∏äÂ∞±ËÆ≤Âà∞ËøôÈáå‰∫Ü
>
> 

### 8„ÄÅonLayout()

> ### ‰ΩúÁî®
>
> Â∏ÉÂ±ÄÂ≠êÊéß‰ª∂
>
> ### Ê∂âÂèäÁü•ËØÜ
>
> - `measureWidth` ‰∏é `meaasureHeigth`
>
> ```kotlin
> /**
> * ‰∏é‰∏äÈù¢ËÆ≤ÁöÑ onDraw() ‰∏ÄÊ†∑Ôºå‰πüÊòØ‰∏Ä‰∏™ÂõûË∞ÉÔºåËØ•ÂõûË∞ÉÁöÑ‰ΩúÁî®ÊòØÁî± requestLayout() Ëß¶Âèë
> * @param changed ‰∏é‰∏äÊ¨°Â∏ÉÂ±ÄÁõ∏ÊØîÔºåÊòØÂê¶ÂèëÁîüÊîπÂèò
> */
> override fun onLayout(                                
>     changed: Boolean,                                 
>     left: Int, top: Int, right: Int, bottom: Int      
> ) {                                                   
>     super.onLayout(changed, left, top, right, bottom) 
> }                                                     
> ```
>
> ### ‰∏ªË¶ÅÁî®Ê≥ï
>
> - ÈÅçÂéÜÂ≠ê ViewÔºåÂÜçË∞ÉÁî® `child.layout()`ÔºåÊëÜÊîæÂ≠ê View
>
> - ‰∏ÄËà¨ÊòØ ViewGroup ÂÆûÁé∞
>
>   ‰πãÂâçÊèêÂà∞‰∫Ü `TextView` ‰Ωú‰∏∫ View Âç¥ÈáçÂÜô‰∫ÜËøô‰∏™ÊñπÊ≥ïÔºåÂÖ∂ÂÆûÂÆÉÊ≤°ÊúâÂπ≤‰ªÄ‰πàÔºå‰∏ªË¶ÅÊòØÈáçÊñ∞ËÆæÁΩÆ‰∫ÜÊñáÂ≠óÁöÑ‰ΩçÁΩÆÂíåÂ§ßÂ∞è
>
>   ‰∏∫‰ªÄ‰πàÈúÄË¶ÅÂú®ËøôÈáåÈáçÂÜôËÆæÁΩÆÂë¢Ôºü
>
>   ÂéüÂõ†Ôºö`onLayout()` ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã**Âè™‰ºöÂõûË∞É‰∏ÄÊ¨°**ÔºåËÄå‰∏îËÉΩÊãøÂà∞ÊúÄÁªàÊòæÁ§∫ÁöÑÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶ÔºåÊâÄ‰ª•Âú®ÊúâÁâπÊÆäÈúÄË¶ÅÊó∂ÂèØ‰ª•Âú®ËøôÈáåÈù¢Êù•ËÆæÁΩÆ‰∏Ä‰∫õ‰∏úË•øÔºåÊØîÂ¶ÇÔºö‰∏Ä‰∫õÁâπÊÆäÁöÑËá™ÂÆö‰πâ ViewGroup ÂßãÁªàÊòØÂõ∫ÂÆöÁöÑÂ§ßÂ∞èÔºåÂàôÂèØ‰ª•‰∏çÁî®ÈáçÂÜô `onMeasure()`ÔºåËÄåÊòØÂú® `onLayout()` ‰∏≠Áõ¥Êé•Â∏ÉÂ±Ä
>
> ```mermaid
> graph LR
> id1("ViewRootImpl ÂºÄÂßãÂ∏ÉÂ±Ä")-->id2
> id2["ViewGroup#layout()"]-->id3
> id3["ViewGroup#onLayout()"]-->id4
> id4["View#layout()"]-->id5("View#onLayout()")
> ```
>
> 

#### 1„ÄÅmeasureWidth (measureHeight) ‰∏é width (height)

> `measureWidth` ‰ª£Ë°®ÊµãÈáèÁöÑÂÆΩÂ∫¶ÔºåÂÖ∂ÂÆûÂ∞±ÊòØ `onMeasure()` ‰∏≠Ë∞ÉÁî® `setMeasuredDimension()` ËÆæÁΩÆÁöÑÂÆΩÂ∫¶
>
> `width` ‰ª£Ë°®Â∏ÉÂ±ÄÂêéÁöÑÂÆΩÂ∫¶ÔºåÊòØÁî± `layout()` ‰∏≠ÊëÜÊîæÂêéÈÄöËøá `right - left` ÂæóÂà∞ÁöÑ
>
> ‰∏ÄËà¨ `measureWidth` Âè™Áî®‰∫é `layout()` Âíå `onLayout()` ‰∏≠ÔºåÂÖ∂‰ªñÂú∞Êñπ‰∏çÂ∫îËØ•‰ΩøÁî®ÂÆÉ

#### 2„ÄÅFrameLayout ÁöÑ onLayout() Ê∫êÁ†ÅÂàÜÊûê

> ```java
> @Override
> protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
>     layoutChildren(left, top, right, bottom, false /* no force left gravity */);
> }
> void layoutChildren(int left, int top, int right, int bottom, boolean forceLeftGravity) {
>     final int count = getChildCount();
>     // ËÆ°ÁÆóÂ≠ê View ËÉΩÁªòÂà∂ÁöÑËæπÁïå
>     final int parentLeft = getPaddingLeftWithForeground();
>     final int parentRight = right - left - getPaddingRightWithForeground();
>     final int parentTop = getPaddingTopWithForeground();
>     final int parentBottom = bottom - top - getPaddingBottomWithForeground();
>     for (int i = 0; i < count; i++) {
>         final View child = getChildAt(i);
>         // Â≠ê View ‰∏∫ Gone Êó∂‰∏çÂ∏ÉÂ±ÄÔºåÂú®Ëá™Â∑±ËÆæËÆ°Ëá™ÂÆö‰πâ View Êó∂Âª∫ËÆÆ‰πüËøõË°åÂà§Êñ≠
>         if (child.getVisibility() != GONE) {
>             // ÂèñÂá∫Â≠ê View Ë∫´‰∏äÁöÑ LayoutParams
>             final LayoutParams lp = (LayoutParams) child.getLayoutParams();
>             // ÂæóÂà∞‰πãÂâçÊµãÈáèÁöÑÂÆΩÂíåÈ´ò
>             final int width = child.getMeasuredWidth();
>             final int height = child.getMeasuredHeight();
>             int childLeft;
>             int childTop;
>             // ÂâçÈù¢ÊèêÂà∞ÁöÑ FrameLayout#LayoutParams
>             int gravity = lp.gravity;
>             if (gravity == -1) {
>                 gravity = DEFAULT_CHILD_GRAVITY;
>             }
>             final int layoutDirection = getLayoutDirection();
>             final int absoluteGravity = Gravity.getAbsoluteGravity(gravity, layoutDirection);
>             final int verticalGravity = gravity & Gravity.VERTICAL_GRAVITY_MASK;
>             // ‰∏ãÈù¢ÊòØÊ†πÊçÆ‰∏çÂêåÁöÑ gravity Êù•Â∏ÉÂ±ÄÔºåÂ∞±ÊòØ‰∏Ä‰∫õÁÆÄÂçïÁöÑËÆ°ÁÆó
>             switch (absoluteGravity & Gravity.HORIZONTAL_GRAVITY_MASK) {
>                 case Gravity.CENTER_HORIZONTAL:
>                     childLeft = parentLeft + (parentRight - parentLeft - width) / 2 +
>                     lp.leftMargin - lp.rightMargin;
>                     break;
>                 case Gravity.RIGHT:
>                     if (!forceLeftGravity) {
>                         childLeft = parentRight - width - lp.rightMargin;
>                         break;
>                     }
>                 case Gravity.LEFT:
>                 default:
>                     childLeft = parentLeft + lp.leftMargin;
>             }
>             switch (verticalGravity) {
>                 case Gravity.TOP:
>                     childTop = parentTop + lp.topMargin;
>                     break;
>                 case Gravity.CENTER_VERTICAL:
>                     childTop = parentTop + (parentBottom - parentTop - height) / 2 +
>                     lp.topMargin - lp.bottomMargin;
>                     break;
>                 case Gravity.BOTTOM:
>                     childTop = parentBottom - height - lp.bottomMargin;
>                     break;
>                 default:
>                     childTop = parentTop + lp.topMargin;
>             }
>             // ÊúÄÂêéË∞ÉÁî® child.layout()
>             child.layout(childLeft, childTop, childLeft + width, childTop + height);
>         }
>     }
> }
> ```

### 9„ÄÅrequestLayout()

> Ëøô‰∏úË•øË∑üÂâçÈù¢ÁöÑ `invalidate()` ‰∏ÄÊ†∑Ôºå‰Ω†‰ª¨Âè™ÈúÄË¶ÅËÆ∞‰Ωè‰ª•‰∏ãÂá†ÁÇπÔºö
>
> - Ë∞ÉÁî®Âêé‰ºöÂú®‰∏ã‰∏ÄÂ∏ßÂõûË∞É `onMeasure()` Âíå `onMeasure()` ËøõË°åÈáçÊñ∞ÊµãÈáèÂíåÂ∏ÉÂ±Ä
> - Â¶ÇÊûú‰Ω†ÁöÑ View Â§ßÂ∞èÂèëÁîüÊîπÂèòÔºåÂÆÉËøò‰ºöË∞ÉÁî® `onDraw()` ËøõË°åÂà∑Êñ∞
>
> ÊñáÁ´†ÁöÑËØùÔºå‰∏é `invalidate()` ÁöÑ‰∏ÄÊ†∑Ôºöhttps://juejin.cn/post/7017452765672636446
>
> ```mermaid
> graph TB
> id1("View")-->id2
> id2["Ë∞ÉÁî®requestLayout()ÈáçÊñ∞Â∏ÉÂ±Ä"]-->id3
> id3{"parent == null"}--‰∏ç‰∏∫ null-->id4
> id4["ÂëäËØâÁà∂Â∏ÉÂ±ÄÊúâÂ≠êÂ∏ÉÂ±ÄË¶ÅÈáçÂ∏ÉÂ±Ä"]-->id3--‰∏∫ null-->id5
> id5["‰º†ÈÄíÂà∞‰∫Ü ViewRootImpl (‰∏Ä‰∏™ÁÆ°ÁêÜÂ∏ÉÂ±ÄÁöÑÁ±ª)"]-->id6
> id6["ViewRootImpl Ë∞ÉÁî® mChoreographer ÂèëÈÄÅ‰∏Ä‰∏™ post (‰∏Ä‰∏™‰∏ìÈó®ÁõëÂê¨Â±èÂπïÂà∑Êñ∞ÁöÑÁ±ª)"]-.->id7
> id7["Â±èÂπïÂà∑Êñ∞‰∫ÜÔºåÂõûË∞É ViewRootImplÔºåÂºÄÂßãÈáçÊñ∞Ëµ∞ View ÊµãÈáèÂíåÂ∏ÉÂ±ÄÊµÅÁ®ã"]-->id8
> id8("‰ªéÈ°∂ÈÉ®Â∏ÉÂ±ÄÊúÄÂêéÂõûË∞ÉÂà∞ View ÁöÑ onMeasure()„ÄÅonLayout()")-->id9
> id9{"Â¶ÇÊûúÂÆΩÈ´òÊîπÂèò"}--true-->id10("Ë∞ÉÁî® onDraw() ÂõûË∞É")-->id11
> id9--false-->id11("ÁªìÊùü")
> ```
>
> 



### 10„ÄÅsetContentView

> debug Ëµ∞Ëµ∑ÔºåÊúÄÂêéÂèëÁé∞ÂÆÉË∞ÉÁî®‰∫Ü
>
> ![image-20220323223301814](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323223301814.png)
>
> Ê∑ªÂä†Â∏ÉÂ±ÄÁõ¥Êé•‰∫§Áªô‰∫Ü `LayoutInflater` Â§ÑÁêÜÔºåÈÇ£Êàë‰ª¨ËÆ≤Ëß£‰∏Ä‰∏ã `LayoutInflater`

#### 1„ÄÅLayoutInflater

> `LayoutInflater` Êàë‰ª¨Â∏∏Áî®ÁöÑÂ∞±‰∏ãÈù¢Ëøô‰∏™‰∏§‰∏™ÊñπÊ≥ï
>
> ```java
> public View inflate(@LayoutRes int resource, @Nullable ViewGroup root) {
>     // ÂèØ‰ª•ÁúãÂà∞ÂÆÉÁõ¥Êé•Ë∞ÉÁî®‰∫Ü‰∏ãÈù¢ÈÇ£‰∏™‰∏â‰∏™ÂèÇÊï∞ÁöÑ
> 	return inflate(resource, root, root != null);
> }
> 
> /**
>  * @param resource Â∏ÉÂ±Ä id
>  * @param root Áà∂Â∏ÉÂ±Ä
>  * @param attachToRoot ÊòØÂê¶Áõ¥Êé•Ê∑ªÂä†Âà∞Áà∂Â∏ÉÂ±ÄÔºåÂ¶ÇÊûú‰∏∫ trueÔºåÂú®Ëß£ÊûêÂá∫ View Âêé‰ºöÁõ¥Êé•Ê∑ªÂä†Âà∞ root ‰∏≠
>  * @return Â¶ÇÊûú attachToRoot ‰∏∫ trueÔºåËøôËøîÂõû rootÔºåÂ¶ÇÊûú‰∏∫ falseÔºåÂàôËøîÂõû xml ‰∏≠ÁöÑÊ†πÂ∏ÉÂ±Ä
>  */
> public View inflate(@LayoutRes int resource, @Nullable ViewGroup root, boolean attachToRoot) {}
> ```
>
> ÁªßÁª≠ÂæÄÈáåÈù¢Ëµ∞ÔºåÂÖ∂‰∏≠ÊúÄ‰∏ªË¶ÅÁöÑ‰ª£Á†ÅÂú®ËøôÈáåÔºö
>
> ![image-20220323224318637](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323224318637.png)
>
> ‰∏äÈù¢ÈÇ£‰∏™Â∞±ÊòØ‰πãÂâçÁïô‰∏ãÁöÑÈóÆÈ¢òÔºà[LayoutParams](#1„ÄÅLayoutParams)ÔºâÔºåÂú® `root != null` ÈÄöËøá `AttributeSet` ÂæóÂà∞‰Ω†Ëá™Â∑±ÁöÑ `LayoutParmas`ÔºåÁÑ∂ÂêéÂú® `!attchToRoot` Êó∂Ë∞ÉÁî® `setLayoutParams()`ÔºåÈáåÈù¢‰ºöË∞ÉÁî® `requestLayout()`ËøõË°åÈáçÊñ∞Â∏ÉÂ±Ä
>
> ÁªßÁª≠ÂæÄ‰∏ãÈù¢ÁúãÔºö
>
> ![image-20220323230405944](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323230405944.png)
>
> ËøôÈáåÂú® `root != null && attachToRoot` Êó∂Ë∞ÉÁî® `root.addView()`ÔºåËøôÂ∞±ÊòØ‰ΩøÁî® `attachToRoot` ÁöÑÊó∂ÂÄô
>
> ÁÑ∂ÂêéÂú® `addView()` ÈáåÈù¢Â∞±Ë∞ÉÁî®‰∫Ü‰πãÂâçÈáçÂÜôÁöÑÈÇ£‰∏§‰∏™ÊñπÊ≥ïÔºö
>
> ![image-20220323230713647](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323230713647.png)
>
> ËøôÂ∞±ÊòØ `LayoutInflater` ÁöÑÁÆÄÂçïÂàÜÊûê‰∫Ü
>
> ‰πãÂâçÊúâÂ≠¶ÂºüÈóÆÈÅì `LayoutInflater#inflate()` ‰∏é `View#inflate()` ÁöÑÂå∫Âà´ÔºåÊü•ÁúãÊ∫êÁ†Å‰Ω†Â∞±‰ºöÂèëÁé∞ÂÖ∂ÂÆû `View#inflate()` Â∞±ÊòØË∞ÉÁî®ÁöÑ `LayoutInflater#inflate()`
>
> ![image-20220323231300755](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323231300755.png)
>
> ËøòÊúâÂ≠¶ÂºüÈóÆËøá‰∏∫‰ªÄ‰πà Rv ÁöÑ `onCreateView()` ‰ΩøÁî®ÂÉè‰∏ãÈù¢ËøôÊ†∑ÂÜô‰∏çË°å
>
> ```java
> // ÂÖ∂ÂÆûËøô‰∏™ parent Â∞±ÊòØ Rv
> override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MyViewHolder {
>     return MyViewHolder(
>         // ËøôÁßçÂÜôÊ≥ïÂ∞±ÊòØ‰∏ãÈù¢ËøôÁßçÂÜôÊ≥ï
>         View.inflate(parent.context, R.layout.recycler_item, parent)
>     )
> }
> 
> override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MyViewHolder {
>     return MyViewHolder(
>         LayoutInflater.from(parent.context).inflate(R.layout.recycler_item, parent, true)
>     )
> }
> 
> // ‰∏äÈù¢Ëøô‰∏§ÁßçÂÜôÊ≥ï‰ΩøÁî®Âêé‰ºöÊä•ÈîôÔºö
> // java.lang.IllegalStateException: 
> // ViewHolder views must not be attached when created. 
> // Ensure that you are not passing 'true' to the attachToRoot parameter 
> // of LayoutInflater.inflate(..., boolean attachToRoot)
> // ÊÑèÊÄùÂ∞±ÊòØÂè™ËÉΩÂú® ViewHolder ÂºÄÂßã‰ΩøÁî®Êó∂ÊâçËÉΩÊää View Ê∑ªÂä†Âà∞ parent ‰∏≠Âéª
> ```
>
> ÂèØËÉΩÈÉ®ÂàÜÊúâ‰∫∫ËøôÊ†∑ÂÜôËøáÔºåÂèëÁé∞ item ÁöÑÂ∏ÉÂ±ÄÊó†Ê≥ïËÆæÁΩÆÂ§ßÂ∞èÔºåËøô‰∏™ÈóÆÈ¢òË∑üÂâçÈù¢ËÆ≤Âà∞ÁöÑ dialog Ê†πÂ∏ÉÂ±ÄÂÆΩÈ´òÂ§±ÊïàÊúâÁÇπÁ±ª‰ºº
>
> ```java
> override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MyViewHolder {
>     return MyViewHolder(
>         // Á¨¨‰∫å‰∏™ÂèÇÊï∞‰º†ÂÖ• null
>         LayoutInflater.from(parent.context).inflate(R.layout.recycler_item, null)
>     )
> }
> ```
>
> Á¨¨‰∫å‰∏™ÂèÇÊï∞‰º†ÂÖ• null Êó∂ÔºåÊåâÁÖßÂâçÈù¢ÂàÜÊûêÁöÑÊµÅÁ®ãÔºåÂ∞±‰∏ç‰ºöÁªôÊ†πÂ∏ÉÂ±ÄËÆæÁΩÆ `LayoutParams`ÔºåÈÇ£‰πàÂú® Rv `addView()`Êó∂Ôºå‰ºöË∞ÉÁî® Rv ÁöÑ `generateDefaultLayoutParams()` ÔºåÊúÄÂêéË∞ÉÁî®Âà∞ `LayoutManger` ÁöÑ `generateDefaultLayoutParams()`
>
> ![image-20220323234144858](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323234144858.png)
>
> Â¶ÇÊûúÊòØ `LinearLayoutManger`ÔºåÂ∞±Áõ¥Êé•ËÆæÁΩÆÊàê `wrap_content` ‰∫ÜÔºåÊâÄ‰ª•Âú® xml ‰∏≠ÂÜôÁöÑÂÆΩÂíåÈ´òÊ†πÊú¨Â∞±Ê≤°ÊúâÂéªËØªÂèñ
>
> ![image-20220323234305639](https://gitee.com/guo985892345/typora/raw/master/img/image-20220323234305639.png)

### 11„ÄÅÂèëÂ∏ÉÂºÄÊ∫êÂ∫ì

### 12„ÄÅÂàÜ‰∫´‰∏Ä‰∫õ‰∏úË•ø

#### 1„ÄÅMaterial Design ÂÆòÁΩë

> Ë∞ÅÊÉ≥ÂÜôËá™ÂÆö‰πâ View ÂïäÔºå‰Ω†ÊÉ≥ÂÜôÂêóÔºüÊ≠£Áªè‰∫∫ÂÜô‰ªÄ‰πàËá™ÂÆö‰πâ View„ÄÇ
>
> Ëá™ÂÆö‰πâ View Á°ÆÂÆûÂæàÈöæÔºå‰∏úË•øÂèàÂ§öÂèàÊùÇÔºåÂú®ËÄÉËôëÂÜôËá™ÂÆö‰πâ View ‰πãÂâçÔºåËØ∑ÂÖàÊêúÁ¥¢‰∏Ä‰∏ãÊòØÂê¶ÊúâÂà´‰∫∫Â∑≤ÁªèÈÄ†Â•ΩÁöÑËΩÆÂ≠êÔºåÊúâËΩÆÂ≠êÁõ¥Êé•Áî®Ôºå‰ªñ‰∏çÈ¶ôÂêóÔºü[ÁãóÂ§¥]ÔºåMaterial Design ÂÆòÁΩëÂ∞±ÂåÖÂê´ËÆ∏Â§öÂÆòÊñπËΩÆÂ≠ê
>
> ÂÆòÁΩëÈìæÊé•Ôºöhttps://material.io/
>
> Ê∫êÁ†ÅÂú∞ÂùÄÔºöhttps://github.com/material-components/material-components-android
>
> Á§∫‰æã‰∏ãËΩΩÔºöhttps://github.com/material-components/material-components-android/releases
>
> ËøôÈáåÈù¢ÁöÑÈÉΩÁÆóÂÆòÊñπÊéß‰ª∂ÔºåËÄå‰∏îÊúâÂæàÂ§öÔºåÂ¶ÇÊûúÊÉ≥ÂÆûÁé∞Êüê‰∏™ÂäüËÉΩÊó∂ÂèØ‰ª•ÂéªÁúãÁúãÊòØÂê¶Â∑≤ÁªèÊúâÂÆûÁé∞‰∫ÜÁöÑÔºå‰ªñËøò‰∏ìÈó®ÂÜô‰∫Ü‰∏Ä‰∏™ÂÆû‰æã appÔºåÂèØ‰ª•‰∏ã‰∏ãÊù•ÁúãÁúãÔºåÊâæÂà∞ÊÉ≥Ë¶ÅÁöÑÂÜçÂéªÁúã‰ªñÁöÑÊ∫êÁ†Å

#### 2„ÄÅView#post()„ÄÅposyDelay()„ÄÅpostOnAnimation()

> ÂæóÂà∞ View ÁöÑÂÆΩÂíåÈ´ò
>
> postDelay() ÂèØËÉΩ‰ºöÂÜÖÂ≠òÊ≥ÑÊºè

#### 3„ÄÅView ÁöÑÁîüÂëΩÂë®Êúü

> ÁîüÂëΩÂë®Êúü
>
> Â¶Ç‰ΩïÁõëÂê¨ View Ë¢´ remove

#### 4„ÄÅËá™ÂÆö‰πâ View ÁöÑ‰∏Ä‰∫õËßÑËåÉ

> Â∫îËØ•Â∞ΩÈáèËß£ËÄ¶
>
> ÂèØ‰ª•‰ΩøÁî®ÂàÜÁ¶ª‰∏Ä‰∫õËÅåË¥£Âá∫Êù•

#### 5„ÄÅÂ∏ÉÂ±ÄË∞ÉËØïËΩØ‰ª∂

> Android Ë∞ÉËØïÂà©Âô® Pandora
>
> https://www.wanandroid.com/blog/show/2183

#### 6„ÄÅRv ÊÄé‰πàÂæóÂà∞Êüê‰∏™ item  ÁöÑÂÆû‰æã

> Ëøô‰∏çÁÆóËá™ÂÆö‰πâ View ÁöÑÂÜÖÂÆπÔºåÂõ†‰∏∫ÂØíÂÅáÊó∂ÊúâÂæàÂ§öÂ≠¶ÂºüÈÅáÂà∞‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåÊàëËøôÈáåËÆ≤Ëß£‰∏Ä‰∏ãÂêß
>
> ÂæóÂà∞ÈáåÈù¢ÁöÑ item Êõ¥Âª∫ËÆÆ‰ΩøÁî®Âú®‰∏çÈúÄË¶Å‰øùÊåÅÁä∂ÊÄÅÁöÑÊÉÖÂÜµ‰∏ãÔºåÊØîÂ¶ÇÊüê‰∏™ item ÁöÑÂèòÂä®ÈúÄË¶ÅÂä†ËΩΩÂä®ÁîªÔºåÈÇ£Â∞±ÂèØ‰ª•‰ΩøÁî®ËøôÁßçÊñπÊ≥ï

## ‰∫å„ÄÅÂä®Áîª